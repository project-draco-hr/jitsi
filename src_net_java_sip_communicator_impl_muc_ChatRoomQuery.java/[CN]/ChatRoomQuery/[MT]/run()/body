{
  Iterator<ChatRoomProviderWrapper> chatRoomProviders=MUCActivator.getMUCService().getChatRoomList().getChatRoomProviders();
  while (chatRoomProviders.hasNext()) {
    ChatRoomProviderWrapper provider=chatRoomProviders.next();
    for (int i=0; i < provider.countChatRooms(); i++) {
      if (count > 0 && getQueryResultCount() > count) {
        if (getStatus() != QUERY_CANCELED)         setStatus(QUERY_COMPLETED);
        return;
      }
      ChatRoomWrapper chatRoom=provider.getChatRoom(i);
      addChatRoom(provider.getProtocolProvider(),chatRoom.getChatRoomName(),chatRoom.getChatRoomID());
    }
  }
  if (getStatus() != QUERY_CANCELED)   setStatus(QUERY_COMPLETED);
}
