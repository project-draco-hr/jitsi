{
  ConfigurationService configService=MUCActivator.getConfigurationService();
  String prefix="net.java.sip.communicator.impl.gui.accounts";
  List<String> accounts=configService.getPropertyNamesByPrefix(prefix,true);
  for (  ProtocolProviderService pps : MUCActivator.getChatRoomProviders()) {
    for (    String accountRootPropName : accounts) {
      String accountUID=configService.getString(accountRootPropName);
      if (accountUID.equals(pps.getAccountID().getAccountUniqueID())) {
        List<String> chatRooms=configService.getPropertyNamesByPrefix(accountRootPropName + ".chatRooms",true);
        for (        String chatRoomPropName : chatRooms) {
          if (count > 0 && getQueryResultCount() > count) {
            if (getStatus() != QUERY_CANCELED)             setStatus(QUERY_COMPLETED);
            return;
          }
          addChatRoom(pps,configService.getString(chatRoomPropName + ".chatRoomName"),configService.getString(chatRoomPropName));
        }
      }
    }
  }
  if (getStatus() != QUERY_CANCELED)   setStatus(QUERY_COMPLETED);
}
