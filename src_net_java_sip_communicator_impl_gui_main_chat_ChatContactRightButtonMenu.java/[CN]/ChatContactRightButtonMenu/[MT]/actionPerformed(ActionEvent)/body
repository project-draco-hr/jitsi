{
  String menuItemName=((JMenuItem)e.getSource()).getName();
  if (menuItemName.equals("kickItem")) {
    ChatOperationReasonDialog reasonDialog=new ChatOperationReasonDialog();
    int result=new ChatOperationReasonDialog().showDialog();
    if (result == 0)     new KickParticipantThread(room,reasonDialog.getReason()).start();
  }
 else   if (menuItemName.equals("banItem")) {
    ChatOperationReasonDialog reasonDialog=new ChatOperationReasonDialog();
    int result=new ChatOperationReasonDialog().showDialog();
    if (result == 0)     new BanParticipantThread(room,reasonDialog.getReason()).start();
  }
 else   if (menuItemName.equals("changeRoomSubjectItem")) {
    ChatOperationReasonDialog reasonDialog=new ChatOperationReasonDialog(chatPanel.getChatWindow(),GuiActivator.getResources().getI18NString("service.gui.CHANGE_ROOM_SUBJECT"),GuiActivator.getResources().getI18NString("service.gui.CHANGE_ROOM_SUBJECT_LABEL"),"Ok",false);
    reasonDialog.setReasonFieldText(room.getSubject());
    int result=reasonDialog.showDialog();
    if (result == 0) {
      try {
        room.setSubject(reasonDialog.getReason().trim());
      }
 catch (      OperationFailedException ex) {
        ex.printStackTrace();
      }
    }
  }
 else   if (menuItemName.equals("changeNicknameItem")) {
    ChatOperationReasonDialog reasonDialog=new ChatOperationReasonDialog(chatPanel.getChatWindow(),GuiActivator.getResources().getI18NString("service.gui.CHANGE_NICKNAME"),GuiActivator.getResources().getI18NString("service.gui.CHANGE_NICKNAME_LABEL"),"Ok",false);
    reasonDialog.setReasonFieldText(chatContact.getName());
    int result=reasonDialog.showDialog();
    if (result == 0) {
      try {
        room.setUserNickname(reasonDialog.getReason().trim());
      }
 catch (      OperationFailedException ex) {
        ex.printStackTrace();
      }
    }
  }
 else   if (menuItemName.equals("grantVoiceItem")) {
    room.grantVoice(chatContact.getName());
    ((ChatRoomMember)chatContact.getDescriptor()).setRole(ChatRoomMemberRole.GUEST);
  }
 else   if (menuItemName.equals("grantMembershipItem")) {
    room.grantMembership(((ChatRoomMember)chatContact.getDescriptor()).getContactAddress());
    ((ChatRoomMember)chatContact.getDescriptor()).setRole(ChatRoomMemberRole.MEMBER);
  }
 else   if (menuItemName.equals("grantModeratorItem")) {
    room.grantModerator(chatContact.getName());
    ((ChatRoomMember)chatContact.getDescriptor()).setRole(ChatRoomMemberRole.MODERATOR);
  }
 else   if (menuItemName.equals("grantAdminItem")) {
    room.grantAdmin(((ChatRoomMember)chatContact.getDescriptor()).getContactAddress());
    ((ChatRoomMember)chatContact.getDescriptor()).setRole(ChatRoomMemberRole.ADMINISTRATOR);
  }
 else   if (menuItemName.equals("grantOwnershipItem")) {
    room.grantOwnership(((ChatRoomMember)chatContact.getDescriptor()).getContactAddress());
    ((ChatRoomMember)chatContact.getDescriptor()).setRole(ChatRoomMemberRole.OWNER);
  }
 else   if (menuItemName.equals("revokeOwnershipItem")) {
    room.revokeOwnership(((ChatRoomMember)chatContact.getDescriptor()).getContactAddress());
    ((ChatRoomMember)chatContact.getDescriptor()).setRole(ChatRoomMemberRole.ADMINISTRATOR);
  }
 else   if (menuItemName.equals("revokeAdminItem")) {
    room.revokeAdmin(((ChatRoomMember)chatContact.getDescriptor()).getContactAddress());
    ((ChatRoomMember)chatContact.getDescriptor()).setRole(ChatRoomMemberRole.MEMBER);
  }
 else   if (menuItemName.equals("revokeModeratorItem")) {
    room.revokeModerator(chatContact.getName());
    ((ChatRoomMember)chatContact.getDescriptor()).setRole(ChatRoomMemberRole.MEMBER);
  }
 else   if (menuItemName.equals("revokeMembershipItem")) {
    room.revokeMembership(((ChatRoomMember)chatContact.getDescriptor()).getContactAddress());
    ((ChatRoomMember)chatContact.getDescriptor()).setRole(ChatRoomMemberRole.GUEST);
  }
 else   if (menuItemName.equals("revokeVoiceItem")) {
    room.revokeVoice(chatContact.getName());
    ((ChatRoomMember)chatContact.getDescriptor()).setRole(ChatRoomMemberRole.SILENT_MEMBER);
  }
}
