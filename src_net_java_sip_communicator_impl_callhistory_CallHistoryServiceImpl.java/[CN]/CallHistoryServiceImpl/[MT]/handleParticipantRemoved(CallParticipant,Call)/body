{
  CallRecord callRecord=findCallRecord(srcCall);
  String pAddress=callParticipant.getAddress();
  CallParticipantRecordImpl cpRecord=(CallParticipantRecordImpl)callRecord.findParticipantRecord(pAddress);
  if (cpRecord == null)   return;
  if (!callParticipant.getState().equals(CallParticipantState.DISCONNECTED))   cpRecord.setState(callParticipant.getState());
  CallParticipantState cpRecordState=cpRecord.getState();
  if (cpRecordState.equals(CallParticipantState.CONNECTED) || CallParticipantState.isOnHold(cpRecordState)) {
    cpRecord.setEndTime(new Date());
  }
}
