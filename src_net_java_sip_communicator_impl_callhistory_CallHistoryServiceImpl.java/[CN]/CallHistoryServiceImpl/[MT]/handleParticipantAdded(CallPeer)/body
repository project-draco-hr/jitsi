{
  CallRecord callRecord=findCallRecord(callParticipant.getCall());
  if (callRecord == null)   return;
  callParticipant.addCallParticipantListener(new CallPeerAdapter(){
    public void participantStateChanged(    CallPeerChangeEvent evt){
      if (evt.getNewValue().equals(CallPeerState.DISCONNECTED))       return;
 else {
        CallParticipantRecordImpl participantRecord=findParticipantRecord(evt.getSourceCallParticipant());
        if (participantRecord == null)         return;
        CallPeerState newState=(CallPeerState)evt.getNewValue();
        if (newState.equals(CallPeerState.CONNECTED) && !CallPeerState.isOnHold((CallPeerState)evt.getOldValue()))         participantRecord.setStartTime(new Date());
        participantRecord.setState(newState);
      }
    }
  }
);
  Date startDate=new Date();
  CallParticipantRecordImpl newRec=new CallParticipantRecordImpl(callParticipant.getAddress(),startDate,startDate);
  callRecord.getParticipantRecords().add(newRec);
}
