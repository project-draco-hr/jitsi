{
  CallRecord callRecord=findCallRecord(callParticipant.getCall());
  if (callRecord == null)   return;
  callParticipant.addCallParticipantListener(new CallPeerAdapter(){
    public void participantStateChanged(    CallPeerChangeEvent evt){
      if (evt.getNewValue().equals(CallParticipantState.DISCONNECTED))       return;
 else {
        CallParticipantRecordImpl participantRecord=findParticipantRecord(evt.getSourceCallParticipant());
        if (participantRecord == null)         return;
        CallParticipantState newState=(CallParticipantState)evt.getNewValue();
        if (newState.equals(CallParticipantState.CONNECTED) && !CallParticipantState.isOnHold((CallParticipantState)evt.getOldValue()))         participantRecord.setStartTime(new Date());
        participantRecord.setState(newState);
      }
    }
  }
);
  Date startDate=new Date();
  CallParticipantRecordImpl newRec=new CallParticipantRecordImpl(callParticipant.getAddress(),startDate,startDate);
  callRecord.getParticipantRecords().add(newRec);
}
