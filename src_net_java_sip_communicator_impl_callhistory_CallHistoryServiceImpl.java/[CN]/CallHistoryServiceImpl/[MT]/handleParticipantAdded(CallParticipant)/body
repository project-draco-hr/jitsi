{
  CallRecord callRecord=findCallRecord(callParticipant.getCall());
  if (callRecord == null)   return;
  callParticipant.addCallParticipantListener(new CallParticipantListener(){
    public void participantStateChanged(    CallParticipantChangeEvent evt){
      if (evt.getNewValue().equals(CallParticipantState.DISCONNECTED))       return;
 else {
        CallParticipantRecordImpl participantRecord=findParticipantRecord(evt.getSourceCallParticipant());
        if (participantRecord == null)         return;
        if (evt.getNewValue().equals(CallParticipantState.CONNECTED))         participantRecord.setStartTime(new Date());
        participantRecord.setState((CallParticipantState)evt.getNewValue());
      }
    }
    public void participantDisplayNameChanged(    CallParticipantChangeEvent evt){
    }
    public void participantAddressChanged(    CallParticipantChangeEvent evt){
    }
    public void participantImageChanged(    CallParticipantChangeEvent evt){
    }
    public void participantTransportAddressChanged(    CallParticipantChangeEvent evt){
    }
  }
);
  Date startDate=new Date();
  CallParticipantRecordImpl newRec=new CallParticipantRecordImpl(callParticipant.getAddress(),startDate,startDate);
  callRecord.getParticipantRecords().add(newRec);
}
