{
  CallRecordImpl callRecord=findCallRecord(evt.getSourceCall());
  if (callRecord == null)   return;
  if (evt.getNewValue().equals(CallState.CALL_ENDED)) {
    if (evt.getOldValue().equals(CallState.CALL_INITIALIZATION))     callRecord.setEndTime(callRecord.getStartTime());
 else     callRecord.setEndTime(new Date());
    writeCall(callRecord,null,null);
    currentCallRecords.remove(callRecord);
  }
}
