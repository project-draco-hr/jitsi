{
  File file=null;
  try {
    logger.logEntry();
    homedir=homedir.trim();
    if (!homedir.endsWith(File.separator)) {
      homedir+=File.separator;
    }
    file=new File(homedir + fileName);
    if (file.canRead() || file.canWrite()) {
      return file;
    }
    File homedirFile=new File(homedir);
    if (!homedirFile.exists()) {
      if (logger.isDebugEnabled())       logger.debug("Creating home directory : " + homedirFile.getAbsolutePath());
      if (!homedirFile.mkdirs()) {
        String message="Could not create the home directory : " + homedirFile.getAbsolutePath();
        if (logger.isDebugEnabled())         logger.debug(message);
        throw new IOException(message);
      }
      if (logger.isDebugEnabled())       logger.debug("Home directory created : " + homedirFile.getAbsolutePath());
    }
 else     if (!homedirFile.canWrite()) {
      file=null;
    }
    if (file != null && !file.getParentFile().exists()) {
      if (!file.getParentFile().mkdirs()) {
        String message="Could not create the parent directory : " + homedirFile.getAbsolutePath();
        if (logger.isDebugEnabled())         logger.debug(message);
        throw new IOException(message);
      }
    }
  }
  finally {
    logger.logExit();
  }
  return file;
}
