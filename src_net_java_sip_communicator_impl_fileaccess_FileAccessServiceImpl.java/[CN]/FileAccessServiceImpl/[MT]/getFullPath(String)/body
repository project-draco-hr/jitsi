{
  String userhome=null;
  String sipSubdir=null;
synchronized (this.syncRoot) {
    userhome=this.configurationService.getString(FileAccessService.CONFPROPERTYKEY_USER_HOME);
    sipSubdir=this.configurationService.getString(FileAccessService.CONFPROPERTYKEY_SIPCOMM_DIRECTORY);
  }
  if (userhome == null) {
    userhome=System.getProperty(FileAccessService.SYSPROPERTYKEY_USER_HOME);
    if (userhome == null) {
      throw new IllegalStateException("No user home directory specified in system's environment");
    }
  }
  if (sipSubdir == null) {
    sipSubdir=FileAccessService.DEFAULT_SIPCOMM_DIRECTORY;
  }
  if (!userhome.endsWith(File.separator)) {
    userhome+=File.separator;
  }
  if (!sipSubdir.endsWith(File.separator)) {
    sipSubdir+=File.separator;
  }
  return userhome + sipSubdir;
}
