{
  this.from=json.getString("from");
  this.to=json.getString("to");
  this.time=json.getLong("time");
  this.clientTime=time;
  JSONObject msg=(JSONObject)json.get("msg");
  this.text=msg.getString("text");
  if (msg.has("msgID")) {
    this.msgID=msg.getString("msgID");
  }
 else {
    this.msgID=UUID.randomUUID().toString();
  }
  if (!fromUser.uid.equals(this.from)) {
    throw new IllegalArgumentException("the given message doesn't belong to the given user");
  }
  this.fromName=fromUser.name;
  this.fromFirstName=fromUser.firstName;
}
