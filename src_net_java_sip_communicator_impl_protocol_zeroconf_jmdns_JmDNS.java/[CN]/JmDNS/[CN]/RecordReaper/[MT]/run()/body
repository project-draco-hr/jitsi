{
synchronized (JmDNS.this) {
    if (state == DNSState.CANCELED) {
      return;
    }
    logger.finest("run() JmDNS reaping cache");
    List list=new ArrayList();
synchronized (cache) {
      for (Iterator i=cache.iterator(); i.hasNext(); ) {
        for (DNSCache.CacheNode n=(DNSCache.CacheNode)i.next(); n != null; n=n.next()) {
          list.add(n.getValue());
        }
      }
    }
    long now=System.currentTimeMillis();
    for (Iterator i=list.iterator(); i.hasNext(); ) {
      DNSRecord c=(DNSRecord)i.next();
      if (c.isExpired(now)) {
        updateRecord(now,c);
        cache.remove(c);
      }
    }
  }
}
