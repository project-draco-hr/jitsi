{
  if (doc == null)   throw new IllegalArgumentException("doc must not be null");
  if (path == null)   throw new IllegalArgumentException("path must not be null");
  Element parent=(Element)doc.getFirstChild();
  if (parent == null)   throw new IllegalArgumentException("parentmust not be null");
  Element e=parent;
  for (int i=0; i < pathLength; i++) {
    String pathEl=path[i];
    Element newEl=findChild(e,pathEl);
    if (newEl == null) {
      newEl=doc.createElement(pathEl);
      e.appendChild(newEl);
    }
    e=newEl;
  }
  return e;
}
