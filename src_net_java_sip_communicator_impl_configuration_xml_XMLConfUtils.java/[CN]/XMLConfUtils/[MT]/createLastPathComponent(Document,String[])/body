{
  Element parent=(Element)doc.getFirstChild();
  if (path == null || parent == null || doc == null)   throw new IllegalArgumentException("Document parent and path must not be null");
  Element e=parent;
  for (int i=0; i < path.length; i++) {
    Element newEl=findChild(e,path[i]);
    if (newEl == null) {
      newEl=doc.createElement(path[i]);
      e.appendChild(newEl);
    }
    e=newEl;
  }
  return e;
}
