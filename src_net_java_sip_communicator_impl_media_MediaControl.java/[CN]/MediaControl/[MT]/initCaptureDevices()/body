{
  if (avDataSource != null)   avDataSource.disconnect();
  DataSource audioDataSource=null;
  DataSource videoDataSource=null;
  CaptureDeviceInfo audioDeviceInfo=null;
  CaptureDeviceInfo videoDeviceInfo=null;
  audioDeviceInfo=deviceConfiguration.getAudioCaptureDevice();
  muteAudioDataSource=null;
  if (audioDeviceInfo != null) {
    audioDataSource=createDataSource(audioDeviceInfo.getLocator());
    if (audioDataSource instanceof PushBufferDataSource)     audioDataSource=muteAudioDataSource=new MutePushBufferDataSource((PushBufferDataSource)audioDataSource);
  }
  videoDeviceInfo=deviceConfiguration.getVideoCaptureDevice();
  cloneableVideoDataSource=null;
  if (videoDeviceInfo != null) {
    videoDataSource=createDataSource(videoDeviceInfo.getLocator());
    selectVideoSize(videoDataSource);
    DataSource cloneableVideoDataSource=Manager.createCloneableDataSource(videoDataSource);
    if (cloneableVideoDataSource != null) {
      videoDataSource=cloneableVideoDataSource;
      this.cloneableVideoDataSource=(SourceCloneable)cloneableVideoDataSource;
    }
  }
  if (audioDataSource != null && videoDataSource != null) {
    DataSource[] allDS=new DataSource[]{audioDataSource,videoDataSource};
    try {
      avDataSource=Manager.createMergingDataSource(allDS);
    }
 catch (    IncompatibleSourceException exc) {
      logger.fatal("Failed to create a media data source!" + "Media transmission won't be enabled!",exc);
      throw new InternalError("Failed to create a media data source!" + "Media transmission won't be enabled!" + exc.getMessage());
    }
  }
 else   if (audioDataSource != null)   avDataSource=audioDataSource;
 else   if (videoDataSource != null)   avDataSource=videoDataSource;
 else   avDataSource=null;
  if (avDataSource != null)   initProcessor(avDataSource);
}
