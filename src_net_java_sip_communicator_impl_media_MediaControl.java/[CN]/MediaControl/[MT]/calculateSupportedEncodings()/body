{
  TrackControl[] trackControls=sourceProcessor.getTrackControls();
  if (logger.isDebugEnabled())   logger.debug("We will be able to transmit in:");
  List<String> transmittableAudioEncodings=new ArrayList<String>();
  List<String> transmittableVideoEncodings=new ArrayList<String>();
  for (  TrackControl trackControl : trackControls) {
    Format[] formats=trackControl.getSupportedFormats();
    for (int j=0; j < formats.length; j++) {
      Format format=formats[j];
      String encoding=format.getEncoding();
      int sdpInt=MediaUtils.jmfToSdpEncoding(encoding);
      if (sdpInt != MediaUtils.UNKNOWN_ENCODING) {
        String sdp=String.valueOf(sdpInt);
        if (format instanceof AudioFormat) {
          if (!transmittableAudioEncodings.contains(sdp)) {
            if (logger.isDebugEnabled()) {
              logger.debug("Audio=[" + (j + 1) + "]="+ encoding+ "; sdp="+ sdp);
            }
            transmittableAudioEncodings.add(sdp);
          }
        }
 else         if (format instanceof VideoFormat) {
          if (!transmittableVideoEncodings.contains(sdp)) {
            if (logger.isDebugEnabled()) {
              logger.debug("Video=[" + (j + 1) + "]="+ encoding+ "; sdp="+ sdp);
            }
            transmittableVideoEncodings.add(sdp);
          }
        }
      }
 else {
        if (logger.isDebugEnabled())         logger.debug("unknown encoding format " + encoding);
      }
    }
  }
  final int transmittableAudioEncodingCount=transmittableAudioEncodings.size();
  if (transmittableAudioEncodingCount > 0) {
    supportedAudioEncodings=encodingConfiguration.updateEncodings(transmittableAudioEncodings);
  }
 else {
    supportedAudioEncodings=encodingConfiguration.getSupportedAudioEncodings();
  }
  final int transmittableVideoEncodingCount=transmittableVideoEncodings.size();
  if (transmittableVideoEncodingCount > 0) {
    supportedVideoEncodings=encodingConfiguration.updateEncodings(transmittableVideoEncodings);
  }
 else {
    supportedVideoEncodings=encodingConfiguration.getSupportedVideoEncodings();
  }
}
