{
  if (!isMAPIInitialized) {
    String logFileName="";
    String homeLocation=System.getProperty("net.java.sip.communicator.SC_LOG_DIR_LOCATION");
    String dirName=System.getProperty("net.java.sip.communicator.SC_HOME_DIR_NAME");
    if (homeLocation != null && dirName != null) {
      logFileName=homeLocation + "\\" + dirName+ "\\log\\";
    }
    int logLevel=NATIVE_LOGGER_LEVEL_INFO;
    if (logger.isTraceEnabled()) {
      logLevel=NATIVE_LOGGER_LEVEL_TRACE;
    }
    logger.info("Init mapi with log level " + logLevel + " and log file"+ " path "+ logFileName);
    MAPIInitialize(MAPI_INIT_VERSION,MAPI_MULTITHREAD_NOTIFICATIONS,notificationDelegate,logFileName,logLevel);
    isMAPIInitialized=true;
  }
}
