{
  GTalkTransportPacketExtension trans=new GTalkTransportPacketExtension();
  if (stream != null)   for (  Component component : stream.getComponents()) {
    List<LocalCandidate> candToRemove=new ArrayList<LocalCandidate>();
    List<LocalCandidate> candidates=component.getLocalCandidates();
    for (    Candidate candidate : component.getLocalCandidates()) {
      if (candidate instanceof UPNPCandidate) {
        LocalCandidate base=candidate.getBase();
        candToRemove.add(base);
      }
    }
    for (    Candidate candidate : candToRemove) {
      candidates.remove(candidate);
    }
    for (    Candidate candidate : candidates)     trans.addCandidate(createCandidate(candidate));
  }
  return trans;
}
