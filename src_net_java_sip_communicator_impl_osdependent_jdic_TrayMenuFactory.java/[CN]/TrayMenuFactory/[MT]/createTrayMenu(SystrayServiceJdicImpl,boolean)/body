{
  if (!swing && !OSUtils.IS_MAC)   swing=true;
  Object trayMenu=swing ? new JPopupMenu() : new PopupMenu();
  ActionListener listener=new ActionListener(){
    public void actionPerformed(    ActionEvent event){
      TrayMenuFactory.actionPerformed(event);
    }
  }
;
  add(trayMenu,createTrayMenuItem("settings","service.gui.SETTINGS","service.systray.CONFIGURE_ICON",listener,swing));
  add(trayMenu,createTrayMenuItem("addContact","service.gui.ADD_CONTACT" + "...","service.gui.icons.ADD_CONTACT_16x16_ICON",listener,swing));
  addSeparator(trayMenu);
  add(trayMenu,new StatusSubMenu(tray,swing).getMenu());
  addSeparator(trayMenu);
  add(trayMenu,createTrayMenuItem("service.gui.CLOSE","service.gui.CLOSE","service.systray.CLOSE_MENU_ICON",listener,swing));
  return trayMenu;
}
