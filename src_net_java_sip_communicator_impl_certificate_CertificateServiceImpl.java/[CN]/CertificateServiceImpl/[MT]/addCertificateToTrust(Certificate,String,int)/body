{
switch (trustMode) {
case DO_NOT_TRUST:
    throw new IllegalArgumentException("Cannot add a certificate to trust when " + "no trust is requested.");
case TRUST_ALWAYS:
  config.setProperty(PNAME_CERT_TRUST_PREFIX + ".param." + trustFor,getThumbprint(cert,THUMBPRINT_HASH_ALGORITHM));
break;
case TRUST_THIS_SESSION_ONLY:
sessionAllowedCertificates.put(PNAME_CERT_TRUST_PREFIX + ".param." + trustFor,getThumbprint(cert,THUMBPRINT_HASH_ALGORITHM));
break;
}
}
