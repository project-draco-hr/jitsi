{
  String tsType=(String)config.getProperty(PNAME_TRUSTSTORE_TYPE);
  String tsFile=(String)config.getProperty(PNAME_TRUSTSTORE_FILE);
  String tsPassword=credService.loadPassword(PNAME_TRUSTSTORE_PASSWORD);
  if (tsFile != null && tsFile.equals("Windows-ROOT")) {
    tsType=tsFile;
    tsFile=null;
    config.setProperty(PNAME_TRUSTSTORE_TYPE,tsType);
    config.removeProperty(PNAME_TRUSTSTORE_FILE);
  }
  if (!(OSUtils.IS_WINDOWS32 || (OSUtils.IS_WINDOWS && System.getProperty("java.version").startsWith("1.7")))) {
    tsType=null;
    config.removeProperty(CertificateService.PNAME_TRUSTSTORE_TYPE);
  }
  if (tsType != null)   System.setProperty("javax.net.ssl.trustStoreType",tsType);
 else   System.getProperties().remove("javax.net.ssl.trustStoreType");
  if (tsFile != null)   System.setProperty("javax.net.ssl.trustStore",tsFile);
 else   System.getProperties().remove("javax.net.ssl.trustStore");
  if (tsPassword != null)   System.setProperty("javax.net.ssl.trustStorePassword",tsPassword);
 else   System.getProperties().remove("javax.net.ssl.trustStorePassword");
}
