{
  if (logger.isTraceEnabled())   logger.trace("Systray update status for provider: " + provider.getAccountID().getAccountAddress() + ". The new status will be: "+ presenceStatus.getStatusName());
  if (menu instanceof AbstractButton)   ((AbstractButton)menu).setIcon(new ImageIcon(presenceStatus.getStatusIcon()));
  if (menu instanceof Menu) {
    Menu theMenu=(Menu)menu;
    for (int i=0; i < theMenu.getItemCount(); i++) {
      MenuItem item=theMenu.getItem(i);
      if (item instanceof CheckboxMenuItem) {
        if (item.getLabel().equals(presenceStatus.getStatusName())) {
          ((CheckboxMenuItem)item).setState(true);
        }
 else {
          ((CheckboxMenuItem)item).setState(false);
        }
      }
    }
  }
 else   if (menu instanceof JMenu) {
    JMenu theMenu=(JMenu)menu;
    for (int i=0; i < theMenu.getItemCount(); i++) {
      JMenuItem item=theMenu.getItem(i);
      if (item instanceof JCheckBoxMenuItem) {
        if (item.getText().equals(presenceStatus.getStatusName()))         item.setSelected(true);
 else         item.setSelected(false);
      }
    }
  }
}
