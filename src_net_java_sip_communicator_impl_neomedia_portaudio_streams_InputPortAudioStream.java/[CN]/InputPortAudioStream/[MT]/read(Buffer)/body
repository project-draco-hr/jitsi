{
  if (stopping || !started) {
    buffer.setLength(0);
    return;
  }
synchronized (parentStream) {
    if (bufferData == null) {
      parentStream.read(buffer);
    }
 else {
      Object data=buffer.getData();
      byte[] tmpArray;
      if (data instanceof byte[] && ((byte[])data).length >= bufferLength) {
        tmpArray=(byte[])data;
      }
 else {
        tmpArray=new byte[bufferLength];
        buffer.setData(tmpArray);
      }
      System.arraycopy(bufferData,0,tmpArray,0,bufferLength);
      buffer.setFlags(Buffer.FLAG_SYSTEM_TIME);
      buffer.setLength(bufferLength);
      buffer.setOffset(0);
      buffer.setTimeStamp(bufferTimeStamp);
    }
    bufferData=null;
  }
}
