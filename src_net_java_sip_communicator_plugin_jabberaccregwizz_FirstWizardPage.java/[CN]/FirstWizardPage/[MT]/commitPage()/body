{
  JabberAccountRegistration registration=wizard.getRegistration();
  String userID=accountPanel.getUsername();
  if (userID == null || userID.trim().length() == 0)   throw new IllegalStateException("No user ID provided.");
  registration.setUserID(userID);
  registration.setPassword(new String(accountPanel.getPassword()));
  registration.setRememberPassword(accountPanel.isRememberPassword());
  registration.setServerAddress(connectionPanel.getServerAddress());
  registration.setSendKeepAlive(connectionPanel.isSendKeepAlive());
  registration.setGmailNotificationEnabled(connectionPanel.isGmailNotificationsEnabled());
  registration.setResource(connectionPanel.getResource());
  String serverPort=connectionPanel.getServerPort();
  if (serverPort != null)   registration.setPort(Integer.parseInt(serverPort));
  String priority=connectionPanel.getPriority();
  if (priority != null)   registration.setPriority(Integer.parseInt(priority));
  registration.setUseIce(iceConfigPanel.isUseIce());
  registration.setAutoDiscoverStun(iceConfigPanel.isAutoDiscoverStun());
  Iterator<StunServerDescriptor> stunServers=iceConfigPanel.getAdditionalStunServers().iterator();
  while (stunServers.hasNext()) {
    registration.addStunServer(stunServers.next());
  }
  nextPageIdentifier=SUMMARY_PAGE_IDENTIFIER;
  this.isCommitted=true;
}
