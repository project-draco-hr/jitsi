{
  if (sourceContactList == null)   sourceContactList=GuiActivator.getContactList();
  Iterator<UIContactSource> filterSources=sourceContactList.getContactSources().iterator();
  if (sourceContactList.getDefaultFilter().equals(TreeContactList.presenceFilter)) {
    MetaContactQuery defaultQuery=mclSource.queryMetaContactSource(filterPattern);
    defaultQuery.addContactQueryListener(sourceContactList);
    filterQuery.addContactQuery(defaultQuery);
  }
 else   if (sourceContactList.getDefaultFilter().equals(TreeContactList.historyFilter)) {
    filterSources=sourceContactList.getContactSources(ContactSourceService.HISTORY_TYPE).iterator();
  }
  if (filterQuery.isCanceled())   return;
  while (filterSources.hasNext()) {
    final UIContactSource filterSource=filterSources.next();
    if (GuiActivator.getConfigurationService().getBoolean("net.java.sip.communicator.impl.gui" + ".DISABLE_CALL_HISTORY_SEARCH_IN_CONTACT_LIST",false) && filterSource.getContactSourceService().getType() == ContactSourceService.HISTORY_TYPE)     continue;
    if (filterQuery.isCanceled())     return;
    ContactQuery query=applyFilter(filterSource);
    if (query.getStatus() == ContactQuery.QUERY_IN_PROGRESS)     filterQuery.addContactQuery(query);
  }
  if (filterQuery.isRunning())   filterQuery.close();
 else   if (!sourceContactList.isEmpty())   sourceContactList.selectFirstContact();
}
