{
  ProtocolProviderServiceJabberImpl protocolProvider=getProtocolProvider();
  AccountID accountID=protocolProvider.getAccountID();
  if (accountID.getAccountPropertyBoolean(ProtocolProviderFactory.DEFAULT_ENCRYPTION,true) && accountID.isEncryptionProtocolEnabled(DtlsControl.PROTO_NAME) && protocolProvider.isFeatureSupported(jitsiVideobridge,ProtocolProviderServiceJabberImpl.URN_XMPP_JINGLE_DTLS_SRTP)) {
    DtlsControl dtlsControl=(DtlsControl)peer.getMediaHandler().getSrtpControls().getOrCreate(mediaType,SrtpControlType.DTLS_SRTP);
    if (dtlsControl != null) {
      IceUdpTransportPacketExtension transport=channel.getTransport();
      if (transport == null) {
        transport=new RawUdpTransportPacketExtension();
        channel.setTransport(transport);
      }
      setDtlsEncryptionToTransport(dtlsControl,transport);
    }
  }
}
