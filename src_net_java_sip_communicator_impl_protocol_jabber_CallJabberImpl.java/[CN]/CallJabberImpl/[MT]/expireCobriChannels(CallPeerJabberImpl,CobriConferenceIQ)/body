{
  if (cobri != null) {
    String conferenceID=cobri.getID();
    if (conferenceID.equals(conference.getID())) {
      CobriConferenceIQ conferenceRequest=new CobriConferenceIQ();
      conferenceRequest.setID(conferenceID);
      for (      CobriConferenceIQ.Content content : conference.getContents()) {
        CobriConferenceIQ.Content cobriContent=cobri.getContent(content.getName());
        if (cobriContent != null) {
          CobriConferenceIQ.Content contentRequest=conferenceRequest.getOrCreateContent(cobriContent.getName());
          for (          CobriConferenceIQ.Channel channel : content.getChannels()) {
            CobriConferenceIQ.Channel cobriChannel=cobriContent.getChannel(channel.getID());
            if (cobriChannel != null) {
              CobriConferenceIQ.Channel channelRequest=new CobriConferenceIQ.Channel();
              channelRequest.setExpire(0);
              channelRequest.setID(cobriChannel.getID());
              contentRequest.addChannel(channelRequest);
            }
          }
        }
      }
      for (      CobriConferenceIQ.Content contentRequest : conferenceRequest.getContents()) {
        CobriConferenceIQ.Content cobriContent=cobri.getContent(contentRequest.getName());
        for (        CobriConferenceIQ.Channel channelRequest : contentRequest.getChannels()) {
          CobriConferenceIQ.Channel cobriChannel=cobriContent.getChannel(channelRequest.getID());
          cobriContent.removeChannel(cobriChannel);
          if (cobriContent.getChannelCount() == 1) {
            cobriChannel=cobriContent.getChannel(0);
            channelRequest=new CobriConferenceIQ.Channel();
            channelRequest.setExpire(0);
            channelRequest.setID(cobriChannel.getID());
            contentRequest.addChannel(channelRequest);
            cobriContent.removeChannel(cobriChannel);
            break;
          }
        }
      }
      conferenceRequest.setTo(cobri.getFrom());
      conferenceRequest.setType(IQ.Type.SET);
      getProtocolProvider().getConnection().sendPacket(conferenceRequest);
    }
  }
}
