{
  Request request=null;
  try {
    request=dialog.createRequest(method);
  }
 catch (  SipException ex) {
    throwOperationFailedException("Failed to create " + method + " request.",OperationFailedException.INTERNAL_ERROR,ex);
  }
  AuthorizationHeader authorization=protocolProvider.getSipSecurityManager().getCachedAuthorizationHeader(((CallIdHeader)request.getHeader(CallIdHeader.NAME)).getCallId());
  if (authorization != null) {
    request.setHeader(authorization);
  }
  return request;
}
