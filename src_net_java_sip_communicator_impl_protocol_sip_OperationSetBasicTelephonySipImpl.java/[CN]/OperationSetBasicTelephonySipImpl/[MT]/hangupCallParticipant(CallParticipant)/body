{
  if (participant.getState().equals(CallParticipantState.DISCONNECTED) || participant.getState().equals(CallParticipantState.FAILED)) {
    logger.debug("Ignoring a request to hangup a call participant " + "that is already DISCONNECTED");
    return;
  }
  CallParticipantSipImpl callParticipant=(CallParticipantSipImpl)participant;
  CallParticipantState participantState=callParticipant.getState();
  if (participantState.equals(CallParticipantState.CONNECTED) || CallParticipantState.isOnHold(participantState)) {
    sayBye(callParticipant);
    callParticipant.setState(CallParticipantState.DISCONNECTED);
  }
 else   if (callParticipant.getState().equals(CallParticipantState.CONNECTING) || callParticipant.getState().equals(CallParticipantState.CONNECTING_WITH_EARLY_MEDIA) || callParticipant.getState().equals(CallParticipantState.ALERTING_REMOTE_SIDE)) {
    if (callParticipant.getFirstTransaction() != null) {
      sayCancel(callParticipant);
    }
    callParticipant.setState(CallParticipantState.DISCONNECTED);
  }
 else   if (participantState.equals(CallParticipantState.INCOMING_CALL)) {
    callParticipant.setState(CallParticipantState.DISCONNECTED);
    sayBusyHere(callParticipant);
  }
 else   if (participantState.equals(CallParticipantState.BUSY)) {
    callParticipant.setState(CallParticipantState.DISCONNECTED);
  }
 else   if (participantState.equals(CallParticipantState.FAILED)) {
    callParticipant.setState(CallParticipantState.DISCONNECTED);
  }
 else {
    callParticipant.setState(CallParticipantState.DISCONNECTED);
    logger.error("Could not determine call participant state!");
  }
}
