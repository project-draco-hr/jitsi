{
  logger.trace("Ending all active calls.");
  Iterator activeCalls=this.activeCallsRepository.getActiveCalls();
  while (activeCalls.hasNext()) {
    CallSipImpl call=(CallSipImpl)activeCalls.next();
    Iterator callParticipants=call.getCallParticipants();
    while (callParticipants.hasNext()) {
      CallParticipant participant=(CallParticipant)callParticipants.next();
      try {
        this.hangupCallParticipant(participant);
      }
 catch (      Exception ex) {
        logger.warn("Failed to properly hangup particpant " + participant,ex);
      }
    }
  }
}
