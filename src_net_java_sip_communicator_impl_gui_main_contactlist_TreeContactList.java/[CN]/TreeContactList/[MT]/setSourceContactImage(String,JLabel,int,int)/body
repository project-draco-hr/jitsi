{
  imageSearchCanceled=false;
  Pattern filterPattern=Pattern.compile("^" + Pattern.quote(contactString) + "$",Pattern.UNICODE_CASE);
  Iterator<UIContactSource> contactSources=getContactSources().iterator();
  final Vector<ContactQuery> loadedQueries=new Vector<ContactQuery>();
  while (contactSources.hasNext()) {
    if (imageSearchCanceled)     return;
    ContactSourceService contactSource=contactSources.next().getContactSourceService();
    if (contactSource instanceof ExtendedContactSourceService) {
      ContactQuery query=((ExtendedContactSourceService)contactSource).queryContactSource(filterPattern);
      loadedQueries.add(query);
      query.addContactQueryListener(new ContactQueryListener(){
        public void queryStatusChanged(        ContactQueryStatusEvent event){
        }
        public void contactReceived(        ContactReceivedEvent event){
          SourceContact sourceContact=event.getContact();
          byte[] image=sourceContact.getImage();
          if (image != null && image.length > 0) {
            setScaledLabelImage(label,image,imgWidth,imgHeight);
            cancelImageQueries(loadedQueries);
            imageSearchCanceled=true;
          }
        }
        /** 
 * Indicates that a contact has been removed after a search.
 * @param event the <tt>ContactQueryEvent</tt> containing
 * information
 * about the received <tt>SourceContact</tt>
 */
        public void contactRemoved(        ContactRemovedEvent event){
        }
        /** 
 * Indicates that a contact has been updated after a search.
 * @param event the <tt>ContactQueryEvent</tt> containing information
 * about the updated <tt>SourceContact</tt>
 */
        public void contactChanged(        ContactChangedEvent event){
        }
      }
);
      if (imageSearchCanceled)       return;
      List<SourceContact> results=query.getQueryResults();
      if (results != null && !results.isEmpty()) {
        Iterator<SourceContact> resultsIter=results.iterator();
        while (resultsIter.hasNext()) {
          byte[] image=resultsIter.next().getImage();
          if (image != null && image.length > 0) {
            setScaledLabelImage(label,image,imgWidth,imgHeight);
            cancelImageQueries(loadedQueries);
            return;
          }
        }
      }
    }
  }
  if (imageSearchCanceled)   return;
  int atIndex=contactString.indexOf("@");
  if (atIndex >= 0 && StringUtils.isNumber(contactString.substring(0,atIndex))) {
    setSourceContactImage(contactString.substring(0,atIndex),label,imgWidth,imgHeight);
  }
}
