{
  if (!(packet instanceof Presence))   return;
  if (capsManager != null) {
    String ver=getEntityCapsVersion();
    CapsPacketExtension caps=new CapsPacketExtension(null,capsManager.getNode(),CapsPacketExtension.HASH_METHOD,ver);
    discoveryManager.setNodeInformationProvider(caps.getNode() + "#" + caps.getVersion(),this);
    packet.addExtension(caps);
  }
}
