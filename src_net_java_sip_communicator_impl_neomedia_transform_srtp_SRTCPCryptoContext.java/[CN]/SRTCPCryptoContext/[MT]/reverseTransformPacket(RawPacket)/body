{
  boolean decrypt=false;
  int tagLength=policy.getAuthTagLength();
  int indexEflag=pkt.getSRTCPIndex(tagLength);
  if ((indexEflag & 0x80000000) == 0x80000000)   decrypt=true;
  int index=indexEflag & ~0x80000000;
  if (!checkReplay(index)) {
    return false;
  }
  if (policy.getAuthType() != SRTPPolicy.NULL_AUTHENTICATION) {
    pkt.readRegionToBuff(pkt.getLength() - tagLength,tagLength,tempStore);
    pkt.shrink(tagLength + 4);
    authenticatePacket(pkt,indexEflag);
    for (int i=0; i < tagLength; i++) {
      if ((tempStore[i] & 0xff) == (tagStore[i] & 0xff))       continue;
 else       return false;
    }
  }
  if (decrypt) {
    if (policy.getEncType() == SRTPPolicy.AESCM_ENCRYPTION || policy.getEncType() == SRTPPolicy.TWOFISH_ENCRYPTION) {
      processPacketAESCM(pkt,index);
    }
 else     if (policy.getEncType() == SRTPPolicy.AESF8_ENCRYPTION || policy.getEncType() == SRTPPolicy.TWOFISHF8_ENCRYPTION) {
      processPacketAESF8(pkt,index);
    }
  }
  update(index);
  return true;
}
