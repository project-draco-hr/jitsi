{
  if (evt.getNewState().equals(RegistrationState.REGISTERED)) {
    Map supportedOpSets=icqProtocolProvider.getSupportedOperationSets();
    this.mainFrame.setProtocolProvider(icqProtocolProvider);
    this.mainFrame.setSupportedOperationSets(supportedOpSets);
    ServiceReference clistReference=bc.getServiceReference(MetaContactListService.class.getName());
    MetaContactListService contactListService=(MetaContactListService)bc.getService(clistReference);
    this.mainFrame.setContactList(contactListService);
  }
 else   if (evt.getNewState().equals(RegistrationState.AUTHENTICATION_FAILED)) {
    this.mainFrame.getStatusPanel().stopConnecting(Constants.ICQ);
    this.mainFrame.getStatusPanel().setSelectedStatus(Constants.ICQ,Constants.OFFLINE_STATUS);
    JOptionPane.showMessageDialog(null,Messages.getString("authenticationFailed"),Messages.getString("authenticationFailed"),JOptionPane.ERROR_MESSAGE);
    this.showLoginWindow(this.mainFrame);
  }
 else   if (evt.getNewState().equals(RegistrationState.CONNECTION_FAILED)) {
    this.mainFrame.getStatusPanel().stopConnecting(Constants.ICQ);
    this.mainFrame.getStatusPanel().setSelectedStatus(Constants.ICQ,Constants.OFFLINE_STATUS);
    JOptionPane.showMessageDialog(null,Messages.getString("connectionFailedMessage"),Messages.getString("connectionFailed"),JOptionPane.ERROR_MESSAGE);
  }
 else   if (evt.getNewState().equals(RegistrationState.EXPIRED)) {
  }
}
