{
  ProtocolProviderService protocolProvider=evt.getProvider();
  OperationSetPresence presence=mainFrame.getProtocolPresence(protocolProvider);
  if (evt.getNewState().equals(RegistrationState.REGISTERED)) {
    this.mainFrame.getStatusPanel().updateStatus(protocolProvider);
    if (mainFrame.getCallManager().containsCallAccount(protocolProvider)) {
      this.mainFrame.getCallManager().updateCallAccountStatus(protocolProvider);
    }
    if (presence != null) {
      presence.setAuthorizationHandler(new AuthorizationHandlerImpl(mainFrame));
    }
  }
 else   if (evt.getNewState().equals(RegistrationState.AUTHENTICATION_FAILED)) {
    this.mainFrame.getStatusPanel().updateStatus(evt.getProvider());
    if (evt.getReasonCode() == RegistrationStateChangeEvent.REASON_RECONNECTION_RATE_LIMIT_EXCEEDED) {
      SIPCommMsgTextArea msgText=new SIPCommMsgTextArea(Messages.getI18NString("reconnectionLimitExceeded",protocolProvider.getAccountID().getUserID()).getText());
      JOptionPane.showMessageDialog(null,msgText,Messages.getI18NString("error").getText(),JOptionPane.ERROR_MESSAGE);
    }
 else     if (evt.getReasonCode() == RegistrationStateChangeEvent.REASON_NON_EXISTING_USER_ID) {
      SIPCommMsgTextArea msgText=new SIPCommMsgTextArea(Messages.getI18NString("nonExistingUserId",protocolProvider.getProtocolName()).getText());
      JOptionPane.showMessageDialog(null,msgText,Messages.getI18NString("error").getText(),JOptionPane.ERROR_MESSAGE);
    }
 else     if (evt.getReasonCode() == RegistrationStateChangeEvent.REASON_AUTHENTICATION_FAILED) {
      SIPCommMsgTextArea msgText=new SIPCommMsgTextArea(Messages.getI18NString("authenticationFailed",protocolProvider.getAccountID().getAccountAddress()).getText());
      JOptionPane.showMessageDialog(null,msgText,Messages.getI18NString("error").getText(),JOptionPane.ERROR_MESSAGE);
    }
    logger.error(evt.getReason());
  }
 else   if (evt.getNewState().equals(RegistrationState.CONNECTION_FAILED)) {
    this.mainFrame.getStatusPanel().updateStatus(evt.getProvider());
    SIPCommMsgTextArea msgText=new SIPCommMsgTextArea(Messages.getI18NString("connectionFailedMessage",protocolProvider.getAccountID().getAccountAddress()).getText());
    JOptionPane.showMessageDialog(null,msgText,Messages.getI18NString("error").getText(),JOptionPane.ERROR_MESSAGE);
    logger.error(evt.getReason());
  }
 else   if (evt.getNewState().equals(RegistrationState.EXPIRED)) {
    this.mainFrame.getStatusPanel().updateStatus(evt.getProvider());
    SIPCommMsgTextArea msgText=new SIPCommMsgTextArea(Messages.getI18NString("connectionExpiredMessage",protocolProvider.getProtocolName()).getText());
    JOptionPane.showMessageDialog(null,msgText,Messages.getI18NString("error").getText(),JOptionPane.ERROR_MESSAGE);
    logger.error(evt.getReason());
  }
 else   if (evt.getNewState().equals(RegistrationState.UNREGISTERED)) {
    this.mainFrame.getStatusPanel().updateStatus(evt.getProvider());
    if (!manuallyDisconnected) {
      if (evt.getReasonCode() == RegistrationStateChangeEvent.REASON_MULTIPLE_LOGINS) {
        SIPCommMsgTextArea msgText=new SIPCommMsgTextArea(Messages.getI18NString("multipleLogins",protocolProvider.getAccountID().getUserID()).getText());
        JOptionPane.showMessageDialog(null,msgText,Messages.getI18NString("error").getText(),JOptionPane.ERROR_MESSAGE);
      }
 else       if (evt.getReasonCode() == RegistrationStateChangeEvent.REASON_CLIENT_LIMIT_REACHED_FOR_IP) {
        SIPCommMsgTextArea msgText=new SIPCommMsgTextArea(Messages.getI18NString("limitReachedForIp",protocolProvider.getProtocolName()).getText());
        JOptionPane.showMessageDialog(null,msgText,Messages.getI18NString("error").getText(),JOptionPane.ERROR_MESSAGE);
      }
 else       if (evt.getReasonCode() == RegistrationStateChangeEvent.REASON_CHANGE_REQUESTED_BY_USER) {
      }
 else {
        SIPCommMsgTextArea msgText=new SIPCommMsgTextArea(Messages.getI18NString("unregisteredMessage",protocolProvider.getProtocolName()).getText());
        JOptionPane.showMessageDialog(null,msgText,Messages.getI18NString("error").getText(),JOptionPane.ERROR_MESSAGE);
      }
      logger.error(evt.getReason());
    }
  }
}
