{
  mainPanel=new TransparentPanel(new BorderLayout(10,10));
  mainPanel.setBorder(BorderFactory.createEmptyBorder(8,8,8,8));
  infoTextArea=new JTextArea();
  infoTextArea.setEditable(false);
  infoTextArea.setOpaque(false);
  infoTextArea.setLineWrap(true);
  infoTextArea.setWrapStyleWord(true);
  infoTextArea.setFont(infoTextArea.getFont().deriveFont(Font.BOLD));
  infoTextArea.setText(resources.getI18NString("plugin.securityconfig.masterpassword.INFO_TEXT"));
  labelsPanel=new TransparentPanel(new GridLayout(0,1,8,8));
  labelsPanel.add(new JLabel(resources.getI18NString("plugin.securityconfig.masterpassword.CURRENT_PASSWORD")));
  labelsPanel.add(new JLabel(resources.getI18NString("plugin.securityconfig.masterpassword.ENTER_PASSWORD")));
  labelsPanel.add(new JLabel(resources.getI18NString("plugin.securityconfig.masterpassword.REENTER_PASSWORD")));
  ActionListener clickOkButton=new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      if (okButton.isEnabled())       okButton.doClick();
    }
  }
;
  if (!SecurityConfigActivator.getCredentialsStorageService().isUsingMasterPassword()) {
    currentPasswdField=new JTextField(resources.getI18NString("plugin.securityconfig.masterpassword.MP_NOT_SET"));
    currentPasswdField.setEnabled(false);
  }
 else {
    currentPasswdField=new JPasswordField(15);
    ((JPasswordField)currentPasswdField).addActionListener(clickOkButton);
  }
  newPasswordField=new JPasswordField(15);
  newPasswordField.addKeyListener(this);
  newAgainPasswordField=new JPasswordField(15);
  newAgainPasswordField.addKeyListener(this);
  newPasswordField.addActionListener(clickOkButton);
  newAgainPasswordField.addActionListener(clickOkButton);
  textFieldsPanel=new TransparentPanel(new GridLayout(0,1,8,8));
  textFieldsPanel.add(currentPasswdField);
  textFieldsPanel.add(newPasswordField);
  textFieldsPanel.add(newAgainPasswordField);
  okButton=new JButton(resources.getI18NString("service.gui.OK"));
  okButton.setMnemonic(resources.getI18nMnemonic("service.gui.OK"));
  okButton.addActionListener(this);
  okButton.setEnabled(false);
  cancelButton=new JButton(resources.getI18NString("service.gui.CANCEL"));
  cancelButton.setMnemonic(resources.getI18nMnemonic("service.gui.CANCEL"));
  cancelButton.addActionListener(this);
  passwordQualityBar=new JProgressBar(0,PasswordQualityMeter.TOTAL_POINTS);
  passwordQualityBar.setValue(0);
  qualityPanel=new TransparentPanel();
  qualityPanel.setLayout(new BoxLayout(qualityPanel,BoxLayout.Y_AXIS));
  qualityPanel.add(new JLabel(resources.getI18NString("plugin.securityconfig.masterpassword.PASSWORD_QUALITY_METER")));
  qualityPanel.add(passwordQualityBar);
  qualityPanel.add(Box.createVerticalStrut(15));
  buttonsPanel=new TransparentPanel(new FlowLayout(FlowLayout.CENTER));
  buttonsPanel.add(okButton);
  buttonsPanel.add(cancelButton);
  qualityPanel.add(buttonsPanel);
  mainPanel.add(infoTextArea,BorderLayout.NORTH);
  mainPanel.add(labelsPanel,BorderLayout.WEST);
  mainPanel.add(textFieldsPanel,BorderLayout.CENTER);
  mainPanel.add(qualityPanel,BorderLayout.SOUTH);
}
