{
  super(new BorderLayout());
  SCScrollPane scrollPane=new SCScrollPane();
  this.chatPanel=panel;
  this.editorPane.setContentType("text/html");
  this.editorPane.putClientProperty(JEditorPane.HONOR_DISPLAY_PROPERTIES,Boolean.TRUE);
  this.editorPane.setCaretPosition(0);
  this.editorPane.setEditorKit(new SIPCommHTMLEditorKit(this));
  this.editorPane.getDocument().addUndoableEditListener(this);
  this.editorPane.addKeyListener(this);
  this.editorPane.addMouseListener(this);
  this.editorPane.setCursor(Cursor.getPredefinedCursor(Cursor.TEXT_CURSOR));
  this.editorPane.setDragEnabled(true);
  this.editorPane.setTransferHandler(new ChatTransferHandler(chatPanel));
  this.editTextToolBar=new EditTextToolBar(this);
  this.editTextToolBar.setVisible(ConfigurationManager.isChatStylebarVisible());
  this.add(editTextToolBar,BorderLayout.NORTH);
  this.add(scrollPane,BorderLayout.CENTER);
  this.rightButtonMenu=new WritePanelRightButtonMenu(chatPanel.getChatWindow());
  scrollPane.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);
  scrollPane.setBorder(BorderFactory.createCompoundBorder(BorderFactory.createMatteBorder(1,0,1,0,Color.GRAY),BorderFactory.createEmptyBorder(0,2,0,2)));
  scrollPane.setViewportView(editorPane);
  this.typingTimer.setRepeats(true);
  ConfigurationService configService=GuiActivator.getConfigurationService();
  String messageCommandProperty="service.gui.SEND_MESSAGE_COMMAND";
  String messageCommand=configService.getString(messageCommandProperty);
  if (messageCommand == null)   messageCommand=GuiActivator.getResources().getSettingsString(messageCommandProperty);
  this.changeSendCommand((messageCommand == null || messageCommand.equalsIgnoreCase("enter")));
}
