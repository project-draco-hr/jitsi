{
  if (inputDataSource == null)   throw new IllegalArgumentException("inputDataSource");
synchronized (inputDataSources) {
    for (    InputDataSourceDesc inputDataSourceDesc : inputDataSources)     if (inputDataSource.equals(inputDataSourceDesc.inputDataSource))     throw new IllegalArgumentException("inputDataSource");
    InputDataSourceDesc inputDataSourceDesc=new InputDataSourceDesc(inputDataSource,outputDataSource);
    boolean added=inputDataSources.add(inputDataSourceDesc);
    if (added) {
      if (logger.isTraceEnabled())       logger.trace("Added input DataSource with hashCode " + inputDataSource.hashCode());
      if (connected > 0)       try {
        connect(inputDataSourceDesc.getEffectiveInputDataSource(),inputDataSourceDesc.inputDataSource);
      }
 catch (      IOException ioex) {
        throw new UndeclaredThrowableException(ioex);
      }
      if (outputStream != null)       getOutputStream();
      if (started > 0)       try {
        inputDataSourceDesc.start();
      }
 catch (      IOException ioe) {
        throw new UndeclaredThrowableException(ioe);
      }
    }
  }
}
