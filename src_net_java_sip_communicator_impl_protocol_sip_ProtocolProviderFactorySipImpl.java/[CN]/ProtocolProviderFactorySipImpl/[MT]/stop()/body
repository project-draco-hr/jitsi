{
  logger.trace("Preparing to stop all SIP protocol providers.");
  Enumeration registrations=this.registeredAccounts.elements();
  while (registrations.hasMoreElements()) {
    ServiceRegistration reg=((ServiceRegistration)registrations.nextElement());
    ProtocolProviderServiceSipImpl provider=(ProtocolProviderServiceSipImpl)SipActivator.getBundleContext().getService(reg.getReference());
    provider.shutdown();
    reg.unregister();
  }
  registeredAccounts.clear();
}
