{
  Icon fileIcon=null;
  try {
    sun.awt.shell.ShellFolder shellFolder=sun.awt.shell.ShellFolder.getShellFolder(file);
    fileIcon=new ImageIcon(shellFolder.getIcon(true),shellFolder.getFolderType());
  }
 catch (  Exception e) {
    logger.debug("Failed to obtain file icon from ShellFolder.",e);
    try {
      fileIcon=new JFileChooser().getIcon(file);
    }
 catch (    Exception e1) {
      logger.debug("Failed to obtain file icon from JFileChooser.",e);
    }
  }
  return fileIcon;
}
