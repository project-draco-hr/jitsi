{
  Set set=GuiActivator.getProtocolProviderFactories().entrySet();
  Iterator iter=set.iterator();
  while (iter.hasNext()) {
    Map.Entry entry=(Map.Entry)iter.next();
    ProtocolProviderFactory providerFactory=(ProtocolProviderFactory)entry.getValue();
    ArrayList accountsList=providerFactory.getRegisteredAccounts();
    AccountID accountID;
    ServiceReference serRef;
    ProtocolProviderService protocolProvider;
    for (int i=0; i < accountsList.size(); i++) {
      accountID=(AccountID)accountsList.get(i);
      serRef=providerFactory.getProviderForAccount(accountID);
      protocolProvider=(ProtocolProviderService)GuiActivator.bundleContext.getService(serRef);
      String pName=protocolProvider.getProtocolName();
      JLabel protocolLabel=new JLabel();
      protocolLabel.setText(pName);
      protocolLabel.setIcon(new ImageIcon(Constants.getProtocolIcon(pName)));
      tableModel.addRow(new Object[]{protocolProvider,protocolLabel,accountID.getUserID()});
    }
  }
}
