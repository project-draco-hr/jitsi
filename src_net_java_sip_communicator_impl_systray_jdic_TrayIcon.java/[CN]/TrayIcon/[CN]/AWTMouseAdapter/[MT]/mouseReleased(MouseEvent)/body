{
  if (e.getButton() == MouseEvent.BUTTON3 && !popupVisible) {
    Dimension screen=Toolkit.getDefaultToolkit().getScreenSize();
    int x=e.getX(), y=e.getY();
    if (x < MARGIN)     x=MARGIN;
 else     if (x > screen.getWidth() - MARGIN)     x=(int)screen.getWidth() - MARGIN;
    if (y < MARGIN)     y=MARGIN;
 else     if (y > screen.getHeight() - MARGIN)     y=(int)screen.getWidth() - MARGIN;
    popup.setLocation(x,y);
    if (mframe != null && mframe.isVisible())     popup.setInvoker(mframe);
 else     popup.setInvoker(popup);
    popup.setVisible(true);
    popupVisible=true;
  }
 else {
    popup.setVisible(false);
    popupVisible=false;
  }
}
