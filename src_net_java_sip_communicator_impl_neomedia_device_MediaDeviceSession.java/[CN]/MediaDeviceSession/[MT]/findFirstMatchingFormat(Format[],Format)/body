{
  double formatSampleRate=(format instanceof AudioFormat) ? ((AudioFormat)format).getSampleRate() : Format.NOT_SPECIFIED;
  for (  Format match : formats) {
    if (match.isSameEncoding(format)) {
      if ((formatSampleRate != Format.NOT_SPECIFIED) && (match instanceof AudioFormat)) {
        double matchSampleRate=((AudioFormat)match).getSampleRate();
        if ((matchSampleRate != Format.NOT_SPECIFIED) && (matchSampleRate != formatSampleRate))         continue;
      }
      return match;
    }
  }
  return null;
}
