{
  this.bundleContext=bc;
  ServiceReference refConfig=bundleContext.getServiceReference(ConfigurationService.class.getName());
  configService=(ConfigurationService)bundleContext.getService(refConfig);
  String isMessageHistoryEnabledString=configService.getString("net.java.sip.communicator.impl.msghistory.isMessageHistoryEnabled");
  if (isMessageHistoryEnabledString == null || isMessageHistoryEnabledString == "")   return;
  boolean isMessageHistoryEnabled=new Boolean(isMessageHistoryEnabledString).booleanValue();
  if (!isMessageHistoryEnabled)   return;
  msgHistoryPropListener=new MessageHistoryPropertyChangeListener();
  configService.addPropertyChangeListener("net.java.sip.communicator.impl.msghistory.isMessageHistoryEnabled",msgHistoryPropListener);
  logger.debug("Starting the msg history implementation.");
  this.loadMessageHistoryService();
}
