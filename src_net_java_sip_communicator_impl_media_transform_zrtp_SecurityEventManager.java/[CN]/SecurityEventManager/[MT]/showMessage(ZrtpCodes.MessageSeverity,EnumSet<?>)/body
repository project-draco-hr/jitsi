{
  int multiStreams=0;
  Iterator<?> ii=subCode.iterator();
  Object msgCode=ii.next();
  String messageType=null;
  String message=null;
  String i18nMessage=null;
  if (msgCode instanceof ZrtpCodes.InfoCodes) {
    ZrtpCodes.InfoCodes inf=(ZrtpCodes.InfoCodes)msgCode;
    if (inf == ZrtpCodes.InfoCodes.InfoSecureStateOn) {
      if (isDHSession) {
        multiStreams=((CallSessionImpl)callSession).startZrtpMultiStreams();
        ((AbstractCallParticipant)callParticipant).setSecurityOn(true,sessionType,cipher,sas,isSasVerified);
      }
    }
  }
 else   if (msgCode instanceof ZrtpCodes.WarningCodes) {
    ZrtpCodes.WarningCodes warn=(ZrtpCodes.WarningCodes)msgCode;
    if (warn == ZrtpCodes.WarningCodes.WarningNoRSMatch) {
      messageType=CallParticipantSecurityMessageEvent.SECURITY_AUTHENTICATION_REQUIRED;
      message="No retained shared secret available.";
      i18nMessage=WARNING_NO_RS_MATCH;
    }
 else     if (warn == ZrtpCodes.WarningCodes.WarningNoExpectedRSMatch) {
      messageType=CallParticipantSecurityMessageEvent.RETAINED_SECURITY_AUTHENTICATION_FAILED;
      message="An expected retained shared secret is missing.";
      i18nMessage=WARNING_NO_EXPECTED_RS_MATCH;
    }
 else     if (warn == ZrtpCodes.WarningCodes.WarningCRCmismatch) {
      messageType=CallParticipantSecurityMessageEvent.CHECKSUM_MISMATCH;
      message="Internal ZRTP packet checksum mismatch.";
      i18nMessage=MediaActivator.getResources().getI18NString("impl.media.security.CHECKSUM_MISMATCH");
    }
  }
 else   if (msgCode instanceof ZrtpCodes.SevereCodes) {
    ZrtpCodes.SevereCodes severe=(ZrtpCodes.SevereCodes)msgCode;
    if (severe == ZrtpCodes.SevereCodes.SevereCannotSend) {
      messageType=CallParticipantSecurityMessageEvent.DATA_SEND_FAILED;
      message="Failed to send data." + "Internet data connection or peer is down.";
      i18nMessage=MediaActivator.getResources().getI18NString("impl.media.security.DATA_SEND_FAILED",new String[]{msgCode.toString()});
    }
 else     if (severe == ZrtpCodes.SevereCodes.SevereTooMuchRetries) {
      messageType=CallParticipantSecurityMessageEvent.RETRY_RATE_EXCEEDED;
      message="Too much retries during ZRTP negotiation.";
      i18nMessage=MediaActivator.getResources().getI18NString("impl.media.security.RETRY_RATE_EXCEEDED",new String[]{msgCode.toString()});
    }
 else     if (severe == ZrtpCodes.SevereCodes.SevereProtocolError) {
      messageType=CallParticipantSecurityMessageEvent.INTERNAL_PROTOCOL_ERROR;
      message="Internal protocol error occured.";
      i18nMessage=MediaActivator.getResources().getI18NString("impl.media.security.INTERNAL_PROTOCOL_ERROR",new String[]{msgCode.toString()});
    }
 else {
      messageType=CallParticipantSecurityMessageEvent.GENERAL_ERROR;
      message="General error has occurred.";
      i18nMessage=MediaActivator.getResources().getI18NString("impl.media.security.ZRTP_GENERIC_MSG",new String[]{msgCode.toString()});
    }
  }
 else   if (msgCode instanceof ZrtpCodes.ZrtpErrorCodes) {
    messageType=CallParticipantSecurityMessageEvent.NOT_COMPATIBLE;
    message="Indicates compatibility problems like for example:" + "unsupported protocol version, unsupported hash type," + "cypher type, SAS scheme, etc.";
    i18nMessage=MediaActivator.getResources().getI18NString("impl.media.security.ZRTP_GENERIC_MSG",new String[]{msgCode.toString()});
  }
  if (messageType != null)   ((AbstractCallParticipant)callParticipant).setSecurityMessage(messageType,message,i18nMessage);
  if (logger.isInfoEnabled()) {
    logger.info(sessionType + ": " + "ZRTP message: severity: "+ sev+ ", sub code: "+ msgCode+ ", DH session: "+ isDHSession+ ", multi: "+ multiStreams);
  }
}
