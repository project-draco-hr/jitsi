{
  int multiStreams=0;
  Iterator<?> ii=subCode.iterator();
  Object msgCode=ii.next();
  String message=null;
  String i18nMessage=null;
  int severity=0;
  boolean sendEvent=true;
  if (msgCode instanceof ZrtpCodes.InfoCodes) {
    ZrtpCodes.InfoCodes inf=(ZrtpCodes.InfoCodes)msgCode;
    sendEvent=false;
    if (inf == ZrtpCodes.InfoCodes.InfoSecureStateOn) {
      if (isDHSession) {
        multiStreams=((CallSessionImpl)callSession).startZrtpMultiStreams();
        participantSecurityCallback.securityOn(sessionType,cipher,sas,isSasVerified);
      }
 else {
        participantSecurityCallback.securityOn(sessionType,cipher,null,false);
      }
    }
  }
 else   if (msgCode instanceof ZrtpCodes.WarningCodes) {
    ZrtpCodes.WarningCodes warn=(ZrtpCodes.WarningCodes)msgCode;
    severity=CallParticipantSecurityMessageEvent.WARNING;
    if (warn == ZrtpCodes.WarningCodes.WarningNoRSMatch) {
      message="No retained shared secret available.";
      i18nMessage=WARNING_NO_RS_MATCH;
    }
 else     if (warn == ZrtpCodes.WarningCodes.WarningNoExpectedRSMatch) {
      message="An expected retained shared secret is missing.";
      i18nMessage=WARNING_NO_EXPECTED_RS_MATCH;
    }
 else     if (warn == ZrtpCodes.WarningCodes.WarningCRCmismatch) {
      message="Internal ZRTP packet checksum mismatch.";
      i18nMessage=MediaActivator.getResources().getI18NString("impl.media.security.CHECKSUM_MISMATCH");
    }
 else {
      sendEvent=false;
    }
  }
 else   if (msgCode instanceof ZrtpCodes.SevereCodes) {
    ZrtpCodes.SevereCodes severe=(ZrtpCodes.SevereCodes)msgCode;
    severity=CallParticipantSecurityMessageEvent.SEVERE;
    if (severe == ZrtpCodes.SevereCodes.SevereCannotSend) {
      message="Failed to send data." + "Internet data connection or peer is down.";
      i18nMessage=MediaActivator.getResources().getI18NString("impl.media.security.DATA_SEND_FAILED",new String[]{msgCode.toString()});
    }
 else     if (severe == ZrtpCodes.SevereCodes.SevereTooMuchRetries) {
      message="Too much retries during ZRTP negotiation.";
      i18nMessage=MediaActivator.getResources().getI18NString("impl.media.security.RETRY_RATE_EXCEEDED",new String[]{msgCode.toString()});
    }
 else     if (severe == ZrtpCodes.SevereCodes.SevereProtocolError) {
      message="Internal protocol error occured.";
      i18nMessage=MediaActivator.getResources().getI18NString("impl.media.security.INTERNAL_PROTOCOL_ERROR",new String[]{msgCode.toString()});
    }
 else {
      message="General error has occurred.";
      i18nMessage=MediaActivator.getResources().getI18NString("impl.media.security.ZRTP_GENERIC_MSG",new String[]{msgCode.toString()});
    }
  }
 else   if (msgCode instanceof ZrtpCodes.ZrtpErrorCodes) {
    severity=CallParticipantSecurityMessageEvent.ERROR;
    message="Indicates compatibility problems like for example:" + "unsupported protocol version, unsupported hash type," + "cypher type, SAS scheme, etc.";
    i18nMessage=MediaActivator.getResources().getI18NString("impl.media.security.ZRTP_GENERIC_MSG",new String[]{msgCode.toString()});
  }
 else {
    sendEvent=false;
  }
  if (sendEvent)   participantSecurityCallback.securityMessage(message,i18nMessage,severity);
  if (logger.isInfoEnabled()) {
    logger.info(sessionTypeToString(sessionType) + ": " + "ZRTP message: severity: "+ sev+ ", sub code: "+ msgCode+ ", DH session: "+ isDHSession+ ", multi: "+ multiStreams);
  }
}
