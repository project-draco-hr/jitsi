{
  ChatRoomMemberIrcImpl member;
  ISource source=msg.getSource();
  if (source instanceof IRCServer) {
    member=new ChatRoomMemberIrcImpl(IrcStack.this.provider,this.chatroom,"",ChatRoomMemberRole.ADMINISTRATOR);
  }
 else   if (source instanceof IRCUser) {
    String nick=((IRCUser)source).getNick();
    member=(ChatRoomMemberIrcImpl)this.chatroom.getChatRoomMember(nick);
  }
 else {
    throw new IllegalArgumentException("Unknown source type: " + source.getClass().getName());
  }
  return member;
}
