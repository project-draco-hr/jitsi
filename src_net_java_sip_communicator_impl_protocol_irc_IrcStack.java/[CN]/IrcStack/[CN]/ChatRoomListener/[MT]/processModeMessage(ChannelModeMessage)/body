{
  ModeParser parser=new ModeParser(msg);
  for (  ModeEntry mode : parser.getModes()) {
switch (mode.getMode()) {
case OWNER:
      String ownerUserName=mode.getParams()[0];
    if (isMe(ownerUserName)) {
      System.out.println("Local user owner change! " + mode.isAdded());
    }
 else {
      ChatRoomMember owner=this.chatroom.getChatRoomMember(mode.getParams()[0]);
      if (mode.isAdded()) {
        this.chatroom.fireMemberRoleEvent(owner,ChatRoomMemberRole.OWNER);
      }
 else {
        this.chatroom.fireMemberRoleEvent(owner,ChatRoomMemberRole.SILENT_MEMBER);
      }
    }
  break;
case OPERATOR:
String opUserName=mode.getParams()[0];
if (isMe(opUserName)) {
System.out.println("Local user op change! " + mode.isAdded());
}
 else {
ChatRoomMember op=this.chatroom.getChatRoomMember(opUserName);
if (mode.isAdded()) {
  this.chatroom.fireMemberRoleEvent(op,ChatRoomMemberRole.ADMINISTRATOR);
}
 else {
  this.chatroom.fireMemberRoleEvent(op,ChatRoomMemberRole.SILENT_MEMBER);
}
}
break;
case VOICE:
String voiceUserName=mode.getParams()[0];
if (isMe(voiceUserName)) {
System.out.println("Local user voice change! " + mode.isAdded());
}
 else {
ChatRoomMember voice=this.chatroom.getChatRoomMember(voiceUserName);
if (mode.isAdded()) {
this.chatroom.fireMemberRoleEvent(voice,ChatRoomMemberRole.MEMBER);
}
 else {
this.chatroom.fireMemberRoleEvent(voice,ChatRoomMemberRole.SILENT_MEMBER);
}
}
break;
default :
System.out.println("Unsupported mode '" + (mode.isAdded() ? "+" : "-") + mode.getMode()+ "' (from modestring '"+ msg.getModeStr()+ "')");
break;
}
}
}
