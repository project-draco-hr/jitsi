{
  final IRCServer server;
  if (secureConnection) {
    server=new SecureIRCServer(host,port,password,getCustomSSLContext(host));
  }
 else {
    server=new IRCServer(host,port,password,false);
  }
  try {
synchronized (this.session) {
      final IrcConnection current=this.session.get();
      if (current != null && current.isConnected()) {
        return;
      }
      this.params.setServer(server);
      final IRCApi irc=new IRCApiImpl(true);
      if (LOGGER.isTraceEnabled()) {
        irc.addListener(new DebugListener());
      }
      this.session.set(new IrcConnection(this.provider,this.params,new SynchronizedIRCApi(irc),this));
      this.provider.setCurrentRegistrationState(RegistrationState.REGISTERED);
    }
  }
 catch (  IOException e) {
    this.provider.setCurrentRegistrationState(RegistrationState.CONNECTION_FAILED);
    throw e;
  }
catch (  InterruptedException e) {
    this.provider.setCurrentRegistrationState(RegistrationState.UNREGISTERED);
    throw e;
  }
}
