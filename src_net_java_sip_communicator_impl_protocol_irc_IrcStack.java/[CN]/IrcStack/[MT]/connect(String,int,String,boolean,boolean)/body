{
  if (isConnected()) {
    return;
  }
  this.joined.clear();
  final IRCServer server;
  if (secureConnection) {
    server=new SecureIRCServer(host,port,password,getCustomSSLContext(host));
  }
 else {
    server=new IRCServer(host,port,password,false);
  }
synchronized (this.session) {
    final IRCApi irc=new IRCApiImpl(true);
    this.params.setServer(server);
    this.session.set(irc);
    irc.addListener(new ServerListener(irc));
    if (LOGGER.isTraceEnabled()) {
      irc.addListener(new DebugListener());
    }
    try {
      connectSynchronized();
      this.presence=new PresenceManager(irc,this.connectionState,this.provider.getPersistentPresence());
      queryIdentity();
      this.provider.setCurrentRegistrationState(RegistrationState.REGISTERED);
    }
 catch (    IOException e) {
      this.provider.setCurrentRegistrationState(RegistrationState.CONNECTION_FAILED);
      throw e;
    }
catch (    InterruptedException e) {
      this.provider.setCurrentRegistrationState(RegistrationState.UNREGISTERED);
      throw e;
    }
  }
}
