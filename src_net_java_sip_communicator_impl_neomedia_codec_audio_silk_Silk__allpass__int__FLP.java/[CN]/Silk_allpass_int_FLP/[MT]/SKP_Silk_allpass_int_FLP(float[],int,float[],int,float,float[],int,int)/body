{
  float Y2, X2, S0;
  int k;
  S0=S[S_offset];
  for (k=len - 1; k >= 0; k--) {
    Y2=in[in_offset] - S0;
    X2=Y2 * A;
    out[out_offset++]=S0 + X2;
    S0=in[in_offset++] + X2;
  }
  S[S_offset]=S0;
}
