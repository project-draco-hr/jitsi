{
  if (logger.isDebugEnabled())   logger.debug("ZEROCONF/JMDNS: Received record update for " + record);
  int clazz=record.getClazz();
  int type=record.getType();
  if (!(((type & DNSConstants.TYPE_TXT) != 0) && ((clazz & DNSConstants.CLASS_IN) != 0) && record.isUnique()&& record.getName().endsWith("_presence._tcp.local.")))   return;
  String name=record.getName().replaceAll("._presence._tcp.local.","");
  ContactZeroconfImpl contact;
synchronized (this) {
    contact=getContact(name,null);
    if (contact == null) {
      logger.error("ZEROCONF: BUG in jmDNS => Received update without " + "previous contact annoucement. Trying to add contact");
      new AddThread("_presence._tcp.local.",name);
      return;
    }
  }
  if (logger.isDebugEnabled())   logger.debug("ZEROCONF: " + name + " changed status. Requesting fresh data!");
  ServiceInfo info=jmdns.getServiceInfo("_presence._tcp.local.",name,1000);
  if (info == null) {
    logger.error("ZEROCONF/JMDNS: Problem!! The service " + "information was not in cache. See comment in " + "BonjourService.java:updateRecord !!");
    return;
  }
  ZeroconfStatusEnum status=ZeroconfStatusEnum.statusOf(info.getPropertyString("status"));
  opSetPersPresence.changePresenceStatusForContact(contact,status == null ? ZeroconfStatusEnum.ONLINE : status);
}
