{
  cachedCredentials.clear();
  SipActivator.getProtocolProviderFactory().storePassword(accountID,null);
  Request challengedRequest=endedTransaction.getRequest();
  Request reoriginatedRequest=(Request)challengedRequest.clone();
  removeBranchID(reoriginatedRequest);
  List<String> realms=removeAuthHeaders(reoriginatedRequest);
  CSeqHeader cSeq=(CSeqHeader)reoriginatedRequest.getHeader((CSeqHeader.NAME));
  cSeq.setSeqNumber(cSeq.getSeqNumber() + 1l);
  ClientTransaction retryTran=transactionCreator.getNewClientTransaction(reoriginatedRequest);
  Iterator<String> realmsIter=realms.iterator();
  while (realmsIter.hasNext()) {
    CredentialsCacheEntry ccEntry=createCcEntryWithStoredPassword("");
    ccEntry.pushBranchID(retryTran.getBranchId());
    cachedCredentials.cacheEntry(realmsIter.next(),ccEntry);
  }
  logger.debug("Returning authorization transaction.");
  return retryTran;
}
