{
  Iterator readers=ImageIO.getImageReadersBySuffix("gif");
  ImageReader reader=(ImageReader)readers.next();
  ImageInputStream iis;
  BufferedImage[] images=null;
  try {
    iis=ImageIO.createImageInputStream(new ByteArrayInputStream(animatedImage));
    reader.setInput(iis);
    int numImages=reader.getNumImages(true);
    if (numImages == 0)     return null;
    images=new BufferedImage[numImages];
    for (int i=0; i < numImages; ++i) {
      images[i]=reader.read(i);
    }
  }
 catch (  IOException e) {
    log.error("Failed to load image.",e);
  }
 finally {
    log.logExit();
  }
  return images;
}
