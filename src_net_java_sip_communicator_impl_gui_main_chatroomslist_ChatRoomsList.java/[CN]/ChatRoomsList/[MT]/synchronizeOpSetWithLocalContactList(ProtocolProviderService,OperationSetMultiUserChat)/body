{
  MultiUserChatServerWrapper serverWrapper=findServerWrapperFromProvider(protocolProvider);
  int serverIndex=listModel.indexOf(serverWrapper);
  for (int i=serverIndex + 1; i < listModel.size(); i++) {
    final Object o=listModel.get(i);
    if (!(o instanceof ChatRoomWrapper))     break;
    new Thread(){
      public void run(){
        ChatRoomWrapper chatRoomWrapper=(ChatRoomWrapper)o;
        ChatRoom chatRoom=null;
        try {
          chatRoom=opSet.findRoom(chatRoomWrapper.getChatRoomName());
        }
 catch (        OperationFailedException e1) {
          logger.error("Failed to find chat room with name:" + chatRoomWrapper.getChatRoomName(),e1);
        }
catch (        OperationNotSupportedException e1) {
          logger.error("Failed to find chat room with name:" + chatRoomWrapper.getChatRoomName(),e1);
        }
        if (chatRoom != null) {
          chatRoomWrapper.setChatRoom(chatRoom);
          String lastChatRoomStatus=ConfigurationManager.getChatRoomStatus(chatRoomWrapper.getParentProvider(),chatRoomWrapper.getChatRoomID());
          if (lastChatRoomStatus == null || lastChatRoomStatus.equals(Constants.ONLINE_STATUS)) {
            mainFrame.getMultiUserChatManager().joinChatRoom(chatRoom);
          }
        }
      }
    }
.start();
  }
}
