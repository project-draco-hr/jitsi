{
  if ((pkt.readByte(0) & 0xC0) != 0x80)   return null;
  long ssrc=pkt.getSSRC();
  int seqNum=pkt.getSequenceNumber();
  SRTPCryptoContext context=contexts.get(ssrc);
  if (context == null) {
    logger.debug("InContext created for SSRC=" + Long.toHexString(ssrc) + " and key "+ inAttribute.getKeyParams()[0].encode());
    context=createContext(ssrc,inAttribute);
    context.deriveSrtpKeys(seqNum);
    contexts.put(ssrc,context);
  }
  boolean validPacket=context.reverseTransformPacket(pkt);
  if (!validPacket) {
    return null;
  }
  return pkt;
}
