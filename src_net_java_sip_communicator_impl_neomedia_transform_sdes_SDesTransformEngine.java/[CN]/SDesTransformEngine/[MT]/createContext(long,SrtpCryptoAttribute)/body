{
  int encType;
  SrtpCryptoSuite cs=attribute.getCryptoSuite();
switch (cs.getEncryptionAlgorithm()) {
case SrtpCryptoSuite.ENCRYPTION_AES128_CM:
    encType=SRTPPolicy.AESCM_ENCRYPTION;
  break;
case SrtpCryptoSuite.ENCRYPTION_AES128_F8:
encType=SRTPPolicy.AESF8_ENCRYPTION;
break;
default :
throw new IllegalArgumentException("Unsupported cipher");
}
int authType;
switch (cs.getHashAlgorithm()) {
case SrtpCryptoSuite.HASH_HMAC_SHA1:
authType=SRTPPolicy.HMACSHA1_AUTHENTICATION;
break;
default :
throw new IllegalArgumentException("Unsupported hash");
}
SRTPPolicy policy=new SRTPPolicy(encType,cs.getEncKeyLength() / 8,authType,cs.getSrtpAuthKeyLength() / 8,cs.getSrtpAuthTagLength() / 8,cs.getSaltKeyLength() / 8);
return new SRTPCryptoContext(ssrc,0,getKdr(attribute),getKey(attribute),getSalt(attribute),policy);
}
