{
  super(new BorderLayout(10,5));
  this.chatContact=contact;
  this.chatPanel=chatPanel;
  this.addMouseListener(this);
  this.mainPanel.setBorder(BorderFactory.createEmptyBorder(3,3,3,3));
  this.setOpaque(false);
  this.mainPanel.setOpaque(false);
  this.buttonsPanel.setOpaque(false);
  this.personPhotoPanel.setOpaque(false);
  this.personNameLabel.setText(chatContact.getName());
  this.personNameLabel.setFont(this.getFont().deriveFont(Font.BOLD));
  this.personNameLabel.setIcon(chatContact.getStatusIcon());
  this.callButton.setToolTipText(Messages.getI18NString("call").getText());
  this.infoButton.setToolTipText(Messages.getI18NString("userInfo").getText());
  this.sendFileButton.setToolTipText(Messages.getI18NString("sendFile").getText());
  this.callButton.setName("call");
  this.infoButton.setName("info");
  this.callButton.addActionListener(this);
  this.infoButton.addActionListener(this);
  this.buttonsPanel.add(infoButton);
  this.buttonsPanel.add(callButton);
  this.buttonsPanel.add(sendFileButton);
  this.buttonsPanel.setVisible(false);
  this.mainPanel.add(buttonsPanel,BorderLayout.NORTH);
  this.mainPanel.add(personNameLabel,BorderLayout.CENTER);
  this.personPhotoPanel.setBorder(BorderFactory.createEmptyBorder(5,5,5,5));
  this.personPhotoPanel.add(personPhotoLabel,BorderLayout.NORTH);
  this.add(personPhotoPanel,BorderLayout.WEST);
  this.add(mainPanel,BorderLayout.CENTER);
  ProtocolProviderService pps=chatContact.getProtocolProvider();
  if (chatContact.getSourceContact() instanceof Contact) {
    Contact c=(Contact)chatContact.getSourceContact();
    MetaContact m=chatPanel.getChatWindow().getMainFrame().getContactList().findMetaContactByContact(c);
    if (m.getDefaultContact(OperationSetBasicTelephony.class) == null)     this.callButton.setEnabled(false);
    if (m.getDefaultContact(OperationSetFileTransfer.class) == null)     this.sendFileButton.setEnabled(false);
  }
 else {
    if (pps.getOperationSet(OperationSetBasicTelephony.class) == null)     this.callButton.setEnabled(false);
    if (pps.getOperationSet(OperationSetFileTransfer.class) == null)     this.sendFileButton.setEnabled(false);
  }
  new Thread(){
    public void run(){
      contactPhotoIcon=chatContact.getImage();
      SwingUtilities.invokeLater(new Runnable(){
        public void run(){
          if (contactPhotoIcon != null) {
            personPhotoLabel.setBorder(new SIPCommBorders.BoldRoundBorder());
            personPhotoLabel.setIcon(contactPhotoIcon);
          }
        }
      }
);
    }
  }
.start();
  Object contactInfoOpSet=pps.getOperationSet(OperationSetWebContactInfo.class);
  if (contactInfoOpSet == null)   infoButton.setEnabled(false);
 else   infoButton.setEnabled(true);
  this.updateStatusIcon();
}
