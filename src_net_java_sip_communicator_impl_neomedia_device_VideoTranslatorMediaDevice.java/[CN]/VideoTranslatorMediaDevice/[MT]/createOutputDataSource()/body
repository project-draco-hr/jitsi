{
  if (deviceSession == null) {
    MediaFormatImpl<? extends Format> format=null;
    MediaDirection startedDirection=MediaDirection.INACTIVE;
    for (    MediaStreamMediaDeviceSession streamDeviceSession : streamDeviceSessions) {
      MediaFormatImpl<? extends Format> streamFormat=streamDeviceSession.getFormat();
      if ((streamFormat != null) && (format == null))       format=streamFormat;
      startedDirection=startedDirection.or(streamDeviceSession.getStartedDirection());
    }
    deviceSession=device.createSession();
    if (format != null)     deviceSession.setFormat(format);
    deviceSession.start(startedDirection);
  }
  return (deviceSession == null) ? null : deviceSession.getOutputDataSource();
}
