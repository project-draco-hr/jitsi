{
  byte[] avatarBytes=metaContact.getAvatar(true);
  ImageIcon avatar=null;
  if ((avatarBytes == null) || (avatarBytes.length <= 0))   return null;
  if (isSelected)   return ImageUtils.getScaledRoundedIcon(avatarBytes,width,height);
  Object[] avatarCache=(Object[])metaContact.getData(AVATAR_DATA_KEY);
  if ((avatarCache != null) && (avatarCache[0] == avatarBytes))   avatar=(ImageIcon)avatarCache[1];
  int avatarWidth=width;
  int avatarHeight=height;
  if (avatar == null)   avatar=ImageUtils.getScaledRoundedIcon(avatarBytes,avatarWidth,avatarHeight);
  if (avatarCache == null) {
    if (avatar != null)     metaContact.setData(AVATAR_DATA_KEY,new Object[]{avatarBytes,avatar});
  }
 else {
    avatarCache[0]=avatarBytes;
    avatarCache[1]=avatar;
  }
  return avatar;
}
