{
  this.assertConnected();
  this.nickname=nickname;
  try {
    multiUserChat.join(nickname);
    ChatRoomMemberJabberImpl member=new ChatRoomMemberJabberImpl(this,nickname,provider.getAccountID().getAccountAddress(),ChatRoomMemberRole.GUEST);
    members.put(nickname,member);
    opSetMuc.fireLocalUserPresenceEvent(this,LocalUserChatRoomPresenceChangeEvent.LOCAL_USER_JOINED,null);
  }
 catch (  XMPPException ex) {
    String errorMessage;
    if (ex.getXMPPError().getCode() == 401) {
      errorMessage="Failed to join chat room " + getName() + " with nickname: "+ nickname+ ". The chat room requests a password.";
      logger.error(errorMessage,ex);
      throw new OperationFailedException(errorMessage,OperationFailedException.AUTHENTICATION_FAILED,ex);
    }
 else     if (ex.getXMPPError().getCode() == 407) {
      errorMessage="Failed to join chat room " + getName() + " with nickname: "+ nickname+ ". The chat room requires registration.";
      logger.error(errorMessage,ex);
      throw new OperationFailedException(errorMessage,OperationFailedException.REGISTRATION_REQUIRED,ex);
    }
 else {
      errorMessage="Failed to join room " + getName() + " with nickname: "+ nickname;
      logger.error(errorMessage,ex);
      throw new OperationFailedException(errorMessage,OperationFailedException.GENERAL_ERROR,ex);
    }
  }
}
