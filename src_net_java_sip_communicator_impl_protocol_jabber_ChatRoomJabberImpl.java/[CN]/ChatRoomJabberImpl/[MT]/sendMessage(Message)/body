{
  try {
    assertConnected();
    org.jivesoftware.smack.packet.Message msg=new org.jivesoftware.smack.packet.Message();
    msg.setBody(message.getContent());
    msg.addExtension(new Version());
    MessageEventManager.addNotificationsRequests(msg,true,false,false,true);
    multiUserChat.sendMessage(message.getContent());
    ChatRoomMessageDeliveredEvent msgDeliveredEvt=new ChatRoomMessageDeliveredEvent(this,System.currentTimeMillis(),message,ChatRoomMessageDeliveredEvent.CONVERSATION_MESSAGE_DELIVERED);
    fireMessageEvent(msgDeliveredEvt);
  }
 catch (  XMPPException ex) {
    logger.error("Failed to send message " + message,ex);
    throw new OperationFailedException("Failed to send message " + message,OperationFailedException.GENERAL_ERROR,ex);
  }
}
