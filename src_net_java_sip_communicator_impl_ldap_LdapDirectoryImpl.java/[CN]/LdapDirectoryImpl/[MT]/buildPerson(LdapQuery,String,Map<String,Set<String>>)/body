{
  LdapPersonFound person=new LdapPersonFoundImpl(LdapDirectoryImpl.this,dn,query);
  if (retrievedAttributes.get("givenname") != null) {
    String firstName=retrievedAttributes.get("givenname").iterator().next();
    person.setFirstName(firstName);
  }
 else   if (retrievedAttributes.get("givenName") != null) {
    String firstName=retrievedAttributes.get("givenName").iterator().next();
    person.setFirstName(firstName);
  }
 else   if (retrievedAttributes.get("gn") != null) {
    String firstName=retrievedAttributes.get("gn").iterator().next();
    person.setFirstName(firstName);
  }
  if (retrievedAttributes.get("sn") != null) {
    String surname=retrievedAttributes.get("sn").iterator().next();
    person.setSurname(surname);
  }
 else   if (retrievedAttributes.get("surname") != null) {
    String surname=retrievedAttributes.get("surname").iterator().next();
    person.setSurname(surname);
  }
  if (retrievedAttributes.get("displayName") != null) {
    String displayName=retrievedAttributes.get("displayName").iterator().next();
    person.setDisplayName(displayName);
  }
 else   if (retrievedAttributes.get("cn") != null) {
    String displayName=retrievedAttributes.get("cn").iterator().next();
    person.setDisplayName(displayName);
  }
 else   if (retrievedAttributes.get("commonname") != null) {
    String displayName=retrievedAttributes.get("commonname").iterator().next();
    person.setDisplayName(displayName);
  }
  if (person.getDisplayName() == null) {
    person.setDisplayName("" + person.getFirstName() + person.getSurname());
  }
  if (person.getDisplayName() == null) {
    throw new RuntimeException("display name is null!");
  }
  if (retrievedAttributes.get("o") != null) {
    String organization=retrievedAttributes.get("o").iterator().next();
    person.setOrganization(organization);
  }
 else   if (retrievedAttributes.get("organizationName") != null) {
    String organization=retrievedAttributes.get("organizationName").iterator().next();
    person.setOrganization(organization);
  }
 else   if (retrievedAttributes.get("company") != null) {
    String organization=retrievedAttributes.get("company").iterator().next();
    person.setOrganization(organization);
  }
  if (retrievedAttributes.get("company") != null) {
    String department=retrievedAttributes.get("company").iterator().next();
    person.setDepartment(department);
  }
 else   if (retrievedAttributes.get("ou") != null) {
    String department=retrievedAttributes.get("ou").iterator().next();
    person.setDepartment(department);
  }
 else   if (retrievedAttributes.get("orgunit") != null) {
    String department=retrievedAttributes.get("orgunit").iterator().next();
    person.setDepartment(department);
  }
 else   if (retrievedAttributes.get("organizationalUnitName") != null) {
    String department=retrievedAttributes.get("organizationalUnitName").iterator().next();
    person.setDepartment(department);
  }
 else   if (retrievedAttributes.get("department") != null) {
    String department=retrievedAttributes.get("department").iterator().next();
    person.setDepartment(department);
  }
 else   if (retrievedAttributes.get("departmentNumber") != null) {
    String department=retrievedAttributes.get("departmentNumber").iterator().next();
    person.setDepartment(department);
  }
  if (retrievedAttributes.get("mail") != null) {
    for (    String mail : retrievedAttributes.get("mail")) {
      person.addMail(mail);
    }
  }
  if (retrievedAttributes.get("primaryPhone") != null) {
    String phone=retrievedAttributes.get("primaryPhone").iterator().next();
    person.addWorkPhone(phone);
  }
  if (retrievedAttributes.get("companyPhone") != null) {
    for (    String phone : retrievedAttributes.get("companyPhone")) {
      person.addWorkPhone(phone);
    }
  }
  if (retrievedAttributes.get("telephoneNumber") != null) {
    for (    String phone : retrievedAttributes.get("telephoneNumber")) {
      person.addWorkPhone(phone);
    }
  }
  if (retrievedAttributes.get("otherTelephone") != null) {
    for (    String phone : retrievedAttributes.get("otherTelephone")) {
      person.addWorkPhone(phone);
    }
  }
  if (retrievedAttributes.get("tel") != null) {
    for (    String phone : retrievedAttributes.get("tel")) {
      person.addWorkPhone(phone);
    }
  }
  if (retrievedAttributes.get("mobile") != null) {
    for (    String phone : retrievedAttributes.get("mobile")) {
      person.addMobilePhone(phone);
    }
  }
  if (retrievedAttributes.get("mobileTelephoneNumber") != null) {
    for (    String phone : retrievedAttributes.get("mobileTelephoneNumber")) {
      person.addMobilePhone(phone);
    }
  }
  if (retrievedAttributes.get("cellPhone") != null) {
    for (    String phone : retrievedAttributes.get("cellPhone")) {
      person.addMobilePhone(phone);
    }
  }
  if (retrievedAttributes.get("otherMobile") != null) {
    for (    String phone : retrievedAttributes.get("otherMobile")) {
      person.addMobilePhone(phone);
    }
  }
  if (retrievedAttributes.get("carPhone") != null) {
    for (    String phone : retrievedAttributes.get("carPhone")) {
      person.addMobilePhone(phone);
    }
  }
  if (retrievedAttributes.get("homePhone") != null) {
    for (    String phone : retrievedAttributes.get("homePhone")) {
      person.addHomePhone(phone);
    }
  }
  if (retrievedAttributes.get("otherHomePhone") != null) {
    for (    String phone : retrievedAttributes.get("otherHomePhone")) {
      person.addHomePhone(phone);
    }
  }
  return person;
}
