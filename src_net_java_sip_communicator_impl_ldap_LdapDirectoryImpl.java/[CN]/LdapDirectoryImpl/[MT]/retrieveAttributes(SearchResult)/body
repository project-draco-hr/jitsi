{
  Attributes attributes=searchResult.getAttributes();
  Map<String,Set<String>> retrievedAttributes=new HashMap<String,Set<String>>();
  NamingEnumeration<String> ids=attributes.getIDs();
  while (ids.hasMore()) {
    String id=ids.next();
    if (retrievableAttributes.contains(id)) {
      Set<String> valuesSet=new HashSet<String>();
      retrievedAttributes.put(id,valuesSet);
      Attribute attribute=attributes.get(id);
      NamingEnumeration<?> values=attribute.getAll();
      while (values.hasMore()) {
        String value=(String)values.next();
        valuesSet.add(value);
      }
    }
  }
  return retrievedAttributes;
}
