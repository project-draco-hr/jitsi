{
  JMenuItem menuItem=(JMenuItem)e.getSource();
  String itemName=menuItem.getName();
  ConferenceChatManager conferenceManager=GuiActivator.getUIService().getConferenceChatManager();
  if (itemName.equals("removeChatRoom")) {
    conferenceManager.removeChatRoom(chatRoomWrapper);
  }
 else   if (itemName.equals("leaveChatRoom")) {
    conferenceManager.leaveChatRoom(chatRoomWrapper);
  }
 else   if (itemName.equals("joinChatRoom")) {
    String nickName=null;
    nickName=ConfigurationUtils.getChatRoomProperty(chatRoomWrapper.getParentProvider().getProtocolProvider(),chatRoomWrapper.getChatRoomID(),"userNickName");
    if (nickName == null)     nickName=getNickname();
    if (nickName != null)     conferenceManager.joinChatRoom(chatRoomWrapper,nickName,null);
 else     conferenceManager.joinChatRoom(chatRoomWrapper);
  }
 else   if (itemName.equals("openChatRoom")) {
    if (chatRoomWrapper.getChatRoom() != null) {
      if (!chatRoomWrapper.getChatRoom().isJoined()) {
        String nickName=null;
        nickName=ConfigurationUtils.getChatRoomProperty(chatRoomWrapper.getParentProvider().getProtocolProvider(),chatRoomWrapper.getChatRoomID(),"userNickName");
        if (nickName == null)         nickName=getNickname();
        if (nickName != null)         conferenceManager.joinChatRoom(chatRoomWrapper,nickName,null);
 else         conferenceManager.joinChatRoom(chatRoomWrapper);
      }
    }
 else {
      chatRoomWrapper=GuiActivator.getUIService().getConferenceChatManager().createChatRoom(chatRoomWrapper.getChatRoomName(),chatRoomWrapper.getParentProvider().getProtocolProvider(),new ArrayList<String>(),"",false,true);
      String nickName=null;
      nickName=ConfigurationUtils.getChatRoomProperty(chatRoomWrapper.getParentProvider().getProtocolProvider(),chatRoomWrapper.getChatRoomID(),"userNickName");
      if (nickName == null)       nickName=getNickname();
      if (nickName != null)       conferenceManager.joinChatRoom(chatRoomWrapper,nickName,null);
 else       conferenceManager.joinChatRoom(chatRoomWrapper);
    }
    ChatWindowManager chatWindowManager=GuiActivator.getUIService().getChatWindowManager();
    ChatPanel chatPanel=chatWindowManager.getMultiChat(chatRoomWrapper,true);
    chatWindowManager.openChat(chatPanel,true);
  }
 else   if (itemName.equals("joinAsChatRoom")) {
    String nickName=null;
    ChatOperationReasonDialog reasonDialog=new ChatOperationReasonDialog(GuiActivator.getResources().getI18NString("service.gui.CHANGE_NICKNAME"),GuiActivator.getResources().getI18NString("service.gui.CHANGE_NICKNAME_LABEL"));
    reasonDialog.setReasonFieldText(chatRoomWrapper.getChatRoom().getUserNickname());
    int result=reasonDialog.showDialog();
    if (result == MessageDialog.OK_RETURN_CODE) {
      nickName=reasonDialog.getReason().trim();
      ConfigurationUtils.updateChatRoomProperty(chatRoomWrapper.getParentProvider().getProtocolProvider(),chatRoomWrapper.getChatRoomID(),"userNickName",nickName);
    }
    GuiActivator.getUIService().getConferenceChatManager().joinChatRoom(chatRoomWrapper,nickName,null);
  }
 else   if (itemName.equals("nickNameChatRoom")) {
    String nickName=null;
    nickName=ConfigurationUtils.getChatRoomProperty(chatRoomWrapper.getParentProvider().getProtocolProvider(),chatRoomWrapper.getChatRoomID(),"userNickName");
    ChatOperationReasonDialog reasonDialog=new ChatOperationReasonDialog(GuiActivator.getResources().getI18NString("service.gui.CHANGE_NICKNAME"),GuiActivator.getResources().getI18NString("service.gui.CHANGE_NICKNAME_LABEL"));
    reasonDialog.setReasonFieldText(nickName == null ? chatRoomWrapper.getParentProvider().getProtocolProvider().getAccountID().getUserID() : nickName);
    int result=reasonDialog.showDialog();
    if (result == MessageDialog.OK_RETURN_CODE) {
      nickName=reasonDialog.getReason().trim();
    }
    ConfigurationUtils.updateChatRoomProperty(chatRoomWrapper.getParentProvider().getProtocolProvider(),chatRoomWrapper.getChatRoomID(),"userNickName",nickName);
  }
}
