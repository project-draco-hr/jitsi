{
  if (event instanceof NewReceiveStreamEvent) {
    ReceiveStream receiveStream=event.getReceiveStream();
    if (receiveStream != null) {
      long receiveStreamSSRC=receiveStream.getSSRC();
      if (logger.isTraceEnabled()) {
        logger.trace("Received new ReceiveStream with ssrc " + receiveStreamSSRC);
      }
      setRemoteSourceID(receiveStreamSSRC);
synchronized (receiveStreamSyncRoot) {
        if (this.receiveStream != receiveStream) {
          this.receiveStream=receiveStream;
          MediaDeviceSession deviceSession=getDeviceSession();
          if (deviceSession != null)           deviceSession.setReceiveStream(this.receiveStream);
        }
      }
    }
  }
 else   if (event instanceof TimeoutEvent) {
    ReceiveStream receiveStream=event.getReceiveStream();
    if (!zrtpRestarted) {
      restartZrtpControl();
    }
    if (receiveStream != null) {
synchronized (receiveStreamSyncRoot) {
        if (this.receiveStream == receiveStream) {
          this.receiveStream=null;
          MediaDeviceSession deviceSession=getDeviceSession();
          if (deviceSession != null)           deviceSession.setReceiveStream(null);
        }
      }
    }
  }
}
