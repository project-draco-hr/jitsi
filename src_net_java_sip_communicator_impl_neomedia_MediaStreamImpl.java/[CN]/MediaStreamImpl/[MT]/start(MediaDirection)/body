{
  if (direction == null)   throw new NullPointerException("direction");
  if (direction.allowsSending() && ((startedDirection == null) || !startedDirection.allowsSending())) {
    startSendStreams();
    getDeviceSession().start(MediaDirection.SENDONLY);
    if (MediaDirection.RECVONLY.equals(startedDirection))     startedDirection=MediaDirection.SENDRECV;
 else     if (startedDirection == null)     startedDirection=MediaDirection.SENDONLY;
  }
  if (direction.allowsReceiving() && ((startedDirection == null) || !startedDirection.allowsReceiving())) {
    RTPManager rtpManager=getRTPManager();
    Iterable<ReceiveStream> receiveStreams;
    try {
      receiveStreams=rtpManager.getReceiveStreams();
    }
 catch (    Exception e) {
      logger.trace("Failed to retrieve receive streams",e);
      receiveStreams=null;
    }
    if (receiveStreams != null)     for (    ReceiveStream receiveStream : receiveStreams)     try {
      DataSource receiveStreamDataSource=receiveStream.getDataSource();
      if (receiveStreamDataSource != null)       receiveStreamDataSource.start();
    }
 catch (    IOException ioe) {
      logger.warn("Failed to start stream " + receiveStream,ioe);
    }
    getDeviceSession().start(MediaDirection.RECVONLY);
    if (MediaDirection.SENDONLY.equals(startedDirection))     startedDirection=MediaDirection.SENDRECV;
 else     if (startedDirection == null)     startedDirection=MediaDirection.RECVONLY;
  }
}
