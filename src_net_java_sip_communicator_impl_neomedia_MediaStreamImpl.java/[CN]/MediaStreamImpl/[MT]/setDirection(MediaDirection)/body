{
  if (direction == null)   throw new NullPointerException("direction");
  if (logger.isTraceEnabled())   logger.trace("Changing direction of stream " + hashCode() + " from:"+ this.direction+ " to:"+ direction);
  MediaDeviceSession deviceSession=getDeviceSession();
  MediaDirection deviceDirection=(deviceSession == null) ? MediaDirection.INACTIVE : deviceSession.getDevice().getDirection();
  if (!deviceDirection.and(direction).equals(direction))   throw new IllegalArgumentException("direction");
  this.direction=direction;
switch (this.direction) {
case INACTIVE:
    stop(MediaDirection.SENDRECV);
  return;
case RECVONLY:
stop(MediaDirection.SENDONLY);
break;
case SENDONLY:
stop(MediaDirection.RECVONLY);
break;
case SENDRECV:
break;
default :
return;
}
if (started) start(this.direction);
}
