{
  RTPManager rtpManager=getRTPManager();
  MediaDeviceSession deviceSession=getDeviceSession();
  DataSource dataSource=deviceSession.getOutputDataSource();
  int streamCount;
  if (dataSource instanceof PushBufferDataSource) {
    PushBufferStream[] streams=((PushBufferDataSource)dataSource).getStreams();
    streamCount=(streams == null) ? 0 : streams.length;
  }
 else   if (dataSource instanceof PushDataSource) {
    PushSourceStream[] streams=((PushDataSource)dataSource).getStreams();
    streamCount=(streams == null) ? 0 : streams.length;
  }
 else   if (dataSource instanceof PullBufferDataSource) {
    PullBufferStream[] streams=((PullBufferDataSource)dataSource).getStreams();
    streamCount=(streams == null) ? 0 : streams.length;
  }
 else   if (dataSource instanceof PullDataSource) {
    PullSourceStream[] streams=((PullDataSource)dataSource).getStreams();
    streamCount=(streams == null) ? 0 : streams.length;
  }
 else   streamCount=(dataSource == null) ? 0 : 1;
  registerCustomCodecFormats(rtpManager);
  for (int streamIndex=0; streamIndex < streamCount; streamIndex++) {
    try {
      SendStream sendStream=rtpManager.createSendStream(dataSource,streamIndex);
      if (logger.isTraceEnabled())       logger.trace("Created SendStream" + " with hashCode " + sendStream.hashCode() + " for "+ toString(dataSource)+ " and streamIndex "+ streamIndex+ " in RTPManager with hashCode "+ rtpManager.hashCode());
      TransformEngine engine=zrtpControl.getTransformEngine();
      if (engine != null && engine instanceof ZRTPTransformEngine)       ((ZRTPTransformEngine)engine).setOwnSSRC(sendStream.getSSRC());
    }
 catch (    IOException ioe) {
      logger.error("Failed to create send stream for data source " + dataSource + " and stream index "+ streamIndex,ioe);
    }
catch (    UnsupportedFormatException ufe) {
      logger.error("Failed to create send stream for data source " + dataSource + " and stream index "+ streamIndex+ " because of failed format "+ ufe.getFailedFormat(),ufe);
    }
  }
  sendStreamsAreCreated=true;
  if (logger.isTraceEnabled()) {
    @SuppressWarnings("unchecked") Vector<SendStream> sendStreams=rtpManager.getSendStreams();
    int sendStreamCount=(sendStreams == null) ? 0 : sendStreams.size();
    logger.trace("Total number of SendStreams in RTPManager with hashCode " + rtpManager.hashCode() + " is "+ sendStreamCount);
  }
}
