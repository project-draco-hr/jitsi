{
  isRunning=true;
  DTMFTone temp=null;
  while (isRunning) {
synchronized (this) {
      if (lastReceivedTone == null) {
        try {
          wait();
        }
 catch (        InterruptedException ie) {
        }
      }
      temp=lastReceivedTone;
      lastReceivedTone=null;
    }
    if (temp != null && ((lastReportedTone == null && !toEnd) || (lastReportedTone != null && toEnd))) {
      if (mediaStream != null) {
        mediaStream.fireDTMFEvent(temp,toEnd);
        if (toEnd)         lastReportedTone=null;
 else         lastReportedTone=temp;
        toEnd=false;
      }
    }
  }
}
