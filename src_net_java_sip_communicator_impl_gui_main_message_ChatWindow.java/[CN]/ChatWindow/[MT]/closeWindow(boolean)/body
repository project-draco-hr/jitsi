{
  if (!getCurrentChatPanel().isWriteAreaEmpty()) {
    SIPCommMsgTextArea msgText=new SIPCommMsgTextArea(Messages.getI18NString("nonEmptyChatWindowClose").getText());
    int answer=JOptionPane.showConfirmDialog(ChatWindow.this,msgText,Messages.getI18NString("warning").getText(),JOptionPane.OK_CANCEL_OPTION,JOptionPane.WARNING_MESSAGE);
    if (answer == JOptionPane.OK_OPTION) {
      closeChat(immediately);
    }
  }
 else   if (System.currentTimeMillis() - getCurrentChatPanel().getLastIncomingMsgTimestamp().getTime() < 2 * 1000) {
    SIPCommMsgTextArea msgText=new SIPCommMsgTextArea(Messages.getI18NString("closeChatAfterNewMsg").getText());
    int answer=JOptionPane.showConfirmDialog(ChatWindow.this,msgText,Messages.getI18NString("warning").getText(),JOptionPane.OK_CANCEL_OPTION,JOptionPane.WARNING_MESSAGE);
    if (answer == JOptionPane.OK_OPTION) {
      closeChat(immediately);
    }
  }
 else {
    closeChat(immediately);
  }
}
