{
  if (!getCurrentChatPanel().isWriteAreaEmpty()) {
    SIPCommMsgTextArea msgText=new SIPCommMsgTextArea(Messages.getString("nonEmptyChatWindowClose"));
    int answer=JOptionPane.showConfirmDialog(ChatWindow.this,msgText,Messages.getString("warning"),JOptionPane.OK_CANCEL_OPTION,JOptionPane.WARNING_MESSAGE);
    if (answer == JOptionPane.OK_OPTION) {
      closeChat();
    }
  }
 else   if (System.currentTimeMillis() - getCurrentChatPanel().getLastIncomingMsgTimestamp().getTime() < 2 * 1000) {
    SIPCommMsgTextArea msgText=new SIPCommMsgTextArea(Messages.getString("closeChatAfterNewMsg"));
    int answer=JOptionPane.showConfirmDialog(ChatWindow.this,msgText,Messages.getString("warning"),JOptionPane.OK_CANCEL_OPTION,JOptionPane.WARNING_MESSAGE);
    if (answer == JOptionPane.OK_OPTION) {
      closeChat();
    }
  }
 else {
    closeChat();
  }
}
