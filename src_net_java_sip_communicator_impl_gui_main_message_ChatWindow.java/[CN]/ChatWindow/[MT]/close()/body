{
  if (!getCurrentChatWritePanel().isEmpty()) {
    int answer=JOptionPane.showConfirmDialog(ChatWindow.this,Messages.getString("nonEmptyChatWindowClose"),Messages.getString("warning"),JOptionPane.OK_CANCEL_OPTION,JOptionPane.WARNING_MESSAGE);
    if (answer == JOptionPane.YES_OPTION) {
      closeChat();
    }
  }
 else   if (System.currentTimeMillis() - getCurrentConversationPanel().getLastIncomingMsgTimestamp().getTime() < 2 * 1000) {
    int answer=JOptionPane.showConfirmDialog(ChatWindow.this,Messages.getString("closeChatAfterNewMsg"),Messages.getString("warning"),JOptionPane.OK_CANCEL_OPTION,JOptionPane.WARNING_MESSAGE);
    if (answer == JOptionPane.YES_OPTION) {
      closeChat();
    }
  }
 else {
    closeChat();
  }
}
