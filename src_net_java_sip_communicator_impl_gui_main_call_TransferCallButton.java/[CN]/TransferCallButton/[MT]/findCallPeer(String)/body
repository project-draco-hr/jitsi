{
  BundleContext bundleContext=GuiActivator.bundleContext;
  ServiceReference[] serviceReferences;
  try {
    serviceReferences=bundleContext.getServiceReferences(ProtocolProviderService.class.getName(),null);
  }
 catch (  InvalidSyntaxException ex) {
    throw new OperationFailedException("Failed to retrieve ProtocolProviderService references.",OperationFailedException.INTERNAL_ERROR,ex);
  }
  Class<OperationSetBasicTelephony> telephonyClass=OperationSetBasicTelephony.class;
  CallPeer peer=null;
  for (  ServiceReference serviceReference : serviceReferences) {
    ProtocolProviderService service=(ProtocolProviderService)bundleContext.getService(serviceReference);
    OperationSetBasicTelephony telephony=(OperationSetBasicTelephony)service.getOperationSet(telephonyClass);
    if (telephony != null) {
      peer=findCallPeer(telephony,address);
      if (peer != null)       break;
    }
  }
  return peer;
}
