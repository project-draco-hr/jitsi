{
  run=true;
  int timer=0;
  do {
    try {
      if (MouseInfo.getPointerInfo() != null) {
        PointerInfo info=MouseInfo.getPointerInfo();
        Point currentPosition=(info != null) ? info.getLocation() : new Point(0,0);
        if (!isNear(lastPosition,currentPosition)) {
          for (          ProtocolProviderService protocolProviderService : AutoAwayActivator.getProtocolProviders()) {
            if (lastStates.get(protocolProviderService) != null) {
              PresenceStatus lastState=lastStates.get(protocolProviderService);
              OperationSetPresence presence=(OperationSetPresence)protocolProviderService.getOperationSet(OperationSetPresence.class);
              try {
                presence.publishPresenceStatus(lastState,"");
              }
 catch (              IllegalArgumentException e) {
              }
catch (              IllegalStateException e) {
              }
catch (              OperationFailedException e) {
              }
              lastStates.remove(protocolProviderService);
            }
          }
          timer=getTimer() * 1000 * 60;
        }
 else {
          for (          ProtocolProviderService protocolProviderService : AutoAwayActivator.getProtocolProviders()) {
            OperationSetPresence presence=(OperationSetPresence)protocolProviderService.getOperationSet(OperationSetPresence.class);
            PresenceStatus status=presence.getPresenceStatus();
            if (status.getStatus() < PresenceStatus.AVAILABLE_THRESHOLD) {
              continue;
            }
            lastStates.put(protocolProviderService,status);
            PresenceStatus newStatus=findAwayStatus(presence);
            try {
              if (newStatus != null)               presence.publishPresenceStatus(newStatus,newStatus.getStatusName());
            }
 catch (            IllegalArgumentException e) {
            }
catch (            IllegalStateException e) {
            }
catch (            OperationFailedException e) {
            }
          }
          timer=IDLE_TIMER;
        }
        lastPosition=currentPosition;
      }
      Thread.sleep(timer);
    }
 catch (    InterruptedException e) {
    }
  }
 while (run && timer > 0);
}
