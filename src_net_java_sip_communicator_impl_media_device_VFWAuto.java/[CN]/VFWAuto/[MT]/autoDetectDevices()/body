{
  Vector devices=(Vector)CaptureDeviceManager.getDeviceList(null).clone();
  Enumeration devicesEnum=devices.elements();
  while (devicesEnum.hasMoreElements()) {
    CaptureDeviceInfo cdi=(CaptureDeviceInfo)devicesEnum.nextElement();
    String name=cdi.getName();
    if (name.startsWith("vfw:"))     CaptureDeviceManager.removeDevice(cdi);
  }
  int nDevices=0;
  for (int i=0; i < 10; i++) {
    String name=VFWCapture.capGetDriverDescriptionName(i);
    if (name != null && name.length() > 1) {
      logger.debug("Found device " + name);
      logger.debug("Querying device. Please wait...");
      com.sun.media.protocol.vfw.VFWSourceStream.autoDetect(i);
      nDevices++;
    }
  }
  return nDevices;
}
