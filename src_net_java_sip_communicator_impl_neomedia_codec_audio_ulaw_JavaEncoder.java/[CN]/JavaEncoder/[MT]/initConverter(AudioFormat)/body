{
  lastFormat=inFormat;
  numberOfInputChannels=inFormat.getChannels();
  if (outputFormat != null)   numberOfOutputChannels=outputFormat.getChannels();
  inputSampleSize=inFormat.getSampleSizeInBits();
  if ((inFormat.getEndian() == AudioFormat.BIG_ENDIAN) || (8 == inputSampleSize)) {
    lsbOffset=1;
    msbOffset=0;
  }
 else {
    lsbOffset=-1;
    msbOffset=1;
  }
  if (inFormat.getSigned() == AudioFormat.SIGNED) {
    inputBias=0;
    signMask=0xffffffff;
  }
 else {
    inputBias=32768;
    signMask=0x0000ffff;
  }
  downmix=(numberOfInputChannels == 2) && (numberOfOutputChannels == 1);
}
