{
  inputFormat=super.setInputFormat(inputFormat);
  if (inputFormat instanceof VideoFormat) {
    Dimension inputSize=((VideoFormat)inputFormat).getSize();
    if ((inputSize != null) && (inputSize.width > 0)) {
      Dimension outputSize=getOutputSize();
      if ((outputSize != null) && (outputSize.width > 0)) {
        int outputHeight=(int)(outputSize.width * inputSize.height / (float)inputSize.width);
        int outputHeightDelta=outputHeight - outputSize.height;
        if ((outputHeightDelta < -1) || (outputHeightDelta > 1)) {
          outputSize.height=outputHeight;
          setOutputSize(outputSize);
        }
      }
    }
  }
  return inputFormat;
}
