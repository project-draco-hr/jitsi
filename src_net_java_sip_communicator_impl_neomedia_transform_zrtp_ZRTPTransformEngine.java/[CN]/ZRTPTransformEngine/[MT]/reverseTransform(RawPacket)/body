{
  if (!started && enableZrtp && ownSSRC != 0)   startZrtp();
  byte[] buffer=pkt.getBuffer();
  int offset=pkt.getOffset();
  if ((buffer[offset] & 0x10) != 0x10) {
    if (srtpInTransformer == null)     return pkt;
    pkt=srtpInTransformer.reverseTransform(pkt);
    if ((pkt != null) && started && zrtpEngine.inState(ZrtpStateClass.ZrtpStates.WaitConfAck)) {
      zrtpEngine.conf2AckSecure();
    }
    return pkt;
  }
  if (enableZrtp && started) {
    ZrtpRawPacket zPkt=new ZrtpRawPacket(pkt);
    if (!zPkt.checkCrc()) {
      securityEventManager.showMessage(ZrtpCodes.MessageSeverity.Warning,EnumSet.of(ZrtpCodes.WarningCodes.WarningCRCmismatch));
    }
 else     if (zPkt.hasMagic()) {
      byte[] extHeader=zPkt.getMessagePart();
      zrtpEngine.processZrtpMessage(extHeader,zPkt.getSSRC());
    }
  }
  return null;
}
