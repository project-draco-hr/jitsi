{
  File file=null;
  FileAccessService faService=NeomediaActivator.getFileAccessService();
  if (faService != null) {
    try {
      file=faService.getPrivatePersistentFile(zidFilename);
    }
 catch (    Exception e) {
      logger.warn("Failed to create the zid file.");
    }
  }
  String zidFilePath=null;
  try {
    if (file != null)     zidFilePath=file.getAbsolutePath();
  }
 catch (  SecurityException e) {
    if (logger.isDebugEnabled()) {
      logger.debug("Failed to obtain the absolute path of the zid file.",e);
    }
  }
  ZidFile zf=ZidFile.getInstance();
  if (!zf.isOpen()) {
    if (zidFilePath == null) {
      String home=System.getenv("HOME");
      String baseDir=((home == null) || (home.length() < 1)) ? "" : (home + "/");
      zidFilePath=baseDir + ".GNUZRTP4J.zid";
    }
    if (zf.open(zidFilePath) < 0)     return false;
  }
  if (config == null) {
    config=new ZrtpConfigure();
    config.setStandardConfig();
  }
  if (enableParanoidMode)   config.setParanoidMode(enableParanoidMode);
  zrtpEngine=new ZRtp(zf.getZid(),this,clientIdString,config,mitmMode);
  if (timeoutProvider == null) {
    timeoutProvider=new TimeoutProvider("ZRTP");
    timeoutProvider.start();
  }
  enableZrtp=autoEnable;
  return true;
}
