{
  Iterator<? extends CallPeer> callPeers=call.getCallPeers();
  while (callPeers.hasNext()) {
    CallPeer callPeer=callPeers.next();
    settingsPanel.add(transferCallButton);
    Contact peerContact=callPeer.getContact();
    ProtocolProviderService callProvider=call.getProtocolProvider();
    OperationSetContactCapabilities capOpSet=callProvider.getOperationSet(OperationSetContactCapabilities.class);
    if (peerContact != null && capOpSet != null) {
      if (capOpSet.getOperationSet(peerContact,OperationSetDesktopSharingServer.class) != null)       settingsPanel.add(desktopSharingButton);
      if (capOpSet.getOperationSet(peerContact,OperationSetVideoTelephony.class) != null)       settingsPanel.add(videoButton);
    }
 else {
      if (callProvider.getOperationSet(OperationSetDesktopSharingServer.class) != null)       settingsPanel.add(desktopSharingButton);
      if (callProvider.getOperationSet(OperationSetVideoTelephony.class) != null)       settingsPanel.add(videoButton);
    }
    if (callPeer.getState() == CallPeerState.CONNECTED) {
      if (!isCallTimerStarted())       startCallTimer();
      enableButtons(true);
      return;
    }
  }
  enableButtons(false);
}
