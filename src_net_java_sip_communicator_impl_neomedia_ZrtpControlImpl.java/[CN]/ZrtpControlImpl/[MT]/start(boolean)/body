{
  usingZRTP=true;
  SecurityEventManager securityEventManager=new SecurityEventManager(this);
  boolean zrtpAutoStart=false;
  if (masterSession) {
    zrtpAutoStart=true;
    securityEventManager.setDHSession(true);
    securityEventManager.setSessionType(SecurityEventManager.AUDIO_SESSION);
  }
 else {
    zrtpAutoStart=zrtpEngine.isEnableZrtp();
    securityEventManager.setSessionType(SecurityEventManager.VIDEO_SESSION);
  }
  ZRTPTransformEngine engine=getZrtpEngine();
  engine.setEnableZrtp(zrtpAutoStart);
  zrtpEngine.setConnector(zrtpConnector);
  zrtpEngine.setUserCallback(securityEventManager);
  usingZRTP=true;
  zrtpEngine.sendInfo(ZrtpCodes.MessageSeverity.Info,EnumSet.of(ZRTPCustomInfoCodes.ZRTPEnabledByDefault));
}
