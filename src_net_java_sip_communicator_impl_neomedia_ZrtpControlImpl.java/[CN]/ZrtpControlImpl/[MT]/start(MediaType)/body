{
  boolean zrtpAutoStart;
  ZRTPTransformEngine engine=getTransformEngine();
  SecurityEventManager securityEventManager=engine.getUserCallback();
  if (masterSession) {
    zrtpAutoStart=true;
    securityEventManager.setDHSession(true);
    securityEventManager.setSessionType(mediaType.equals(MediaType.AUDIO) ? SecurityEventManager.AUDIO_SESSION : SecurityEventManager.VIDEO_SESSION);
  }
 else {
    zrtpAutoStart=zrtpEngine.isEnableZrtp();
    securityEventManager.setSessionType(mediaType.equals(MediaType.AUDIO) ? SecurityEventManager.AUDIO_SESSION : SecurityEventManager.VIDEO_SESSION);
  }
  engine.setEnableZrtp(zrtpAutoStart);
  engine.setConnector(zrtpConnector);
  securityEventManager.setSrtpListener(zrtpListener);
  engine.sendInfo(ZrtpCodes.MessageSeverity.Info,EnumSet.of(ZRTPCustomInfoCodes.ZRTPEnabledByDefault));
}
