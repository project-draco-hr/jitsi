{
  for (  String suite : enabledCryptoSuites) {
    for (    String ea : peerAttributes) {
      SrtpCryptoAttribute peerCA=SrtpCryptoAttribute.create(ea);
      if (suite.equals(peerCA.getCryptoSuite().encode())) {
        selectedInAttribute=peerCA;
        selectedOutAttribute=sdesFactory.createCryptoAttribute(1,suite);
        if (engine != null)         engine.reset(this);
        return selectedOutAttribute.encode();
      }
    }
  }
  return null;
}
