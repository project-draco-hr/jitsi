{
  String lastStatus=getLastStatusString(protocolProvider);
  if (lastStatus != null) {
    OperationSetPresence presence=(OperationSetPresence)protocolProvider.getOperationSet(OperationSetPresence.class);
    if (presence == null)     return null;
    Iterator<PresenceStatus> i=presence.getSupportedStatusSet();
    PresenceStatus status;
    while (i.hasNext()) {
      status=i.next();
      if (status.getStatusName().equals(lastStatus))       return status;
    }
  }
  return null;
}
