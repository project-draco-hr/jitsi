{
  AudioFormat inputFormat=(AudioFormat)super.setInputFormat(format);
  if (inputFormat != null) {
    double outputSampleRate;
    Class<?> outputDataType;
    if (outputFormat == null) {
      outputSampleRate=inputFormat.getSampleRate();
      outputDataType=inputFormat.getDataType();
    }
 else {
      AudioFormat outputAudioFormat=(AudioFormat)outputFormat;
      outputSampleRate=outputAudioFormat.getSampleRate();
      outputDataType=outputAudioFormat.getDataType();
      if (outputSampleRate != inputFormat.getSampleRate())       outputDataType=inputFormat.getDataType();
    }
    setOutputFormat(new AudioFormat(inputFormat.getEncoding(),outputSampleRate,inputFormat.getSampleSizeInBits(),inputFormat.getChannels(),inputFormat.getEndian(),inputFormat.getSigned(),Format.NOT_SPECIFIED,Format.NOT_SPECIFIED,outputDataType));
  }
  return inputFormat;
}
