{
  ContactGroupIcqImpl oldParentGroup=null;
  ContactIcqImpl newContact=findContactByScreenName(buddy.getScreenname().getFormatted());
  ContactGroupIcqImpl parentGroup=findContactGroup(joustSimGroup);
  boolean fireResolvedEvent=false;
  if (parentGroup == null) {
    logger.debug("no parent group " + joustSimGroup + " found for buddy: "+ buddy);
    return;
  }
  if (newContact == null) {
    newContact=new ContactIcqImpl(buddy,ServerStoredContactListIcqImpl.this,true,true);
    parentGroup.addContact(newContact);
  }
 else {
    oldParentGroup=findContactGroup(newContact);
    if (oldParentGroup != parentGroup)     oldParentGroup.removeContact(newContact);
    newContact.setJoustSimBuddy(buddy);
    newContact.setPersistent(true);
    if (!newContact.isResolved()) {
      newContact.setResolved(true);
      fireResolvedEvent=true;
    }
  }
  int index=parentGroup.findContactIndex(newContact);
  buddy.addBuddyListener(jsimBuddyListener);
  if (oldParentGroup == null) {
    fireContactAdded(parentGroup,newContact,index);
  }
 else   if (oldParentGroup != parentGroup) {
    fireContactMoved(oldParentGroup,parentGroup,newContact,index);
  }
  if (fireResolvedEvent) {
    fireContactResolved(parentGroup,newContact);
  }
}
