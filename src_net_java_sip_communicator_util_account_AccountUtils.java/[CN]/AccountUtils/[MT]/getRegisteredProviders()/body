{
  List<ProtocolProviderService> registeredProviders=new LinkedList<ProtocolProviderService>();
  for (  ProtocolProviderFactory providerFactory : UtilActivator.getProtocolProviderFactories().values()) {
    ServiceReference serRef;
    ProtocolProviderService protocolProvider;
    for (    AccountID accountID : providerFactory.getRegisteredAccounts()) {
      serRef=providerFactory.getProviderForAccount(accountID);
      protocolProvider=(ProtocolProviderService)UtilActivator.bundleContext.getService(serRef);
      registeredProviders.add(protocolProvider);
    }
  }
  return registeredProviders;
}
