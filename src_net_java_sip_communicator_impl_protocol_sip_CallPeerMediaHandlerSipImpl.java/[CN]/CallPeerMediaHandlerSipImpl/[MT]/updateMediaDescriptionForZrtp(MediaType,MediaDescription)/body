{
  if (getPeer().getCall().isSipZrtpAttribute()) {
    try {
      SrtpControl scontrol=getZrtpControls().get(mediaType);
      if (scontrol == null || !(scontrol instanceof ZrtpControl)) {
        scontrol=SipActivator.getMediaService().createZrtpControl();
        getZrtpControls().put(mediaType,scontrol);
      }
      ZrtpControl zcontrol=(ZrtpControl)scontrol;
      String helloHash=zcontrol.getHelloHash();
      if (helloHash != null && helloHash.length() > 0)       md.setAttribute("zrtp-hash",helloHash);
    }
 catch (    SdpException ex) {
      logger.error("Cannot add zrtp-hash to sdp",ex);
    }
  }
}
