{
  String callPeerSID=callPeer.getSID();
  if (callPeerSID == null)   return null;
  CoinIQ iq=new CoinIQ();
  CallJabberImpl call=callPeer.getCall();
  iq.setFrom(call.getProtocolProvider().getOurJID());
  iq.setTo(callPeer.getAddress());
  iq.setType(Type.SET);
  iq.setEntity(getBasicTelephony().getProtocolProvider().getOurJID());
  iq.setVersion(version);
  iq.setState(StateType.full);
  iq.setSID(callPeer.getSID());
  iq.addExtension(new DescriptionPacketExtension());
  StatePacketExtension state=new StatePacketExtension();
  List<CallPeer> conferenceCallPeers=CallConference.getCallPeers(call);
  state.setUserCount(1 + conferenceCallPeers.size());
  iq.addExtension(state);
  UsersPacketExtension users=new UsersPacketExtension();
  UserPacketExtension user=new UserPacketExtension("xmpp:" + parentProvider.getOurJID());
  EndpointPacketExtension endpoint=new EndpointPacketExtension("xmpp:" + parentProvider.getOurJID());
  endpoint.setStatus(EndpointStatusType.connected);
  List<MediaPacketExtension> medias=getMedia(callPeer,false);
  for (  MediaPacketExtension media : medias)   endpoint.addChildExtension(media);
  user.addChildExtension(endpoint);
  users.addChildExtension(user);
  for (  CallPeer conferenceCallPeer : conferenceCallPeers)   users.addChildExtension(getUser(conferenceCallPeer));
  iq.addExtension(users);
  return iq;
}
