{
  if (!(callPeer instanceof CallPeerJabberImpl))   return;
  CallPeerJabberImpl callPeerJabber=(CallPeerJabberImpl)callPeer;
  String to=getBasicTelephony().getFullCalleeURI(callPeer.getAddress());
  try {
    DiscoverInfo discoverInfo=parentProvider.getDiscoveryManager().discoverInfo(to);
    if (!discoverInfo.containsFeature(ProtocolProviderServiceJabberImpl.URN_XMPP_JINGLE_COIN)) {
      logger.info(callPeer.getAddress() + " does not support COIN");
      return;
    }
  }
 catch (  XMPPException xmppe) {
    logger.warn("Failed to retrieve DiscoverInfo for " + to,xmppe);
  }
  ConferenceInfoDocument currentConfInfo=getCurrentConferenceInfo(callPeer);
  ConferenceInfoDocument lastSentConfInfo=callPeerJabber.getLastConferenceInfoSent();
  ConferenceInfoDocument diff=getConferenceInfoDiff(lastSentConfInfo,currentConfInfo);
  if (diff != null) {
    int newVersion=lastSentConfInfo == null ? 1 : lastSentConfInfo.getVersion() + 1;
    diff.setVersion(newVersion);
    IQ iq=getConferenceInfo(callPeerJabber,diff);
    if (iq != null) {
      parentProvider.getConnection().sendPacket(iq);
      currentConfInfo.setVersion(newVersion);
      callPeerJabber.setLastConferenceInfoSent(currentConfInfo);
      callPeerJabber.setLastConferenceInfoSentTimestamp(System.currentTimeMillis());
    }
  }
}
