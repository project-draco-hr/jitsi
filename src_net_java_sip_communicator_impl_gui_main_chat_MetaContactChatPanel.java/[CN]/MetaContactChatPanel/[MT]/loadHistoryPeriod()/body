{
  MessageHistoryService msgHistory=GuiActivator.getMsgHistoryService();
  if (msgHistory == null)   return;
  Collection firstMessage=msgHistory.findFirstMessagesAfter(metaContact,new Date(0),1);
  if (firstMessage.size() > 0) {
    Iterator i=firstMessage.iterator();
    Object o=i.next();
    if (o instanceof MessageDeliveredEvent) {
      MessageDeliveredEvent evt=(MessageDeliveredEvent)o;
      this.firstHistoryMsgTimestamp=evt.getTimestamp();
    }
 else     if (o instanceof MessageReceivedEvent) {
      MessageReceivedEvent evt=(MessageReceivedEvent)o;
      this.firstHistoryMsgTimestamp=evt.getTimestamp();
    }
  }
  Collection lastMessage=msgHistory.findLastMessagesBefore(metaContact,new Date(Long.MAX_VALUE),1);
  if (lastMessage.size() > 0) {
    Iterator i1=lastMessage.iterator();
    Object o1=i1.next();
    if (o1 instanceof MessageDeliveredEvent) {
      MessageDeliveredEvent evt=(MessageDeliveredEvent)o1;
      this.lastHistoryMsgTimestamp=evt.getTimestamp();
    }
 else     if (o1 instanceof MessageReceivedEvent) {
      MessageReceivedEvent evt=(MessageReceivedEvent)o1;
      this.lastHistoryMsgTimestamp=evt.getTimestamp();
    }
  }
}
