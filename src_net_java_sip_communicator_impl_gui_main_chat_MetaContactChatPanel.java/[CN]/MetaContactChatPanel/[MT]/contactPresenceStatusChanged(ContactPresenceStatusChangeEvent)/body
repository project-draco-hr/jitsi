{
  Contact sourceContact=evt.getSourceContact();
  MetaContact sourceMetaContact=GuiActivator.getMetaContactListService().findMetaContactByContact(sourceContact);
  if (sourceMetaContact != null && metaContact.equals(sourceMetaContact)) {
    contactSelectorBox.updateContactStatus(sourceContact);
    if (sourceMetaContact != null && sourceMetaContact.getDefaultContact().equals(sourceContact)) {
      ChatContact chatContact=findChatContactByMetaContact(sourceMetaContact);
      ChatContactPanel chatContactPanel=getChatContactListPanel().getChatContactPanel(chatContact);
      chatContactPanel.setStatusIcon(chatContact.getPresenceStatus());
    }
    PresenceStatus status=contactSelectorBox.getSelectedProtocolContact().getPresenceStatus();
    String message=getChatConversationPanel().processMessage(sourceContact.getAddress(),new Date(System.currentTimeMillis()),Constants.SYSTEM_MESSAGE,Messages.getI18NString("statusChangedChatMessage",new String[]{status.getStatusName()}).getText(),"text");
    getChatConversationPanel().appendMessageToEnd(message);
    if (Constants.TABBED_CHAT_WINDOW) {
      if (getChatWindow().getChatTabCount() > 0) {
        getChatWindow().setTabIcon(this,new ImageIcon(Constants.getStatusIcon(status)));
      }
    }
  }
}
