{
  Contact protocolContact=contactSelectorBox.getSelectedProtocolContact();
  OperationSetTypingNotifications tnOperationSet=(OperationSetTypingNotifications)protocolContact.getProtocolProvider().getOperationSet(OperationSetTypingNotifications.class);
  if (protocolContact.getProtocolProvider().isRegistered() && tnOperationSet != null) {
    try {
      tnOperationSet.sendTypingNotification(protocolContact,typingState);
      return ChatPanel.TYPING_NOTIFICATION_SUCCESSFULLY_SENT;
    }
 catch (    Exception ex) {
      logger.error("Failed to send typing notifications.",ex);
      return ChatPanel.TYPING_NOTIFICATION_SEND_FAILED;
    }
  }
  return ChatPanel.TYPING_NOTIFICATION_SEND_FAILED;
}
