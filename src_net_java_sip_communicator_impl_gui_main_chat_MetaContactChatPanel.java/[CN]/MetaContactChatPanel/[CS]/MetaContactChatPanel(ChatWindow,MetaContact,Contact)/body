{
  super(chatWindow);
  this.chatWindow=chatWindow;
  this.metaContact=metaContact;
  ChatContact chatContact=new ChatContact(metaContact,protocolContact);
  getChatContactListPanel().addContact(chatContact);
  chatWindow.getMainFrame().getContactList().addMetaContactListListener(this);
  Iterator iter=metaContact.getContacts();
  while (iter.hasNext()) {
    Contact contact=(Contact)iter.next();
    OperationSetPresence opsPresence=(OperationSetPresence)contact.getProtocolProvider().getOperationSet(OperationSetPresence.class);
    if (opsPresence != null)     opsPresence.addSubsciptionListener(this);
  }
  contactSelectorBox=new ProtocolContactSelectorBox(this,metaContact,protocolContact);
  getChatSendPanel().getSendPanel().add(contactSelectorBox,0);
  getChatSendPanel().getSendPanel().add(sendViaLabel,0);
  ActionMap amap=this.getActionMap();
  amap.put("ChangeProtocol",new ChangeProtocolAction());
  InputMap imap=this.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW);
  imap.put(KeyStroke.getKeyStroke(KeyEvent.VK_P,KeyEvent.CTRL_DOWN_MASK),"ChangeProtocol");
}
