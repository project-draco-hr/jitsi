{
  short[] inputData=(short[])inputBuffer.getData();
  int inputLength=inputBuffer.getLength();
  int inputOffset=inputBuffer.getOffset();
  if (inputLength > encControl.packetSize)   inputLength=encControl.packetSize;
  byte[] outputData=validateByteArraySize(outputBuffer,MAX_BYTES_PER_FRAME);
  int outputOffset=0;
  int processed;
  outputLength[0]=MAX_BYTES_PER_FRAME;
  if (Silk_enc_API.SKP_Silk_SDK_Encode(encState,encControl,inputData,inputOffset,inputLength,outputData,outputOffset,outputLength) == 0) {
    outputBuffer.setLength(outputLength[0]);
    outputBuffer.setOffset(outputOffset);
    processed=BUFFER_PROCESSED_OK;
  }
 else   processed=BUFFER_PROCESSED_FAILED;
  inputBuffer.setLength(inputBuffer.getLength() - inputLength);
  inputBuffer.setOffset(inputBuffer.getOffset() + inputLength);
  if (processed != BUFFER_PROCESSED_FAILED) {
    if (processed == BUFFER_PROCESSED_OK) {
      updateOutput(outputBuffer,getOutputFormat(),outputBuffer.getLength(),outputBuffer.getOffset());
      outputBuffer.setDuration(duration);
    }
    if (inputBuffer.getLength() > 0)     processed|=INPUT_BUFFER_NOT_CONSUMED;
  }
  return processed;
}
