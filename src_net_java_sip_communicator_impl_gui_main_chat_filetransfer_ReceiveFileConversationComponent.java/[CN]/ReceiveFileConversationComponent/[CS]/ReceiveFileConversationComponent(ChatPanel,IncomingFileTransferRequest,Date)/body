{
  this.chatPanel=chatPanel;
  this.fileTransferRequest=request;
  this.date=date;
  this.dateString=getDateString(date);
  titleLabel.setText(dateString + resources.getI18NString("service.gui.FILE_TRANSFER_REQUEST_RECIEVED",new String[]{fileTransferRequest.getSender().getDisplayName()}));
  fileLabel.setText(fileTransferRequest.getFileName());
  acceptButton.setVisible(true);
  acceptButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      titleLabel.setText(dateString + resources.getI18NString("service.gui.FILE_TRANSFER_PREPARING",new String[]{fileTransferRequest.getSender().getDisplayName()}));
      acceptButton.setVisible(false);
      rejectButton.setVisible(false);
      cancelButton.setVisible(true);
      progressBar.setVisible(true);
      File downloadFile=createFile(fileTransferRequest);
      new AcceptFile(downloadFile).start();
    }
  }
);
  rejectButton.setVisible(true);
  rejectButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      fileTransferRequest.rejectFile();
      acceptButton.setVisible(false);
      rejectButton.setVisible(false);
      fileLabel.setText("");
      titleLabel.setText(dateString + resources.getI18NString("service.gui.FILE_TRANSFER_CANCELED"));
    }
  }
);
  progressBar.setMaximum((int)fileTransferRequest.getFileSize());
}
