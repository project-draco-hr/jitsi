{
  Hashtable accountProperties=new Hashtable();
  accountProperties.put("first",registration.getFirst());
  accountProperties.put("last",registration.getLast());
  accountProperties.put("mail",registration.getMail());
  accountProperties.put("rememberContacts",new Boolean(registration.isRememberContacts()).toString());
  try {
    AccountID accountID=providerFactory.installAccount(user,accountProperties);
    ServiceReference serRef=providerFactory.getProviderForAccount(accountID);
    protocolProvider=(ProtocolProviderService)ZeroconfAccRegWizzActivator.bundleContext.getService(serRef);
  }
 catch (  IllegalArgumentException exc) {
    new ErrorDialog(null,exc.getMessage(),exc).showDialog();
  }
catch (  IllegalStateException exc) {
    new ErrorDialog(null,exc.getMessage(),exc).showDialog();
  }
  return protocolProvider;
}
