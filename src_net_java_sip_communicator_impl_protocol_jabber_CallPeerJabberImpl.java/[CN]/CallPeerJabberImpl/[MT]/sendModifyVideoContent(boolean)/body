{
  ContentPacketExtension ext=new ContentPacketExtension();
  ContentPacketExtension remoteContent=getMediaHandler().getRemoteContent(MediaType.VIDEO.toString());
  if (remoteContent == null) {
    if (allowed)     sendAddVideoContent();
    return;
  }
 else   if (!allowed && ((!isInitiator && (remoteContent.getSenders() == SendersEnum.initiator)) || (isInitiator && (remoteContent.getSenders() == SendersEnum.responder)))) {
    sendRemoveVideoContent();
    return;
  }
  SendersEnum senders=remoteContent.getSenders();
  if (allowed) {
    if (senders != SendersEnum.none) {
      senders=SendersEnum.both;
    }
 else     if (senders == SendersEnum.none) {
      senders=isInitiator ? SendersEnum.responder : SendersEnum.initiator;
    }
  }
 else {
    if (senders == SendersEnum.both || senders == null) {
      senders=isInitiator ? SendersEnum.initiator : SendersEnum.responder;
    }
 else {
      senders=SendersEnum.none;
    }
  }
  ext.setSenders(senders);
  ext.setCreator(remoteContent.getCreator());
  ext.setName(remoteContent.getName());
  ProtocolProviderServiceJabberImpl protocolProvider=getProtocolProvider();
  JingleIQ contentIQ=JinglePacketFactory.createContentModify(protocolProvider.getOurJID(),this.peerJID,getJingleSID(),ext);
  protocolProvider.getConnection().sendPacket(contentIQ);
  try {
    CallPeerMediaHandlerJabberImpl mediaHandler=getMediaHandler();
    mediaHandler.reinitContent(remoteContent.getName(),ext,false);
    mediaHandler.start();
  }
 catch (  Exception e) {
    logger.warn("Exception occurred during media reinitialization",e);
  }
}
