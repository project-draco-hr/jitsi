{
  this.accountsPanel.setLayout(new BoxLayout(accountsPanel,BoxLayout.Y_AXIS));
  for (  ProtocolProviderFactory providerFactory : GuiActivator.getProtocolProviderFactories().values()) {
    ServiceReference serRef;
    ProtocolProviderService protocolProvider;
    for (    AccountID accountID : providerFactory.getRegisteredAccounts()) {
      boolean isHidden=(accountID.getAccountProperty(ProtocolProviderFactory.IS_PROTOCOL_HIDDEN) != null);
      if (isHidden)       continue;
      serRef=providerFactory.getProviderForAccount(accountID);
      protocolProvider=(ProtocolProviderService)GuiActivator.bundleContext.getService(serRef);
      OperationSetPresence presence=(OperationSetPresence)protocolProvider.getOperationSet(OperationSetPresence.class);
      if (presence != null) {
        presence.addProviderPresenceStatusListener(this);
      }
      AccountPanel accountPanel=new AccountPanel(protocolProvider);
      accountsPanel.add(accountPanel);
      accounts.put(protocolProvider,accountPanel);
    }
  }
}
