{
  if (event.getServiceReference().getBundle().getState() == Bundle.STOPPING) {
    return;
  }
  Object sourceService=GuiActivator.bundleContext.getService(event.getServiceReference());
  if (!(sourceService instanceof ProtocolProviderService)) {
    return;
  }
  ProtocolProviderService pps=(ProtocolProviderService)sourceService;
  if (event.getType() == ServiceEvent.REGISTERED) {
    AccountPanel accountPanel=new AccountPanel(pps);
    this.accountsPanel.add(accountPanel);
    this.accountsPanel.revalidate();
    this.accountsPanel.repaint();
    this.accounts.put(pps,accountPanel);
  }
 else   if (event.getType() == ServiceEvent.UNREGISTERING) {
    this.accountsPanel.remove((JPanel)accounts.get(pps));
    this.accountsPanel.revalidate();
    this.accountsPanel.repaint();
  }
}
