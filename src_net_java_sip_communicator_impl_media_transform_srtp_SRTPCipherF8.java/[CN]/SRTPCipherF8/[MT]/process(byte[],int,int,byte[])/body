{
  F8Context f8ctx=new F8Context();
  f8ctx.ivAccent=new byte[BLKLEN];
  byte[] saltMask=new byte[this.key.length];
  byte[] maskedKey=new byte[this.key.length];
  System.arraycopy(this.salt,0,saltMask,0,this.salt.length);
  for (int i=this.salt.length; i < saltMask.length; ++i) {
    saltMask[i]=0x55;
  }
  for (int i=0; i < this.key.length; i++) {
    maskedKey[i]=(byte)(this.key[i] ^ saltMask[i]);
  }
  AESCipher cipher=new AESCipher(maskedKey);
  cipher.encryptBlock(iv,0,f8ctx.ivAccent,0);
  saltMask=null;
  maskedKey=null;
  f8ctx.J=0;
  f8ctx.S=new byte[BLKLEN];
  Arrays.fill(f8ctx.S,(byte)0);
  int inLen=len;
  while (inLen >= BLKLEN) {
    processBlock(f8ctx,data,off,data,off,BLKLEN);
    inLen-=BLKLEN;
    off+=BLKLEN;
  }
  if (inLen > 0) {
    processBlock(f8ctx,data,off,data,off,inLen);
  }
}
