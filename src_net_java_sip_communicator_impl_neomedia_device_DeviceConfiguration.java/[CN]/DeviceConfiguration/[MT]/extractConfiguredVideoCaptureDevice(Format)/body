{
  @SuppressWarnings("unchecked") List<CaptureDeviceInfo> videoCaptureDevices=CaptureDeviceManager.getDeviceList(format);
  CaptureDeviceInfo videoCaptureDevice=null;
  if (videoCaptureDevices.size() > 0) {
    ConfigurationService cfg=NeomediaActivator.getConfigurationService();
    String videoDevName=(cfg == null) ? null : cfg.getString(PROP_VIDEO_DEVICE);
    if (videoDevName == null)     videoCaptureDevice=videoCaptureDevices.get(0);
 else {
      for (      CaptureDeviceInfo captureDeviceInfo : videoCaptureDevices) {
        if (videoDevName.equals(captureDeviceInfo.getName())) {
          videoCaptureDevice=captureDeviceInfo;
          break;
        }
      }
    }
    if ((videoCaptureDevice != null) && logger.isInfoEnabled()) {
      logger.info("Found " + videoCaptureDevice.getName() + " as a "+ format+ " video capture device.");
    }
  }
  return videoCaptureDevice;
}
