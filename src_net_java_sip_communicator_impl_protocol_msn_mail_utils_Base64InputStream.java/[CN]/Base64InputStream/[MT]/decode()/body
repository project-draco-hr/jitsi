{
  buflen=0;
  int c;
  do {
    c=in.read();
    if (c == -1)     return;
  }
 while (c == LF || c == CR);
  decodeBuf[0]=(byte)c;
  int j=3, l;
  for (int k=1; (l=in.read(decodeBuf,k,j)) != j; k+=l) {
    if (l == -1)     throw new IOException("Base64 encoding error");
    j-=l;
  }
  byte b0=dst[decodeBuf[0] & 0xff];
  byte b2=dst[decodeBuf[1] & 0xff];
  buffer[buflen++]=(byte)(b0 << 2 & 0xfc | b2 >>> 4 & 0x3);
  if (decodeBuf[2] != EQ) {
    b0=b2;
    b2=dst[decodeBuf[2] & 0xff];
    buffer[buflen++]=(byte)(b0 << 4 & 0xf0 | b2 >>> 2 & 0xf);
    if (decodeBuf[3] != EQ) {
      b0=b2;
      b2=dst[decodeBuf[3] & 0xff];
      buffer[buflen++]=(byte)(b0 << 6 & 0xc0 | b2 & 0x3f);
    }
  }
}
