{
  String cssClassName;
  if (OSUtils.IS_WINDOWS) {
    cssClassName="net.java.sip.communicator.plugin.addrbook" + ".msoutlook.MsOutlookAddrBookContactSourceService";
  }
 else   if (OSUtils.IS_MAC) {
    cssClassName="net.java.sip.communicator.plugin.addrbook" + ".macosx.MacOSXAddrBookContactSourceService";
  }
 else   return;
  try {
    css=(ContactSourceService)Class.forName(cssClassName).newInstance();
  }
 catch (  Exception ex) {
    logger.error("Failed to instantiate " + cssClassName,ex);
    return;
  }
  try {
    cssServiceRegistration=bundleContext.registerService(ContactSourceService.class.getName(),css,null);
  }
  finally {
    if (cssServiceRegistration == null) {
      if (css instanceof AsyncContactSourceService)       ((AsyncContactSourceService)css).stop();
      css=null;
    }
  }
}
