int[] energy
int[] shift
short[] x
int x_offset
int len
