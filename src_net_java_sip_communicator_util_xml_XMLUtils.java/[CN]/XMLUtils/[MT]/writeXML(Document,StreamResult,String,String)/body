{
  try {
    logger.logEntry();
    DOMSource domSource=new DOMSource(document);
    TransformerFactory tf=TransformerFactory.newInstance();
    Transformer serializer=tf.newTransformer();
    if (doctypeSystem != null)     serializer.setOutputProperty(OutputKeys.DOCTYPE_SYSTEM,doctypeSystem);
    if (doctypePublic != null)     serializer.setOutputProperty(OutputKeys.DOCTYPE_PUBLIC,doctypePublic);
    serializer.setOutputProperty(OutputKeys.ENCODING,"UTF-8");
    serializer.setOutputProperty(OutputKeys.INDENT,"yes");
    serializer.transform(domSource,streamResult);
  }
 catch (  TransformerException ex) {
    logger.error("Error saving configuration file",ex);
    throw new java.io.IOException("Failed to write the configuration file: " + ex.getMessageAndLocation());
  }
catch (  IllegalArgumentException ex) {
    logger.error("Error saving configuration file",ex);
  }
 finally {
    logger.logExit();
  }
}
