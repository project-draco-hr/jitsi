{
  if (off + len > data.length)   return;
  byte[] cipherStream=null;
  if (len > streamBuf.length) {
    cipherStream=new byte[len];
    if (cipherStream.length <= MAX_BUFFER_LENGTH) {
      streamBuf=cipherStream;
    }
  }
 else {
    cipherStream=streamBuf;
  }
  getCipherStream(cipher,cipherStream,len,iv);
  for (int i=0; i < len; i++)   data[i + off]^=cipherStream[i];
}
