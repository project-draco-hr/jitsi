{
  ServiceReference serRef;
  ProtocolProviderService protocolProvider;
  for (  AccountID accountID : providerFactory.getRegisteredAccounts()) {
    serRef=providerFactory.getProviderForAccount(accountID);
    protocolProvider=(ProtocolProviderService)UtilActivator.bundleContext.getService(serRef);
    if (!loginRenderer.containsProtocolProviderUI(protocolProvider)) {
      protocolProvider.addRegistrationStateChangeListener(this);
      loginRenderer.addProtocolProviderUI(protocolProvider);
    }
    Object status=AccountStatusUtils.getProtocolProviderLastStatus(protocolProvider);
    if (status == null || status.equals(GlobalStatusEnum.ONLINE_STATUS) || ((status instanceof PresenceStatus) && (((PresenceStatus)status).getStatus() >= PresenceStatus.ONLINE_THRESHOLD))) {
      login(protocolProvider);
    }
  }
}
