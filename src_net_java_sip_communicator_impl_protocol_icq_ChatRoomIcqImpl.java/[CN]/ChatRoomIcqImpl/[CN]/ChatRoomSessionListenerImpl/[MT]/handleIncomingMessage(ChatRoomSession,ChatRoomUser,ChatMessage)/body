{
  logger.debug("Incoming multi user chat message received: " + chatMessage.getMessage());
  String msgBody=chatMessage.getMessage();
  String msgContent;
  if (msgBody.startsWith(defaultHtmlStartTag)) {
    msgContent=msgBody.substring(msgBody.indexOf(defaultHtmlStartTag) + defaultHtmlStartTag.length(),msgBody.indexOf(defaultHtmlEndTag));
  }
 else   msgContent=msgBody;
  Message newMessage=createMessage(msgContent.getBytes(),HTML_MIME_TYPE,OperationSetBasicInstantMessagingIcqImpl.DEFAULT_MIME_ENCODING,null);
  String memberUID=chatRoomUser.getScreenname().getFormatted();
  String memberNickName=provider.getInfoRetreiver().getNickName(memberUID);
  if (memberUID.equals(nickName))   return;
  ChatRoomMemberIcqImpl member=new ChatRoomMemberIcqImpl(chatRoom,memberNickName,memberUID,ChatRoomMemberRole.MEMBER);
  ChatRoomMessageReceivedEvent msgReceivedEvent=new ChatRoomMessageReceivedEvent(chatRoom,member,System.currentTimeMillis(),newMessage,ChatRoomMessageReceivedEvent.CONVERSATION_MESSAGE_RECEIVED);
  fireMessageEvent(msgReceivedEvent);
}
