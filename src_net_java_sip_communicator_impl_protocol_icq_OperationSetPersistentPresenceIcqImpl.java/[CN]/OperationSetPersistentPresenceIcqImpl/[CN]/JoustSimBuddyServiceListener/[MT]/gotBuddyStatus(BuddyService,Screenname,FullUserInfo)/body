{
  logger.debug("Received a status update for buddy=" + buddy);
  logger.debug("Updated user info is " + info);
  ContactIcqImpl sourceContact=ssContactList.findContactByScreenName(buddy.getFormatted());
  if (sourceContact == null) {
    logger.warn("No source contact found for screenname=" + buddy);
    return;
  }
  PresenceStatus oldStatus=sourceContact.getPresenceStatus();
  PresenceStatus newStatus=null;
  if (!icqProvider.USING_ICQ) {
    Boolean awayStatus=info.getAwayStatus();
    if (awayStatus == null || awayStatus.equals(Boolean.FALSE))     newStatus=AimStatusEnum.ONLINE;
 else     newStatus=AimStatusEnum.AWAY;
  }
 else   newStatus=statusLongToPresenceStatus(info.getIcqStatus());
  sourceContact.updatePresenceStatus(newStatus);
  ContactGroupIcqImpl parent=ssContactList.findContactGroup(sourceContact);
  List extraInfoBlocks=info.getExtraInfoBlocks();
  if (extraInfoBlocks != null) {
    for (int i=0; i < extraInfoBlocks.size(); i++) {
      ExtraInfoBlock block=((ExtraInfoBlock)extraInfoBlocks.get(i));
      if (block.getType() == ExtraInfoBlock.TYPE_AVAILMSG) {
        String status=ExtraInfoData.readAvailableMessage(block.getExtraData());
        logger.info("Status Message is: " + status + ".");
        sourceContact.setStatusMessage(status);
      }
    }
  }
  logger.debug("Will Dispatch the contact status event.");
  fireContactPresenceStatusChangeEvent(sourceContact,parent,oldStatus,newStatus);
}
