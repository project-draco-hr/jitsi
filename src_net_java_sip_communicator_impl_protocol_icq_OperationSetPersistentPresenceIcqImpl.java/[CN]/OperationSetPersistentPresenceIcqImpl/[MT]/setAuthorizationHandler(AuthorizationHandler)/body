{
  ClientSnacProcessor snacProcessor=icqProvider.getAimConnection().getInfoService().getOscarConnection().getSnacProcessor();
  AuthCmdFactory authCmdFactory=new AuthCmdFactory(icqProvider,icqProvider.getAimConnection(),handler);
  SsiCmdFactory ssiCmdFactory=new SsiCmdFactory(icqProvider,icqProvider.getAimConnection(),handler);
  ChannelFourCmdFactory channelFourFactory=((OperationSetBasicInstantMessagingIcqImpl)icqProvider.getSupportedOperationSets().get(OperationSetBasicInstantMessaging.class.getName())).getChannelFourFactory();
  channelFourFactory.addCommandHandler(IcbmChannelFourCommand.MTYPE_AUTHREQ,authCmdFactory);
  channelFourFactory.addCommandHandler(IcbmChannelFourCommand.MTYPE_AUTHDENY,authCmdFactory);
  channelFourFactory.addCommandHandler(IcbmChannelFourCommand.MTYPE_AUTHOK,authCmdFactory);
  snacProcessor.addGlobalResponseListener(authCmdFactory);
  snacProcessor.getCmdFactoryMgr().getDefaultFactoryList().registerAll(ssiCmdFactory);
}
