{
  super(IcbmCommand.CMD_ICBM,packet);
  DefensiveTools.checkNull(packet,"packet");
  ByteBlock snacData=getChannelData();
  FullUserInfo userInfo=FullUserInfo.readUserInfo(snacData);
  ByteBlock tlvBlock=snacData.subBlock(userInfo.getTotalSize());
  TlvChain chain=TlvTools.readChain(tlvBlock);
  Tlv messageDataTlv=chain.getLastTlv(TYPE_MESSAGE_DATA);
  ByteBlock messageData=messageDataTlv.getData();
  sender=LEBinaryTools.getUInt(messageData,0);
  messageType=LEBinaryTools.getUByte(messageData,4);
  int msgFlags=LEBinaryTools.getUByte(messageData,5);
  int textlen=LEBinaryTools.getUShort(messageData,6);
  ByteBlock field=messageData.subBlock(8,textlen);
  reason=OscarTools.getString(field,"US-ASCII");
}
