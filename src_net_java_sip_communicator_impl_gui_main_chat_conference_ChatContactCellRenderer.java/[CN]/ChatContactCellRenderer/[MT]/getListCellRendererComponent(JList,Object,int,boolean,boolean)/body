{
  this.index=index;
  this.rightLabel.setIcon(null);
  final ChatContact chatContact=(ChatContact)value;
  final ChatRoomMember member=(ChatRoomMember)chatContact.getDescriptor();
  this.setPreferredSize(new Dimension(20,30));
  String displayName=chatContact.getName();
  if (displayName == null || displayName.length() < 1) {
    displayName=GuiActivator.getResources().getI18NString("service.gui.UNKNOWN");
  }
  this.nameLabel.setFont(this.getFont().deriveFont(Font.PLAIN));
  this.nameLabel.setText(displayName);
  if (member.getRole() != null)   this.nameLabel.setIcon(ChatContactRoleIcon.getRoleIcon(member.getRole()));
  if (contactForegroundColor != null)   this.nameLabel.setForeground(contactForegroundColor);
  this.setBorder(BorderFactory.createEmptyBorder(1,5,1,1));
  ImageIcon avatar=chatContact.getAvatar();
  if (avatar != null)   this.rightLabel.setIcon(avatar);
 else {
    if (chatContact.getName().equals(member.getChatRoom().getUserNickname())) {
      OperationSetServerStoredAccountInfo opSet=(OperationSetServerStoredAccountInfo)member.getChatRoom().getParentProvider().getOperationSet(OperationSetServerStoredAccountInfo.class);
      Iterator<GenericDetail> itr=opSet.getAllAvailableDetails();
      while (itr.hasNext()) {
        GenericDetail detail=itr.next();
        if (detail instanceof BinaryDetail) {
          BinaryDetail bin=(BinaryDetail)detail;
          if (bin.getBytes() != null)           this.rightLabel.setIcon(ImageUtils.getScaledRoundedIcon(bin.getBytes(),25,25));
          break;
        }
      }
      ChatRoomMemberRole role=member.getChatRoom().getUserRole();
      if (role != null)       this.nameLabel.setIcon(ChatContactRoleIcon.getRoleIcon(role));
    }
 else {
      OperationSetPersistentPresence opSet=(OperationSetPersistentPresence)member.getChatRoom().getParentProvider().getOperationSet(OperationSetPersistentPresence.class);
      Contact c=opSet.findContactByID(member.getContactAddress());
      if (opSet != null && c != null && c.getImage() != null)       this.rightLabel.setIcon(ImageUtils.getScaledRoundedIcon(c.getImage(),25,25));
    }
  }
  this.setBounds(0,0,list.getWidth() - 2,30);
  this.nameLabel.setBounds(0,0,list.getWidth() - 28,17);
  this.rightLabel.setBounds(list.getWidth() - 28,0,25,30);
  this.isLeaf=true;
  this.isSelected=isSelected;
  return this;
}
