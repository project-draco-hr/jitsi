{
  int write=0;
  for (int streamIndex=0, streamCount=streams.size(); streamIndex < streamCount; streamIndex++) {
    OutputDataStreamDesc streamDesc=streams.get(streamIndex);
    StreamRTPManagerDesc streamRTPManagerDesc=streamDesc.connectorDesc.streamRTPManagerDesc;
    if (streamRTPManagerDesc != exclusion) {
      if (data && (format != null) && (length > 0)) {
        Integer payloadType=streamRTPManagerDesc.getPayloadType(format);
        if ((payloadType == null) && (exclusion != null))         payloadType=exclusion.getPayloadType(format);
        if (payloadType != null) {
          int payloadTypeByteIndex=offset + 1;
          buffer[payloadTypeByteIndex]=(byte)((buffer[payloadTypeByteIndex] & 0x80) | (payloadType & 0x7f));
        }
      }
      int streamWrite=streamDesc.stream.write(buffer,offset,length);
      if (write < streamWrite)       write=streamWrite;
    }
  }
  return write;
}
