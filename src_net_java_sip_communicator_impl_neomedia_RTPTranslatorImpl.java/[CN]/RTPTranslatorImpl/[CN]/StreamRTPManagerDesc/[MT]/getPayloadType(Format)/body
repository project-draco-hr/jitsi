{
synchronized (formats) {
    for (    Map.Entry<Integer,Format> entry : formats.entrySet()) {
      Format entryFormat=entry.getValue();
      if (entryFormat.matches(format) || format.matches(entryFormat))       return entry.getKey();
    }
  }
  return null;
}
