{
  if (!ConfigurationManager.isWindowDecorated()) {
    this.setUndecorated(true);
  }
  this.addWindowFocusListener(this);
  this.setHierarchicallyOpaque(false);
  this.setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
  if (ConfigurationManager.isMultiChatWindowEnabled()) {
    chatTabbedPane=new SIPCommTabbedPane(true,false);
    chatTabbedPane.addCloseListener(new CloseListener(){
      public void closeOperation(      MouseEvent e){
        int tabIndex=chatTabbedPane.getOverTabIndex();
        ChatPanel chatPanel=(ChatPanel)chatTabbedPane.getComponentAt(tabIndex);
        GuiActivator.getUIService().getChatWindowManager().closeChat(chatPanel);
      }
    }
);
    chatTabbedPane.addChangeListener(new ChangeListener(){
      public void stateChanged(      ChangeEvent evt){
        removeNonReadChatState();
      }
    }
);
  }
  menuBar=new MessageWindowMenuBar(this);
  this.setJMenuBar(menuBar);
  boolean isToolBarExtended=Boolean.parseBoolean(GuiActivator.getResources().getSettingsString("impl.gui.IS_TOOLBAR_EXTENDED"));
  if (isToolBarExtended)   mainToolBar=new ExtendedMainToolBar(this);
 else   mainToolBar=new MainToolBar(this);
  boolean chatToolbarVisible=ConfigurationManager.isChatToolbarVisible();
  mainToolBar.setVisible(chatToolbarVisible);
  contactPhotoPanel.setVisible(chatToolbarVisible);
  Component logoBar=LogoBar.createInstance();
  if (logoBar != null)   northPanel.add(logoBar,BorderLayout.NORTH);
  northPanel.add(mainToolBar,BorderLayout.CENTER);
  northPanel.add(contactPhotoPanel,BorderLayout.EAST);
  this.mainPanel.add(northPanel,BorderLayout.NORTH);
  this.getContentPane().add(mainPanel,BorderLayout.CENTER);
  this.getContentPane().add(statusBarPanel,BorderLayout.SOUTH);
  this.initPluginComponents();
  this.setKeybindingInput(KeybindingSet.Category.CHAT);
  this.addKeybindingAction("plugin.keybindings.CHAT_NEXT_TAB",new ForwordTabAction());
  this.addKeybindingAction("plugin.keybindings.CHAT_PREVIOUS_TAB",new BackwordTabAction());
  this.addKeybindingAction("plugin.keybindings.CHAT_COPY",new CopyAction());
  this.addKeybindingAction("plugin.keybindings.CHAT_PASTE",new PasteAction());
  this.addKeybindingAction("chat-openSmilies",new OpenSmileyAction());
  this.addKeybindingAction("chat-openHistory",new OpenHistoryAction());
  this.addKeybindingAction("chat-close",new CloseAction());
  this.addWindowListener(new ChatWindowAdapter());
  int width=GuiActivator.getResources().getSettingsInt("impl.gui.CHAT_WINDOW_WIDTH");
  int height=GuiActivator.getResources().getSettingsInt("impl.gui.CHAT_WINDOW_HEIGHT");
  this.setSize(width,height);
}
