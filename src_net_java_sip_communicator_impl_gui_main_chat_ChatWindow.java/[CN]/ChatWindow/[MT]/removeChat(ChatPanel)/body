{
  logger.debug("Removes chat for contact: " + chatPanel.getChatName());
  if (getChatTabCount() == 0) {
    this.getContentPane().remove(chatPanel);
    this.getContentPane().validate();
    this.getContentPane().repaint();
    this.setVisible(false);
    return;
  }
  int index=chatTabbedPane.indexOfComponent(chatPanel);
  if (index != -1) {
    if (chatTabbedPane.getTabCount() > 1)     chatTabbedPane.removeTabAt(index);
    if (chatTabbedPane.getTabCount() == 1) {
      ChatPanel currentChatPanel=(ChatPanel)this.chatTabbedPane.getComponentAt(0);
      this.chatTabbedPane.removeAll();
      this.getContentPane().remove(chatTabbedPane);
      this.getContentPane().add(currentChatPanel,BorderLayout.CENTER);
      this.setCurrentChatPanel(currentChatPanel);
    }
  }
  if (chatPanel instanceof MetaContactChatPanel) {
    MetaContactChatPanel metaContactChatPanel=(MetaContactChatPanel)chatPanel;
    MetaContact metaContact=metaContactChatPanel.getMetaContact();
    Iterator protocolContacts=metaContact.getContacts();
    while (protocolContacts.hasNext()) {
      Contact subContact=(Contact)protocolContacts.next();
      getMainFrame().getProtocolPresenceOpSet(subContact.getProtocolProvider()).removeContactPresenceStatusListener(metaContactChatPanel);
    }
  }
}
