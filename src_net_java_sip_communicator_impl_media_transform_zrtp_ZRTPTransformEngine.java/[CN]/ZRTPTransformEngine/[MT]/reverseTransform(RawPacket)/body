{
  byte[] buffer=pkt.getBuffer();
  int offset=pkt.getOffset();
  if ((buffer[offset] & 0x10) != 0x10) {
    if (!started && enableZrtp && (multiStream || (sendPacketCount >= 1))) {
      startZrtp();
    }
    if (srtpInTransformer == null) {
      return pkt;
    }
    pkt=srtpInTransformer.reverseTransform(pkt);
    if (pkt != null && zrtpEngine != null && !zrtpEngine.inState(ZrtpStateClass.ZrtpStates.SecureState)) {
      zrtpEngine.conf2AckSecure();
    }
    return pkt;
  }
  if (enableZrtp) {
    ZrtpRawPacket zPkt=new ZrtpRawPacket(pkt);
    if (!zPkt.checkCrc()) {
      securityEventManager.showMessage(ZrtpCodes.MessageSeverity.Warning,EnumSet.of(ZrtpCodes.WarningCodes.WarningCRCmismatch));
      return null;
    }
    if (!zPkt.hasMagic() || zrtpEngine == null) {
      return null;
    }
    byte[] extHeader=zPkt.getMessagePart();
    zrtpEngine.processZrtpMessage(extHeader,zPkt.getSSRC());
  }
  return null;
}
