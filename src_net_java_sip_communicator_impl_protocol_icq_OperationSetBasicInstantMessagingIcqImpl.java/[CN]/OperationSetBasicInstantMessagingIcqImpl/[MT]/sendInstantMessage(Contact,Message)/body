{
  assertConnected();
  if (to.getPresenceStatus().isOnline()) {
    ImConversation imConversation=icqProvider.getAimConnection().getIcbmService().getImConversation(new Screenname(to.getAddress()));
    imConversation.sendMessage(new SimpleMessage(message.getContent()));
  }
 else   icqProvider.getAimConnection().getIcbmService().sendSnac(new SendOfflineIm(to.getAddress(),message.getContent()));
  MessageDeliveredEvent msgDeliveredEvt=new MessageDeliveredEvent(message,to,new Date());
  fireMessageEvent(msgDeliveredEvt);
}
