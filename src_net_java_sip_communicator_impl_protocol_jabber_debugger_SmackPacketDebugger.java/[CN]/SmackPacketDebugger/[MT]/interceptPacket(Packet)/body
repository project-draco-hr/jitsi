{
  try {
    if (packetLogging.isLoggingEnabled(PacketLoggingService.ProtocolName.JABBER) && packet != null && connection.getSocket() != null) {
      if (remoteAddress == null) {
        remoteAddress=connection.getSocket().getInetAddress().getAddress();
        localAddress=connection.getSocket().getLocalAddress().getAddress();
      }
      packetLogging.logPacket(PacketLoggingService.ProtocolName.JABBER,localAddress,connection.getSocket().getLocalPort(),remoteAddress,connection.getPort(),PacketLoggingService.TransportName.TCP,true,packet.toXML().getBytes("UTF-8"));
    }
  }
 catch (  Throwable t) {
    t.printStackTrace();
  }
}
