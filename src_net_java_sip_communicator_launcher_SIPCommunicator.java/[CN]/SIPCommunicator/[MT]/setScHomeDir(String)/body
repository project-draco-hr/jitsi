{
  String location=System.getProperty(PNAME_SC_HOME_DIR_LOCATION);
  String name=System.getProperty(PNAME_SC_HOME_DIR_NAME);
  boolean isHomeDirnameForced=name != null;
  if ((location == null) || (name == null)) {
    String defaultLocation=System.getProperty("user.home");
    String defaultName=".jitsi";
    boolean chekLegacyDirNames=(name == null) || name.equals(OVERRIDABLE_DIR_NAME);
    if (osName.startsWith("Mac")) {
      if (location == null)       location=System.getProperty("user.home") + File.separator + "Library"+ File.separator+ "Application Support";
      if (name == null)       name="Jitsi";
    }
 else     if (osName.startsWith("Windows")) {
      if (location == null)       location=System.getenv("APPDATA");
      if (name == null)       name="Jitsi";
    }
    if (location == null)     location=defaultLocation;
    if (name == null)     name=defaultName;
    if (!isHomeDirnameForced && (new File(location,name).isDirectory() == false) && new File(defaultLocation,defaultName).isDirectory()) {
      location=defaultLocation;
      name=defaultName;
    }
    if (chekLegacyDirNames && !checkHomeFolderExist(location,name,osName)) {
      for (      String dir : LEGACY_DIR_NAMES) {
        if (checkHomeFolderExist(location,dir,osName)) {
          name=dir;
          break;
        }
        if (checkHomeFolderExist(defaultLocation,dir,osName)) {
          name=dir;
          location=defaultLocation;
          break;
        }
      }
    }
    System.setProperty(PNAME_SC_HOME_DIR_LOCATION,location);
    System.setProperty(PNAME_SC_HOME_DIR_NAME,name);
  }
  new File(location,name + File.separator + "log").mkdirs();
}
