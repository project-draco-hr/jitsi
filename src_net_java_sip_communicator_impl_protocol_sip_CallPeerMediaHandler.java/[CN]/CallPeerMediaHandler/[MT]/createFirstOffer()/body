{
  MediaService mediaService=SipActivator.getMediaService();
  Vector<MediaDescription> mediaDescs=new Vector<MediaDescription>();
  MediaDevice aDev=mediaService.getDefaultDevice(MediaType.AUDIO);
  if (aDev != null) {
    MediaDirection audioDirection=aDev.getDirection().and(audioDirectionUserPreference);
    if (audioDirection != MediaDirection.INACTIVE)     ;
{
      mediaDescs.add(createMediaDescription(aDev.getSupportedFormats(),getStreamConnector(MediaType.AUDIO),audioDirection));
    }
  }
  MediaDevice vDev=mediaService.getDefaultDevice(MediaType.VIDEO);
  if (vDev != null) {
    MediaDirection videoDirection=vDev.getDirection().and(videoDirectionUserPreference);
    if (videoDirection != MediaDirection.INACTIVE)     ;
{
      mediaDescs.add(createMediaDescription(vDev.getSupportedFormats(),getStreamConnector(MediaType.VIDEO),videoDirection));
    }
  }
  if (mediaDescs.size() == 0) {
    ProtocolProviderServiceSipImpl.throwOperationFailedException("We couldn't find any active Audio/Video devices and " + "couldn't create a call",OperationFailedException.GENERAL_ERROR,null,logger);
  }
  String userName=peer.getProtocolProvider().getAccountID().getUserID();
  SessionDescription sDes=SdpUtils.createSessionDescription(getLocalHost(),userName,mediaDescs);
  this.localSess=sDes;
  return localSess;
}
