{
  Vector<MediaDescription> mediaDescs=new Vector<MediaDescription>();
  for (  MediaType mediaType : MediaType.values()) {
    MediaDevice dev=getDefaultDevice(mediaType);
    if (dev != null) {
      MediaDirection direction=dev.getDirection().and(getDirectionUserPreference(mediaType));
      if (locallyOnHold)       direction=direction.and(MediaDirection.SENDONLY);
      if (direction != MediaDirection.INACTIVE) {
        MediaDescription md=createMediaDescription(dev.getFormat(),dev.getSupportedFormats(),getStreamConnector(mediaType),direction,dev.getSupportedExtensions());
        System.out.println("supported extensions=" + dev.getSupportedExtensions());
        if (peer.getCall().isSipZrtpAttribute()) {
          try {
            ZrtpControl control=zrtpControls.get(mediaType);
            if (control == null) {
              control=SipActivator.getMediaService().createZrtpControl();
              zrtpControls.put(mediaType,control);
            }
            String helloHash=control.getHelloHash();
            if (helloHash != null && helloHash.length() > 0)             md.setAttribute("zrtp-hash",helloHash);
          }
 catch (          SdpException ex) {
            logger.error("Cannot add zrtp-hash to sdp",ex);
          }
        }
        mediaDescs.add(md);
      }
    }
  }
  if (mediaDescs.isEmpty()) {
    ProtocolProviderServiceSipImpl.throwOperationFailedException("We couldn't find any active Audio/Video devices and " + "couldn't create a call",OperationFailedException.GENERAL_ERROR,null,logger);
  }
  return mediaDescs;
}
