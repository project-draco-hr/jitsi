{
  int[] payloadTypesArray=new int[formats.size()];
  List<Attribute> mediaAttributes=new ArrayList<Attribute>(payloadTypesArray.length);
  MediaType mediaType=null;
  for (int i=0; i < payloadTypesArray.length; i++) {
    MediaFormat format=formats.get(i);
    MediaType fmtMediaType=format.getMediaType();
    if (mediaType != null) {
      mediaType=fmtMediaType;
    }
    int payloadType=formats.get(i).getRTPPayloadType();
    if (payloadType == MediaFormat.RTP_PAYLOAD_TYPE_UNKNOWN) {
      Integer dynamicPT=dynamicPayloadTypes.get(format);
      if (dynamicPT == null) {
        payloadType=nextDynamicPayloadType++;
        dynamicPayloadTypes.put(format,new Integer(payloadType));
      }
 else {
        payloadType=dynamicPT.intValue();
      }
    }
    String channelsString="";
    if (format instanceof AudioMediaFormat) {
      int channels=((AudioMediaFormat)format).getChannels();
      if (channels > 1)       channelsString="/" + channels;
    }
    Attribute rtpmap=sdpFactory.createAttribute(SdpConstants.RTPMAP + ":" + payloadType,format.getEncoding() + "/" + format.getClockRate()+ channelsString);
    mediaAttributes.add(rtpmap);
    Attribute fmtp=sdpFactory.createAttribute(SdpConstants.FMTP + ":" + payloadType,encodeFmtp(format));
    mediaAttributes.add(fmtp);
    payloadTypesArray[i]=payloadType;
  }
  return null;
}
