{
  Object sourceObject=event.getSource();
  if (sourceObject.equals(autoStartCheckBox)) {
    try {
      String workingDir=new File(".").getCanonicalPath();
      String appName=getApplicationName();
      ShellLink shortcut=new ShellLink(ShellLink.STARTUP,appName);
      shortcut.setUserType(ShellLink.CURRENT_USER);
      shortcut.setDescription("This starts " + appName + " Application");
      shortcut.setIconLocation(workingDir + File.separator + "sc-logo.ico",0);
      shortcut.setShowCommand(ShellLink.MINNOACTIVE);
      shortcut.setTargetPath(workingDir + File.separator + "run.exe");
      shortcut.setWorkingDirectory(workingDir);
      String f1=shortcut.getcurrentUserLinkPath() + File.separator + appName+ ".lnk";
      String f2=f1.replaceAll(System.getProperty("user.name"),"All Users");
      if (autoStartCheckBox.isSelected()) {
        if (!new File(f1).exists() && !new File(f2).exists())         shortcut.save();
      }
 else {
        boolean isFileDeleted=false;
        try {
          isFileDeleted=new File(f1).delete();
        }
 catch (        Exception e) {
        }
        try {
          new File(f2).delete();
        }
 catch (        Exception e) {
          if (!isFileDeleted)           GeneralConfigPluginActivator.getUIService().getPopupDialog().showMessagePopupDialog(e.getMessage(),Resources.getString("plugin.generalconfig.ERROR_PERMISSION"),PopupDialog.ERROR_MESSAGE);
        }
      }
    }
 catch (    Exception e) {
      logger.error("Cannot create/delete startup shortcut",e);
    }
  }
  if (sourceObject.equals(groupMessagesCheckBox)) {
    ConfigurationManager.setMultiChatWindowEnabled(groupMessagesCheckBox.isSelected());
  }
 else   if (sourceObject.equals(logHistoryCheckBox)) {
    ConfigurationManager.setHistoryLoggingEnabled(logHistoryCheckBox.isSelected());
  }
 else   if (sourceObject.equals(showHistoryCheckBox)) {
    ConfigurationManager.setHistoryShown(showHistoryCheckBox.isSelected());
  }
 else   if (sourceObject.equals(enableTypingNotifiCheckBox)) {
    ConfigurationManager.setSendTypingNotifications(enableTypingNotifiCheckBox.isSelected());
  }
 else   if (sourceObject.equals(bringToFrontCheckBox)) {
    ConfigurationManager.setAutoPopupNewMessage(bringToFrontCheckBox.isSelected());
  }
}
