{
  File tmpDir=unzipIntoTmp(zip);
  if (!test(tmpDir)) {
    deleteDir(tmpDir);
    throw new Exception("Zip file doesn't contain all necessary files and folders.");
  }
  File jar=cpTmp();
  insertIntoZip(jar,tmpDir);
  deleteDir(tmpDir);
  return jar;
}
