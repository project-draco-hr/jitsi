{
  MouseRolloverHandler mouseHandler=new MouseRolloverHandler();
  this.addMouseListener(mouseHandler);
  this.addMouseMotionListener(mouseHandler);
  getPopupMenu().addComponentListener(new ComponentAdapter(){
    public void componentResized(    ComponentEvent evt){
      Window parentWindow;
      Component parent=SIPCommMenu.this.getParent();
      if (parent instanceof JPopupMenu)       parentWindow=SwingUtilities.getWindowAncestor(((JPopupMenu)parent).getInvoker());
 else       parentWindow=SwingUtilities.getWindowAncestor(SIPCommMenu.this);
      if (!parentWindow.isActive()) {
        getPopupMenu().setVisible(false);
      }
      parentWindow.addWindowFocusListener(new WindowFocusListener(){
        public void windowLostFocus(        WindowEvent e){
          JPopupMenu popupMenu=getPopupMenu();
          if (popupMenu != null && popupMenu.isVisible())           popupMenu.setVisible(false);
        }
        public void windowGainedFocus(        WindowEvent e){
        }
      }
);
    }
  }
);
}
