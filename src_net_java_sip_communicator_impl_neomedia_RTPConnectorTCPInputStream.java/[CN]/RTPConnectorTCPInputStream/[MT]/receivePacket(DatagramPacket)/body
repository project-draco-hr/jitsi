{
  int len=-1;
  byte data[]=null;
  try {
    data=p.getData();
    len=socket.getInputStream().read(data);
  }
 catch (  Exception e) {
    logger.info("problem read: " + e);
  }
  if (len > 0) {
    p.setData(data);
    p.setLength(len);
    p.setAddress(socket.getInetAddress());
    p.setPort(socket.getPort());
  }
 else {
    throw new IOException("Failed to read on TCP socket");
  }
}
