{
  Collection<ServiceReference<ProtocolProviderFactory>> serRefs;
  try {
    serRefs=bundleContext.getServiceReferences(ProtocolProviderFactory.class,null);
  }
 catch (  InvalidSyntaxException e) {
    serRefs=null;
    logger.error("LoginManager : " + e);
  }
  if (serRefs != null) {
    for (    ServiceReference<ProtocolProviderFactory> serRef : serRefs) {
      ProtocolProviderFactory providerFactory=bundleContext.getService(serRef);
      providerFactoriesMap.put(serRef.getProperty(ProtocolProviderFactory.PROTOCOL),providerFactory);
    }
  }
  return providerFactoriesMap;
}
