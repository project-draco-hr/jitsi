{
  MetaContactQuery query=new MetaContactQuery();
  filterQuery.addContactQuery(query);
  List<ContactQuery> contactQueryList=new ArrayList<ContactQuery>();
  Iterator<UIContactSource> filterSources=GuiActivator.getContactList().getContactSources(ContactSourceService.PRESENCE_TYPE).iterator();
  while (filterSources.hasNext()) {
    final UIContactSource filterSource=filterSources.next();
    ContactSourceService sourceService=filterSource.getContactSourceService();
    ContactQuery contactQuery=sourceService.queryContactSource(null);
    contactQueryList.add(contactQuery);
    filterQuery.addContactQuery(contactQuery);
  }
  filterQuery.close();
  query.addContactQueryListener(GuiActivator.getContactList());
  int resultCount=0;
  addMatching(GuiActivator.getContactListService().getRoot(),query,resultCount);
  for (  ContactQuery contactQuery : contactQueryList) {
    for (    SourceContact contact : contactQuery.getQueryResults()) {
      addSourceContact(contact);
    }
    contactQuery.addContactQueryListener(GuiActivator.getContactList());
  }
  if (!query.isCanceled())   query.fireQueryEvent(MetaContactQueryStatusEvent.QUERY_COMPLETED);
 else   query.fireQueryEvent(MetaContactQueryStatusEvent.QUERY_CANCELED);
}
