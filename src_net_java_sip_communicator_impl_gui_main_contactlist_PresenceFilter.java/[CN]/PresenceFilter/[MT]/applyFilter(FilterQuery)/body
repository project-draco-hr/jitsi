{
  MetaContactQuery query=new MetaContactQuery();
  filterQuery.addContactQuery(query);
  for (  int cssType : contactSourcePreferences.keySet()) {
    Iterator<UIContactSource> filterSources=GuiActivator.getContactList().getContactSources(cssType).iterator();
    while (filterSources.hasNext()) {
      UIContactSource filterSource=filterSources.next();
      Integer prefValue=contactSourcePreferences.get(cssType);
      if (prefValue != null)       filterSource.setContactSourceIndex(prefValue);
      ContactSourceService sourceService=filterSource.getContactSourceService();
      ContactQuery contactQuery=sourceService.createContactQuery(null);
      filterQuery.addContactQuery(contactQuery);
      contactQuery.addContactQueryListener(GuiActivator.getContactList());
      contactQuery.start();
    }
  }
  filterQuery.close();
  query.addContactQueryListener(GuiActivator.getContactList());
  int resultCount=0;
  addMatching(GuiActivator.getContactListService().getRoot(),query,resultCount);
  query.fireQueryEvent(query.isCanceled() ? MetaContactQueryStatusEvent.QUERY_CANCELED : MetaContactQueryStatusEvent.QUERY_COMPLETED);
}
