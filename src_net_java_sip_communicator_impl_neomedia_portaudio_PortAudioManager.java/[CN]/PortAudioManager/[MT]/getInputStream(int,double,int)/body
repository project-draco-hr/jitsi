{
  MasterPortAudioStream st=inputStreams.get(deviceIndex);
  if (st == null) {
    st=new MasterPortAudioStream(deviceIndex,sampleRate,channels);
    inputStreams.put(deviceIndex,st);
    if (isEnabledEchoCancel() && outputStreams.size() > 0) {
      OutputPortAudioStream out=outputStreams.get(outputStreams.size() - 1);
      st.setParams(out,isEnabledDeNoise(),isEnabledEchoCancel(),getFrameSize(),getFilterLength());
    }
 else     st.setParams(null,isEnabledDeNoise(),isEnabledEchoCancel(),getFrameSize(),getFilterLength());
  }
  return new InputPortAudioStream(st);
}
