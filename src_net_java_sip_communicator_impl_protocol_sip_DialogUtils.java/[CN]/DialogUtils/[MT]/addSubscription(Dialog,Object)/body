{
synchronized (dialog) {
    DialogApplicationData applicationData=(DialogApplicationData)SipApplicationData.getApplicationData(dialog,SipApplicationData.KEY_SUBSCRIPTIONS);
    if (applicationData == null) {
      applicationData=new DialogApplicationData();
      SipApplicationData.setApplicationData(dialog,SipApplicationData.KEY_SUBSCRIPTIONS,applicationData);
    }
    if (applicationData.addSubscription(subscription)) {
      try {
        dialog.terminateOnBye(false);
        return true;
      }
 catch (      SipException ex) {
        applicationData.removeSubscription(subscription);
        throw ex;
      }
    }
    return false;
  }
}
