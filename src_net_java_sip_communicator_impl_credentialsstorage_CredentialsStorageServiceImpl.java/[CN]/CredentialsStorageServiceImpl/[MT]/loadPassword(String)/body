{
  String password;
  if (isStoredUnencrypted(accountPrefix)) {
    password=new String(Base64.decode(getUnencrypted(accountPrefix)));
    if (movePasswordProperty(accountPrefix,password))     password=null;
  }
 else   password=null;
  if ((password == null) && isStoredEncrypted(accountPrefix) && createCrypto()) {
    try {
      password=crypto.decrypt(getEncrypted(accountPrefix));
    }
 catch (    Exception ex) {
      logger.error("Decryption with master password failed",ex);
    }
  }
  return password;
}
