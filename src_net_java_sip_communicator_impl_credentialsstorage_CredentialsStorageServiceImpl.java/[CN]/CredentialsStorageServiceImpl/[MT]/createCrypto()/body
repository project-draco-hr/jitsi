{
  if (crypto == null) {
    logger.debug("Crypto instance is null, creating.");
    if (isUsingMasterPassword()) {
      String master=showPasswordPrompt();
      if (master == null) {
        crypto=null;
        return false;
      }
      setMasterPassword(master);
    }
 else {
      logger.debug("Master password not set");
      setMasterPassword(null);
    }
  }
  return true;
}
