{
  if (document.getLength() > Chat.CHAT_BUFFER_SIZE) {
    int msgElementCount=0;
    Element firstMsgElement=null;
    Element root=document.getDefaultRootElement();
    Element bodyElement=root.getElement(root.getElementCount() - 1);
    for (int i=0; i < bodyElement.getElementCount(); i++) {
      String idAttr=(String)bodyElement.getElement(i).getAttributes().getAttribute(Attribute.ID);
      if (idAttr != null && (idAttr.startsWith(ChatHtmlUtils.MESSAGE_DIV_ID) || idAttr.equals("statusMessage") || idAttr.equals("systemMessage")|| idAttr.equals("actionMessage"))) {
        if (firstMsgElement == null) {
          firstMsgElement=bodyElement.getElement(i);
        }
        msgElementCount++;
      }
    }
    if (firstMsgElement == null || msgElementCount < 2)     return;
    try {
      this.document.remove(firstMsgElement.getStartOffset(),firstMsgElement.getEndOffset() - firstMsgElement.getStartOffset());
    }
 catch (    BadLocationException e) {
      logger.error("Error removing messages from chat: ",e);
    }
  }
}
