{
  ServiceInfo info=dns.services.get(name.toLowerCase());
  if (info != null && (port != info.port || !server.equalsIgnoreCase(dns.getLocalHost().getName()))) {
    logger.finer("handleQuery() Conflicting probe detected");
    if (info.getState().isProbing() && lexCompare(new DNSRecord.Service(info.getQualifiedName(),DNSConstants.TYPE_SRV,DNSConstants.CLASS_IN | DNSConstants.CLASS_UNIQUE,DNSConstants.DNS_TTL,info.priority,info.weight,info.port,dns.getLocalHost().getName())) >= 0) {
      String oldName=info.getQualifiedName().toLowerCase();
      info.setName(dns.incrementName(info.getName()));
      dns.services.remove(oldName);
      dns.services.put(info.getQualifiedName().toLowerCase(),info);
      logger.finer("handleQuery() Lost tie break: new unique name chosen:" + info.getName());
    }
    info.revertState();
    return true;
  }
  return false;
}
