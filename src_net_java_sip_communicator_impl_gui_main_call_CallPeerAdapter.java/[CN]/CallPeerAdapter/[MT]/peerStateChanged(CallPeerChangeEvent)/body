{
  CallPeer sourcePeer=evt.getSourceCallPeer();
  if (!sourcePeer.equals(callPeer))   return;
  CallPeerState newState=(CallPeerState)evt.getNewValue();
  CallPeerState oldState=(CallPeerState)evt.getOldValue();
  String newStateString=sourcePeer.getState().getLocalizedStateString();
  if (newState == CallPeerState.INITIATING_CALL || newState == CallPeerState.CONNECTING) {
    NotificationManager.fireNotification(NotificationManager.DIALING);
  }
 else {
    NotificationManager.stopSound(NotificationManager.DIALING);
  }
  if (newState == CallPeerState.ALERTING_REMOTE_SIDE && oldState != CallPeerState.CONNECTING_WITH_EARLY_MEDIA) {
    NotificationManager.fireNotification(NotificationManager.OUTGOING_CALL);
  }
 else   if (newState == CallPeerState.BUSY) {
    NotificationManager.stopSound(NotificationManager.OUTGOING_CALL);
    if (!renderer.getCallPanel().isConference()) {
      NotificationManager.fireNotification(NotificationManager.BUSY_CALL);
    }
  }
 else   if (newState == CallPeerState.CONNECTING_INCOMING_CALL || newState == CallPeerState.CONNECTING_INCOMING_CALL_WITH_MEDIA) {
    if (!CallPeerState.isOnHold(oldState)) {
      NotificationManager.stopSound(NotificationManager.OUTGOING_CALL);
      NotificationManager.stopSound(NotificationManager.INCOMING_CALL);
    }
  }
 else   if (newState == CallPeerState.CONNECTING_WITH_EARLY_MEDIA) {
    NotificationManager.stopSound(NotificationManager.OUTGOING_CALL);
  }
 else   if (newState == CallPeerState.CONNECTED) {
    if (!CallPeerState.isOnHold(oldState)) {
      NotificationManager.stopSound(NotificationManager.OUTGOING_CALL);
      NotificationManager.stopSound(NotificationManager.INCOMING_CALL);
      if (!renderer.getCallPanel().isCallTimerStarted())       renderer.getCallPanel().startCallTimer();
      renderer.getCallPanel().enableButtons();
    }
 else {
      renderer.setOnHold(false);
      renderer.getCallPanel().updateHoldButtonState();
      renderer.getCallPanel().enableButtonsWhileOnHold(false);
    }
  }
 else   if (newState == CallPeerState.DISCONNECTED) {
  }
 else   if (newState == CallPeerState.FAILED) {
  }
 else   if (CallPeerState.isOnHold(newState)) {
    renderer.setOnHold(true);
    renderer.getCallPanel().enableButtonsWhileOnHold(true);
    renderer.getCallPanel().updateHoldButtonState();
  }
  renderer.setPeerState(newStateString);
  String reasonString=evt.getReasonString();
  if (reasonString != null)   renderer.setErrorReason(reasonString);
}
