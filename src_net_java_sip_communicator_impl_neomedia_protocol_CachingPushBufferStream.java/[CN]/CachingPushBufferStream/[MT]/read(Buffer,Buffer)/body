{
  Object outputData=output.getData();
  if (outputData != null) {
    Object inputData=input.getData();
    if (inputData == null) {
      output.setFormat(input.getFormat());
      output.setLength(0);
      return;
    }
    Class<?> dataType=outputData.getClass();
    if (inputData.getClass().equals(dataType) && dataType.equals(byte[].class)) {
      int inputOffset=input.getOffset();
      int inputLength=input.getLength();
      byte[] outputBytes=(byte[])outputData;
      int outputLength=Math.min(inputLength,outputBytes.length);
      System.arraycopy((byte[])inputData,inputOffset,outputBytes,output.getOffset(),outputLength);
      output.setData(outputBytes);
      output.setLength(outputLength);
      output.setFormat(input.getFormat());
      output.setDiscard(input.isDiscard());
      output.setEOM(input.isEOM());
      output.setFlags(input.getFlags());
      output.setHeader(input.getHeader());
      output.setSequenceNumber(input.getSequenceNumber());
      output.setTimeStamp(input.getTimeStamp());
      output.setDuration(Buffer.TIME_UNKNOWN);
      input.setLength(inputLength - outputLength);
      input.setOffset(inputOffset + outputLength);
      return;
    }
  }
  output.copy(input);
  int outputLength=output.getLength();
  input.setLength(input.getLength() - outputLength);
  input.setOffset(input.getOffset() + outputLength);
}
