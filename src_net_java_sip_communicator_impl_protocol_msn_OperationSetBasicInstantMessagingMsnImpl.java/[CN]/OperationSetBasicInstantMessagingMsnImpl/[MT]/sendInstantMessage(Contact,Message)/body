{
  assertConnected();
  if (!(to instanceof ContactMsnImpl))   throw new IllegalArgumentException("The specified contact is not an MSN contact." + to);
  if (to.isPersistent() && to.getPresenceStatus().equals(MsnStatusEnum.OFFLINE)) {
    MessageDeliveryFailedEvent evt=new MessageDeliveryFailedEvent(message,to,MessageDeliveryFailedEvent.OFFLINE_MESSAGES_NOT_SUPPORTED,new Date());
    fireMessageEvent(evt);
    return;
  }
  msnProvider.getMessenger().sendText(((ContactMsnImpl)to).getSourceContact().getEmail(),message.getContent());
  MessageDeliveredEvent msgDeliveredEvt=new MessageDeliveredEvent(message,to,new Date());
  fireMessageEvent(msgDeliveredEvt);
}
