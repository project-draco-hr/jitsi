{
  assertConnected();
  if (!(to instanceof ContactMsnImpl))   throw new IllegalArgumentException("The specified contact is not an MSN contact." + to);
  MessageDeliveredEvent[] transformedEvents=messageDeliveryPendingTransform(new MessageDeliveredEvent(message,to));
  if (transformedEvents == null || transformedEvents.length == 0)   return;
  MessageDeliveredEvent msgDeliveredEvt=new MessageDeliveredEvent(message,to);
  fireMessageEvent(msgDeliveredEvt);
  if (senderThread == null) {
    senderThread=new SenderThread();
    senderThread.start();
  }
  for (  MessageDeliveredEvent event : transformedEvents) {
    senderThread.sendMessage((ContactMsnImpl)to,event.getSourceMessage().getContent());
  }
}
