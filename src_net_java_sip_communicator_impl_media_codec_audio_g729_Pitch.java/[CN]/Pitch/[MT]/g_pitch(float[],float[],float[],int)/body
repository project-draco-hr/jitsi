{
  float GAIN_PIT_MAX=Ld8k.GAIN_PIT_MAX;
  float xy, yy, gain;
  int i;
  xy=0.0f;
  for (i=0; i < l_subfr; i++) {
    xy+=xn[i] * y1[i];
  }
  yy=0.01f;
  for (i=0; i < l_subfr; i++) {
    yy+=y1[i] * y1[i];
  }
  g_coeff[0]=yy;
  g_coeff[1]=-2.0f * xy + 0.01f;
  gain=xy / yy;
  if (gain < 0.0f)   gain=0.0f;
  if (gain > GAIN_PIT_MAX)   gain=GAIN_PIT_MAX;
  return gain;
}
