{
  final Pattern p=Pattern.compile(TWITPIC_PATTERN,Pattern.CASE_INSENSITIVE | Pattern.DOTALL);
  Matcher m=p.matcher(chatString);
  int count=0, startPos=0;
  StringBuffer msgBuff=new StringBuffer();
  while (m.find()) {
    count++;
    msgBuff.append(chatString.substring(startPos,m.start()));
    startPos=m.end();
    msgBuff.append("<IMG HEIGHT=\"90\" WIDTH=\"120\" SRC=\"");
    msgBuff.append("http://twitpic.com/show/thumb/");
    msgBuff.append(m.group(1));
    msgBuff.append("\"></IMG>");
  }
  msgBuff.append(chatString.substring(startPos));
  if (!msgBuff.toString().equals(chatString))   return msgBuff.toString();
  return chatString;
}
