{
synchronized (initializationLock) {
    this.accountID=accountID;
    String keepAliveStrValue=(String)accountID.getAccountProperties().get("SEND_KEEP_ALIVE");
    String resourcePriority=(String)accountID.getAccountProperties().get(ProtocolProviderFactory.RESOURCE_PRIORITY);
    OperationSetPersistentPresenceJabberImpl persistentPresence=new OperationSetPersistentPresenceJabberImpl(this);
    if (resourcePriority != null) {
      persistentPresence.setResourcePriority(new Integer(resourcePriority).intValue());
    }
    supportedOperationSets.put(OperationSetPersistentPresence.class.getName(),persistentPresence);
    supportedOperationSets.put(OperationSetPresence.class.getName(),persistentPresence);
    OperationSetBasicInstantMessagingJabberImpl basicInstantMessaging=new OperationSetBasicInstantMessagingJabberImpl(this);
    if (keepAliveStrValue != null)     basicInstantMessaging.setKeepAliveEnabled(new Boolean(keepAliveStrValue).booleanValue());
    supportedOperationSets.put(OperationSetBasicInstantMessaging.class.getName(),basicInstantMessaging);
    OperationSetTypingNotifications typingNotifications=new OperationSetTypingNotificationsJabberImpl(this);
    supportedOperationSets.put(OperationSetTypingNotifications.class.getName(),typingNotifications);
    OperationSetMultiUserChat multiUserChat=new OperationSetMultiUserChatJabberImpl(this);
    supportedOperationSets.put(OperationSetMultiUserChat.class.getName(),multiUserChat);
    isInitialized=true;
  }
}
