{
  if (connection == null)   return RegistrationState.UNREGISTERED;
 else   if (connection.isConnected() && connection.isAuthenticated())   return RegistrationState.REGISTERED;
 else   return RegistrationState.UNREGISTERED;
}
