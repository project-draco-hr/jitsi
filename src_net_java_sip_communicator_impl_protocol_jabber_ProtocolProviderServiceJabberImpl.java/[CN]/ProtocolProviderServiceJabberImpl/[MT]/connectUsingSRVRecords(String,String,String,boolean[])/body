{
  SRVRecord srvRecords[]=null;
  try {
    srvRecords=NetworkUtils.getSRVRecords("xmpp-client","tcp",domain);
  }
 catch (  ParseException e) {
    logger.error("SRV record not resolved",e);
  }
catch (  DnssecException e) {
    logger.error("DNSSEC failure for SRV lookup",e);
    dnssecState[0]=true;
  }
  if (srvRecords != null) {
    for (    SRVRecord srv : srvRecords) {
      InetSocketAddress[] addrs=null;
      try {
        addrs=NetworkUtils.getAandAAAARecords(srv.getTarget(),srv.getPort());
      }
 catch (      ParseException e) {
        logger.error("Invalid SRV record target",e);
      }
catch (      DnssecException e) {
        logger.error("DNSSEC failure for A/AAAA lookup of SRV",e);
        dnssecState[0]=true;
      }
      if (addrs == null || addrs.length == 0)       continue;
      for (      InetSocketAddress isa : addrs) {
        try {
          ConnectState state=connectAndLogin(isa,password,serviceName);
          return state;
        }
 catch (        XMPPException ex) {
          disconnectAndCleanConnection();
          if (isAuthenticationFailed(ex))           throw ex;
        }
      }
    }
  }
  return ConnectState.CONTINUE_TRYING;
}
