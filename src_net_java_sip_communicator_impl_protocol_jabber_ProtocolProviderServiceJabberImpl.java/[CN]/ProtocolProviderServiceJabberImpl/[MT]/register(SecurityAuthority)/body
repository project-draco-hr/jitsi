{
  if (authority == null)   throw new IllegalArgumentException("The register method needs a valid non-null authority impl " + " in order to be able and retrieve passwords.");
  this.authority=authority;
  try {
    connectAndLogin(authority);
  }
 catch (  XMPPException ex) {
    logger.error("Error registering",ex);
    int reason=RegistrationStateChangeEvent.REASON_NOT_SPECIFIED;
    if (ex.getWrappedThrowable() instanceof UnknownHostException)     reason=RegistrationStateChangeEvent.REASON_SERVER_NOT_FOUND;
    fireRegistrationStateChanged(getRegistrationState(),RegistrationState.CONNECTION_FAILED,reason,null);
  }
}
