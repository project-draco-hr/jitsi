{
  if (keyStore == null) {
    try {
      keyStore=KeyStore.getInstance(KeyStore.getDefaultType());
synchronized (keyStore) {
        keyStore.load(null,defaultPassword);
        File keyStoreFile=getKeyStoreLocation();
        if (!keyStoreFile.exists()) {
          keyStore.store(new FileOutputStream(keyStoreFile),defaultPassword);
        }
 else {
          keyStore.load(new FileInputStream(keyStoreFile),null);
        }
      }
    }
 catch (    Exception e) {
      logger.error("Cannot init keystore file.",e);
    }
  }
  return keyStore;
}
