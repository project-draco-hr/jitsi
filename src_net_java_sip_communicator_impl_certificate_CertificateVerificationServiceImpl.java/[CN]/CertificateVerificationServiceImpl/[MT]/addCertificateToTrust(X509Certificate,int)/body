{
switch (trustMode) {
case TRUST_ALWAYS:
    try {
      KeyStore kStore=getKeyStore();
synchronized (kStore) {
        kStore.setCertificateEntry(String.valueOf(System.currentTimeMillis()),cert);
        kStore.store(new FileOutputStream(getKeyStoreLocation()),defaultPassword);
      }
    }
 catch (    Exception e) {
      logger.error("cannot add certificate to truststore",e);
    }
  break;
case TRUST_THIS_SESSION_ONLY:
temporalyAllowed.add(cert);
break;
default :
throw new GeneralSecurityException("Cannot add a certificate to truststore " + "when no trust is requested.");
}
}
