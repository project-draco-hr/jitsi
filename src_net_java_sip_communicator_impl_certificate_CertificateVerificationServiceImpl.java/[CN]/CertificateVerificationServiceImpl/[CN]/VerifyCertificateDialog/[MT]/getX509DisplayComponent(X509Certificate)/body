{
  Insets valueInsets=new Insets(2,10,0,0);
  Insets titleInsets=new Insets(10,5,0,0);
  ResourceManagementService resources=CertificateVerificationActivator.getResources();
  TransparentPanel certDisplayPanel=new TransparentPanel(new GridBagLayout());
  int currentRow=0;
  GridBagConstraints constraints=new GridBagConstraints();
  constraints.anchor=GridBagConstraints.WEST;
  constraints.fill=GridBagConstraints.HORIZONTAL;
  constraints.insets=new Insets(2,5,0,0);
  constraints.gridx=0;
  constraints.weightx=0;
  constraints.weighty=0;
  constraints.gridy=currentRow++;
  X500Principal issuer=certificate.getIssuerX500Principal();
  X500Principal subject=certificate.getSubjectX500Principal();
  certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_ISSUED_TO")),constraints);
  constraints.gridy=currentRow++;
  certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_CN")),constraints);
  constraints.gridx=1;
  certDisplayPanel.add(new JLabel(getCertificateValue(subject.getName(),"CN")),constraints);
  constraints.gridy=currentRow++;
  constraints.gridx=0;
  certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_O")),constraints);
  constraints.gridx=1;
  certDisplayPanel.add(new JLabel(getCertificateValue(subject.getName(),"O")),constraints);
  constraints.gridy=currentRow++;
  constraints.gridx=0;
  certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_C")),constraints);
  constraints.gridx=1;
  certDisplayPanel.add(new JLabel(getCertificateValue(subject.getName(),"C")),constraints);
  constraints.gridy=currentRow++;
  constraints.gridx=0;
  certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_ST")),constraints);
  constraints.gridx=1;
  certDisplayPanel.add(new JLabel(getCertificateValue(subject.getName(),"ST")),constraints);
  constraints.gridy=currentRow++;
  constraints.gridx=0;
  certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_L")),constraints);
  constraints.gridx=1;
  certDisplayPanel.add(new JLabel(getCertificateValue(subject.getName(),"L")),constraints);
  constraints.gridy=currentRow++;
  constraints.gridx=0;
  constraints.insets=titleInsets;
  certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_ISSUED_BY")),constraints);
  constraints.insets=valueInsets;
  constraints.gridy=currentRow++;
  constraints.gridx=0;
  certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_C")),constraints);
  constraints.gridx=1;
  certDisplayPanel.add(new JLabel(getCertificateValue(issuer.getName(),"C")),constraints);
  constraints.gridy=currentRow++;
  constraints.gridx=0;
  certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_O")),constraints);
  constraints.gridx=1;
  certDisplayPanel.add(new JLabel(getCertificateValue(issuer.getName(),"O")),constraints);
  constraints.gridy=currentRow++;
  constraints.gridx=0;
  certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_OU")),constraints);
  constraints.gridx=1;
  certDisplayPanel.add(new JLabel(getCertificateValue(issuer.getName(),"OU")),constraints);
  constraints.gridy=currentRow++;
  constraints.gridx=0;
  constraints.insets=titleInsets;
  certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_VALIDITY")),constraints);
  constraints.insets=valueInsets;
  constraints.gridy=currentRow++;
  constraints.gridx=0;
  certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_ISSUED_ON")),constraints);
  constraints.gridx=1;
  certDisplayPanel.add(new JLabel(dateFormatter.format(certificate.getNotBefore())),constraints);
  constraints.gridy=currentRow++;
  constraints.gridx=0;
  certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_EXPIRES_ON")),constraints);
  constraints.gridx=1;
  certDisplayPanel.add(new JLabel(dateFormatter.format(certificate.getNotAfter())),constraints);
  constraints.gridy=currentRow++;
  constraints.gridx=0;
  constraints.insets=titleInsets;
  certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_FINGERPRINTS")),constraints);
  constraints.insets=valueInsets;
  try {
    MessageDigest md=MessageDigest.getInstance("SHA1");
    md.update(certificate.getEncoded());
    String sha1String=getHex(md.digest());
    md=MessageDigest.getInstance("MD5");
    md.update(certificate.getEncoded());
    String md5String=getHex(md.digest());
    JTextArea sha1Area=new JTextArea(sha1String);
    sha1Area.setLineWrap(false);
    sha1Area.setOpaque(false);
    sha1Area.setWrapStyleWord(true);
    sha1Area.setEditable(false);
    constraints.gridy=currentRow++;
    constraints.gridx=0;
    certDisplayPanel.add(new JLabel("SHA1:"),constraints);
    constraints.gridx=1;
    certDisplayPanel.add(sha1Area,constraints);
    constraints.gridy=currentRow++;
    constraints.gridx=0;
    certDisplayPanel.add(new JLabel("MD5:"),constraints);
    JTextArea md5Area=new JTextArea(md5String);
    md5Area.setLineWrap(false);
    md5Area.setOpaque(false);
    md5Area.setWrapStyleWord(true);
    md5Area.setEditable(false);
    constraints.gridx=1;
    certDisplayPanel.add(md5Area,constraints);
  }
 catch (  Exception e) {
    logger.warn("Error in certificate, cannot show fingerprints",e);
  }
  constraints.gridy=currentRow++;
  constraints.gridx=0;
  constraints.insets=titleInsets;
  certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_CERT_DETAILS")),constraints);
  constraints.insets=valueInsets;
  constraints.gridy=currentRow++;
  constraints.gridx=0;
  certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_SER_NUM")),constraints);
  constraints.gridx=1;
  certDisplayPanel.add(new JLabel(certificate.getSerialNumber().toString()),constraints);
  constraints.gridy=currentRow++;
  constraints.gridx=0;
  certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_VER")),constraints);
  constraints.gridx=1;
  certDisplayPanel.add(new JLabel(String.valueOf(certificate.getVersion())),constraints);
  constraints.gridy=currentRow++;
  constraints.gridx=0;
  certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_SIGN_ALG")),constraints);
  constraints.gridx=1;
  certDisplayPanel.add(new JLabel(String.valueOf(certificate.getSigAlgName())),constraints);
  constraints.gridy=currentRow++;
  constraints.gridx=0;
  constraints.insets=titleInsets;
  certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_PUB_KEY_INFO")),constraints);
  constraints.insets=valueInsets;
  constraints.gridy=currentRow++;
  constraints.gridx=0;
  certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_ALG")),constraints);
  constraints.gridx=1;
  certDisplayPanel.add(new JLabel(certificate.getPublicKey().getAlgorithm()),constraints);
  if (certificate.getPublicKey().getAlgorithm().equals("RSA")) {
    RSAPublicKey key=(RSAPublicKey)certificate.getPublicKey();
    constraints.gridy=currentRow++;
    constraints.gridx=0;
    certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_PUB_KEY")),constraints);
    JTextArea pubkeyArea=new JTextArea(resources.getI18NString("service.gui.CERT_INFO_KEY_BYTES_PRINT",new String[]{String.valueOf(key.getModulus().toByteArray().length - 1),key.getModulus().toString(16)}));
    pubkeyArea.setLineWrap(false);
    pubkeyArea.setOpaque(false);
    pubkeyArea.setWrapStyleWord(true);
    pubkeyArea.setEditable(false);
    constraints.gridx=1;
    certDisplayPanel.add(pubkeyArea,constraints);
    constraints.gridy=currentRow++;
    constraints.gridx=0;
    certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_EXP")),constraints);
    constraints.gridx=1;
    certDisplayPanel.add(new JLabel(key.getPublicExponent().toString()),constraints);
    constraints.gridy=currentRow++;
    constraints.gridx=0;
    certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_KEY_SIZE")),constraints);
    constraints.gridx=1;
    certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_KEY_BITS_PRINT",new String[]{String.valueOf(key.getModulus().bitLength())})),constraints);
  }
 else   if (certificate.getPublicKey().getAlgorithm().equals("DSA")) {
    DSAPublicKey key=(DSAPublicKey)certificate.getPublicKey();
    constraints.gridy=currentRow++;
    constraints.gridx=0;
    certDisplayPanel.add(new JLabel("Y:"),constraints);
    JTextArea yArea=new JTextArea(key.getY().toString(16));
    yArea.setLineWrap(false);
    yArea.setOpaque(false);
    yArea.setWrapStyleWord(true);
    yArea.setEditable(false);
    constraints.gridx=1;
    certDisplayPanel.add(yArea,constraints);
  }
  constraints.gridy=currentRow++;
  constraints.gridx=0;
  certDisplayPanel.add(new JLabel(resources.getI18NString("service.gui.CERT_INFO_SIGN")),constraints);
  JTextArea signArea=new JTextArea(resources.getI18NString("service.gui.CERT_INFO_KEY_BYTES_PRINT",new String[]{String.valueOf(certificate.getSignature().length),getHex(certificate.getSignature())}));
  signArea.setLineWrap(false);
  signArea.setOpaque(false);
  signArea.setWrapStyleWord(true);
  signArea.setEditable(false);
  constraints.gridx=1;
  certDisplayPanel.add(signArea,constraints);
  return certDisplayPanel;
}
