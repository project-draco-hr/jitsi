{
  ContactGroup rootProtoGroup=presenceOpSet.getServerStoredContactListRoot();
  logger.trace("subgroups: " + rootProtoGroup.countSubGroups());
  logger.trace("child contacts: " + rootProtoGroup.countContacts());
  rootMetaGroup.addProtoGroup(provider,presenceOpSet.getServerStoredContactListRoot());
  Iterator subgroupsIter=rootProtoGroup.subGroups();
  while (subgroupsIter.hasNext()) {
    ContactGroup group=(ContactGroup)subgroupsIter.next();
    MetaContactGroupImpl newMetaGroup=new MetaContactGroupImpl(group.getGroupName());
    newMetaGroup.addProtoGroup(provider,group);
    Iterator contactsIter=group.contacts();
    while (contactsIter.hasNext()) {
      Contact contact=(Contact)contactsIter.next();
      MetaContactImpl newMetaContact=new MetaContactImpl();
      newMetaContact.addProtoContact(contact);
      newMetaContact.setDisplayName(contact.getDisplayName());
      newMetaGroup.addMetaContact(newMetaContact);
    }
    rootMetaGroup.addSubgroup(newMetaGroup);
    this.fireMetaContactGroupEvent(newMetaGroup,provider,MetaContactEvent.METACONTACT_ADDED);
  }
  Iterator contactsIter=rootProtoGroup.contacts();
  while (contactsIter.hasNext()) {
    Contact contact=(Contact)contactsIter.next();
    MetaContactImpl newMetaContact=new MetaContactImpl();
    newMetaContact.addProtoContact(contact);
    newMetaContact.setDisplayName(contact.getDisplayName());
    rootMetaGroup.addMetaContact(newMetaContact);
    this.fireMetaContactEvent(newMetaContact,provider,rootMetaGroup,MetaContactEvent.METACONTACT_ADDED);
  }
  presenceOpSet.addSubsciptionListener(new ContactListSubscriptionListener());
  presenceOpSet.addServerStoredGroupChangeListener(new ContactListGroupListener());
}
