{
  logger.debug("Removing protocol provider " + provider.getProtocolName());
  this.currentlyInstalledProviders.remove(provider.getAccountID().getAccountUniqueID());
  OperationSetPersistentPresence persPresOpSet=(OperationSetPersistentPresence)provider.getOperationSet(OperationSetPersistentPresence.class);
  if (persPresOpSet == null)   return;
  ContactGroup rootGroup=persPresOpSet.getServerStoredContactListRoot();
  Iterator subgroups=rootGroup.subgroups();
  while (subgroups.hasNext()) {
    ContactGroup group=(ContactGroup)subgroups.next();
    this.removeContactGroupFromMetaContactGroup(this.rootMetaGroup,group,provider);
  }
  this.removeContactGroupFromMetaContactGroup(this.rootMetaGroup,rootGroup,provider);
}
