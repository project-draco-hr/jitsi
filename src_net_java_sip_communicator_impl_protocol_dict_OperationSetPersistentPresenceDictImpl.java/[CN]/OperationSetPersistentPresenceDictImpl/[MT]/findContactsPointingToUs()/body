{
  List contacts=new LinkedList();
  BundleContext bc=DictActivator.getBundleContext();
  String osgiQuery="(" + ProtocolProviderFactory.PROTOCOL + "=Dict)";
  ServiceReference[] refs=null;
  try {
    refs=bc.getServiceReferences(ProtocolProviderService.class.getName(),osgiQuery);
  }
 catch (  InvalidSyntaxException ex) {
    logger.error("Failed to execute the following osgi query: " + osgiQuery,ex);
  }
  for (int i=0; refs != null && i < refs.length; i++) {
    ProtocolProviderServiceDictImpl gibProvider=(ProtocolProviderServiceDictImpl)bc.getService(refs[i]);
    OperationSetPersistentPresenceDictImpl opSetPersPresence=(OperationSetPersistentPresenceDictImpl)gibProvider.getOperationSet(OperationSetPersistentPresence.class);
    Contact contact=opSetPersPresence.findContactByID(parentProvider.getAccountID().getUserID());
    if (contact != null)     contacts.add(contact);
  }
  return contacts;
}
