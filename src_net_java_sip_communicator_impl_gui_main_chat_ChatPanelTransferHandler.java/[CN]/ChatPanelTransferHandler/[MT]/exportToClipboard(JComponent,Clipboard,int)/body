{
  if (comp instanceof JTextComponent) {
    JTextComponent textComponent=(JTextComponent)comp;
    int startIndex=textComponent.getSelectionStart();
    int endIndex=textComponent.getSelectionEnd();
    if (startIndex != endIndex) {
      try {
        Document doc=textComponent.getDocument();
        String srcData=doc.getText(startIndex,endIndex - startIndex);
        StringSelection contents=new StringSelection(srcData);
        clipboard.setContents(contents,null);
        if (action == TransferHandler.MOVE) {
          doc.remove(startIndex,endIndex - startIndex);
        }
      }
 catch (      BadLocationException ble) {
      }
    }
  }
}
