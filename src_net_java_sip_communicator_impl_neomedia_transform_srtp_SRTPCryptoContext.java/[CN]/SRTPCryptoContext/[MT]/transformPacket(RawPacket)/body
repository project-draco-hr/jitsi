{
  if (policy.getEncType() == SRTPPolicy.AESCM_ENCRYPTION || policy.getEncType() == SRTPPolicy.TWOFISH_ENCRYPTION) {
    processPacketAESCM(pkt);
  }
 else   if (policy.getEncType() == SRTPPolicy.AESF8_ENCRYPTION || policy.getEncType() == SRTPPolicy.TWOFISHF8_ENCRYPTION) {
    processPacketAESF8(pkt);
  }
  if (policy.getAuthType() != SRTPPolicy.NULL_AUTHENTICATION) {
    authenticatePacketHMCSHA1(pkt,roc);
    pkt.append(tagStore,policy.getAuthTagLength());
  }
  int seqNo=pkt.getSequenceNumber();
  if (seqNo == 0xFFFF) {
    roc++;
  }
}
