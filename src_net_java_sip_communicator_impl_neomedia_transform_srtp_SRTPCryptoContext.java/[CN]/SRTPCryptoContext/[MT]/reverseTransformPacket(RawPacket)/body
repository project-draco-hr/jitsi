{
  int seqNo=pkt.getSequenceNumber();
  if (!seqNumSet) {
    seqNumSet=true;
    seqNum=seqNo;
  }
  long guessedIndex=guessIndex(seqNo);
  if (!checkReplay(seqNo,guessedIndex)) {
    return false;
  }
  if (policy.getAuthType() != SRTPPolicy.NULL_AUTHENTICATION) {
    int tagLength=policy.getAuthTagLength();
    pkt.readRegionToBuff(pkt.getLength() - tagLength,tagLength,tempStore);
    pkt.shrink(tagLength);
    authenticatePacketHMCSHA1(pkt,guessedROC);
    for (int i=0; i < tagLength; i++) {
      if ((tempStore[i] & 0xff) == (tagStore[i] & 0xff))       continue;
 else       return false;
    }
  }
  if (policy.getEncType() == SRTPPolicy.AESCM_ENCRYPTION || policy.getEncType() == SRTPPolicy.TWOFISH_ENCRYPTION) {
    processPacketAESCM(pkt);
  }
 else   if (policy.getEncType() == SRTPPolicy.AESF8_ENCRYPTION || policy.getEncType() == SRTPPolicy.TWOFISHF8_ENCRYPTION) {
    processPacketAESF8(pkt);
  }
  update(seqNo,guessedIndex);
  return true;
}
