{
  long label=0;
  computeIv(label,index);
  KeyParameter encryptionKey=new KeyParameter(masterKey);
  cipher.init(true,encryptionKey);
  Arrays.fill(masterKey,(byte)0);
  cipherCtr.getCipherStream(cipher,encKey,policy.getEncKeyLength(),ivStore);
  if (authKey != null) {
    label=0x01;
    computeIv(label,index);
    cipherCtr.getCipherStream(cipher,authKey,policy.getAuthKeyLength(),ivStore);
switch ((policy.getAuthType())) {
case SRTPPolicy.HMACSHA1_AUTHENTICATION:
      KeyParameter key=new KeyParameter(authKey);
    mac.init(key);
  break;
case SRTPPolicy.SKEIN_AUTHENTICATION:
ParametersForSkein pfs=new ParametersForSkein(new KeyParameter(authKey),ParametersForSkein.Skein512,tagStore.length * 8);
mac.init(pfs);
break;
}
}
Arrays.fill(authKey,(byte)0);
label=0x02;
computeIv(label,index);
cipherCtr.getCipherStream(cipher,saltKey,policy.getSaltKeyLength(),ivStore);
Arrays.fill(masterSalt,(byte)0);
if (cipherF8 != null) SRTPCipherF8.deriveForIV(cipherF8,encKey,saltKey);
encryptionKey=new KeyParameter(encKey);
cipher.init(true,encryptionKey);
Arrays.fill(encKey,(byte)0);
}
