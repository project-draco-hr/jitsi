{
  ssrc=ssrcIn;
  mki=null;
  roc=rocIn;
  guessedROC=0;
  seqNum=0;
  keyDerivationRate=kdr;
  seqNumSet=false;
  policy=policyIn;
  masterKey=new byte[policy.getEncKeyLength()];
  System.arraycopy(masterK,0,masterKey,0,policy.getEncKeyLength());
  masterSalt=new byte[policy.getSaltKeyLength()];
  System.arraycopy(masterS,0,masterSalt,0,policy.getSaltKeyLength());
  mac=new HMac(new SHA1Digest());
switch (policy.getEncType()) {
case SRTPPolicy.NULL_ENCRYPTION:
    encKey=null;
  saltKey=null;
break;
case SRTPPolicy.AESCM_ENCRYPTION:
cipher=new AESFastEngine();
encKey=new byte[policy.getEncKeyLength()];
saltKey=new byte[policy.getSaltKeyLength()];
case SRTPPolicy.AESF8_ENCRYPTION:
cipherF8=new AESFastEngine();
break;
case SRTPPolicy.TWOFISH_ENCRYPTION:
cipher=new TwofishEngine();
encKey=new byte[this.policy.getEncKeyLength()];
saltKey=new byte[this.policy.getSaltKeyLength()];
case SRTPPolicy.TWOFISHF8_ENCRYPTION:
cipherF8=new TwofishEngine();
break;
}
switch (policy.getAuthType()) {
case SRTPPolicy.NULL_AUTHENTICATION:
authKey=null;
tagStore=null;
break;
case SRTPPolicy.HMACSHA1_AUTHENTICATION:
mac=new HMac(new SHA1Digest());
authKey=new byte[policy.getAuthKeyLength()];
tagStore=new byte[mac.getMacSize()];
break;
case SRTPPolicy.SKEIN_AUTHENTICATION:
mac=new SkeinMac();
authKey=new byte[policy.getAuthKeyLength()];
tagStore=new byte[policy.getAuthTagLength()];
break;
default :
tagStore=null;
}
}
