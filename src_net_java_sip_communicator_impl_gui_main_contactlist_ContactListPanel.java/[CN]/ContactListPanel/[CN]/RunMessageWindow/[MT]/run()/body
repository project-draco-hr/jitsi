{
  PresenceStatus contactStatus=((ContactListModel)contactList.getModel()).getMetaContactStatus(this.contactItem);
  if (!Constants.TABBED_CHAT_WINDOW) {
    if (contactMsgWindows.containsKey(this.contactItem)) {
      ChatWindow msgWindow=(ChatWindow)contactMsgWindows.get(this.contactItem);
      if (msgWindow.getExtendedState() == JFrame.ICONIFIED)       msgWindow.setExtendedState(JFrame.NORMAL);
      msgWindow.setVisible(true);
    }
 else {
      ChatWindow msgWindow=new ChatWindow(mainFrame);
      contactMsgWindows.put(this.contactItem,msgWindow);
      msgWindow.addChat(this.contactItem,contactStatus);
      msgWindow.pack();
      msgWindow.setVisible(true);
      msgWindow.getWriteMessagePanel().getEditorPane().requestFocus();
    }
  }
 else {
    if (tabbedChatWindow == null) {
      tabbedChatWindow=new ChatWindow(mainFrame);
      tabbedChatWindow.addWindowListener(new WindowAdapter(){
        public void windowClosing(        WindowEvent e){
          tabbedChatWindow=null;
        }
      }
);
    }
    Hashtable contactTabsTable=tabbedChatWindow.getContactTabsTable();
    if (contactTabsTable.get(this.contactItem.getDisplayName()) == null) {
      tabbedChatWindow.addChatTab(this.contactItem,contactStatus);
      if (tabbedChatWindow.getTabCount() > 1)       tabbedChatWindow.setSelectedContactTab(this.contactItem);
      if (tabbedChatWindow.getExtendedState() == JFrame.ICONIFIED)       tabbedChatWindow.setExtendedState(JFrame.NORMAL);
      if (!tabbedChatWindow.isVisible())       tabbedChatWindow.setVisible(true);
      tabbedChatWindow.getWriteMessagePanel().getEditorPane().requestFocus();
    }
 else {
      if (tabbedChatWindow.getTabCount() > 1) {
        tabbedChatWindow.setSelectedContactTab(this.contactItem);
      }
      if (tabbedChatWindow.getExtendedState() == JFrame.ICONIFIED)       tabbedChatWindow.setExtendedState(JFrame.NORMAL);
      tabbedChatWindow.setVisible(true);
      tabbedChatWindow.getWriteMessagePanel().getEditorPane().requestFocus();
    }
  }
}
