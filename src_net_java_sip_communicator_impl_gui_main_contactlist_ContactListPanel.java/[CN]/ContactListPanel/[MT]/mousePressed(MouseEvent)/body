{
  if ((e.getModifiers() & InputEvent.BUTTON2_MASK) != 0 || (e.getModifiers() & InputEvent.BUTTON3_MASK) != 0) {
    this.contactList.setSelectedIndex(contactList.locationToIndex(e.getPoint()));
  }
  int selectedIndex=this.contactList.getSelectedIndex();
  Object selectedValue=this.contactList.getSelectedValue();
  ContactListCellRenderer renderer=(ContactListCellRenderer)this.contactList.getCellRenderer().getListCellRendererComponent(this.contactList,selectedValue,selectedIndex,true,true);
  Point selectedCellPoint=this.contactList.indexToLocation(selectedIndex);
  int translatedX=e.getX() - selectedCellPoint.x;
  int translatedY=e.getY() - selectedCellPoint.y;
  if (selectedValue instanceof MetaContactGroup) {
    MetaContactGroup group=(MetaContactGroup)selectedValue;
    if ((e.getModifiers() & InputEvent.BUTTON3_MASK) != 0) {
      GroupRightButtonMenu popupMenu=new GroupRightButtonMenu(mainFrame,group);
      SwingUtilities.convertPointToScreen(selectedCellPoint,renderer);
      popupMenu.setInvoker(this.contactList);
      popupMenu.setLocation(selectedCellPoint.x,selectedCellPoint.y + renderer.getHeight());
      popupMenu.setVisible(true);
    }
  }
  if (selectedValue instanceof MetaContact) {
    MetaContact contact=(MetaContact)selectedValue;
    Component component=renderer.getComponentAt(translatedX,translatedY);
    if (component instanceof JLabel) {
      if ((e.getModifiers() & InputEvent.BUTTON1_MASK) != 0) {
        SwingUtilities.invokeLater(new RunMessageWindow(contact));
      }
 else       if ((e.getModifiers() & InputEvent.BUTTON3_MASK) != 0) {
        ContactRightButtonMenu popupMenu=new ContactRightButtonMenu(mainFrame,contact);
        SwingUtilities.convertPointToScreen(selectedCellPoint,renderer);
        popupMenu.setInvoker(this.contactList);
        popupMenu.setLocation(selectedCellPoint.x,selectedCellPoint.y + renderer.getHeight());
        popupMenu.setVisible(true);
      }
    }
 else     if (component instanceof JButton) {
      SwingUtilities.invokeLater(new RunInfoWindow(selectedCellPoint,contact));
    }
 else     if (component instanceof JPanel && component.getName().equals("buttonsPanel")) {
      JPanel panel=(JPanel)component;
      int internalX=translatedX - (renderer.getWidth() - panel.getWidth() - 2);
      int internalY=translatedY - (renderer.getHeight() - panel.getHeight());
      Component c=panel.getComponentAt(4,4);
      if (c instanceof ContactProtocolButton) {
        SwingUtilities.invokeLater(new RunMessageWindow(contact,((ContactProtocolButton)c).getProtocolContact()));
      }
    }
  }
}
