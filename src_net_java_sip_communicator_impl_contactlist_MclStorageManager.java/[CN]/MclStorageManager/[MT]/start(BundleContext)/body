{
  bundleContext=bc;
  ServiceReference faServiceReference=bundleContext.getServiceReference(FileAccessService.class.getName());
  faService=(FileAccessService)bundleContext.getService(faServiceReference);
  ServiceReference confServiceRefs=bundleContext.getServiceReference(ConfigurationService.class.getName());
  configurationService=(ConfigurationService)bundleContext.getService(confServiceRefs);
  String fileName=configurationService.getString(FILE_NAME_PROPERTY);
  if (fileName == null)   fileName=DEFAULT_FILE_NAME;
  try {
    contactlistFile=faService.getPrivatePersistentFile(fileName);
  }
 catch (  Exception ex) {
    logger.error("Failed to get a reference to the contact list file.",ex);
    return;
  }
  try {
    DocumentBuilderFactory factory=DocumentBuilderFactory.newInstance();
    DocumentBuilder builder=factory.newDocumentBuilder();
    contactListDocument=builder.parse(contactlistFile);
  }
 catch (  SAXException ex) {
    logger.error("Error parsing configuration file",ex);
    throw new XMLException(ex.getMessage(),ex);
  }
catch (  ParserConfigurationException ex) {
    logger.error("Error finding configuration for default parsers",ex);
  }
}
