{
  if (!isGroupChatMessage(switchboard))   return;
  try {
    AdHocChatRoomMsnImpl chatRoom=getLocalAdHocChatRoomInstance(switchboard);
    if (chatRoom == null) {
      chatRoom=createLocalAdHocChatRoomInstance(switchboard);
    }
    OperationSetPersistentPresenceMsnImpl presenceOpSet=(OperationSetPersistentPresenceMsnImpl)provider.getOperationSet(OperationSetPersistentPresence.class);
    ContactMsnImpl contact=presenceOpSet.getServerStoredContactList().findContactById(msnContact.getEmail().getEmailAddress());
    if (contact == null)     contact=new ContactMsnImpl(msnContact,presenceOpSet.getServerStoredContactList(),false,false);
    chatRoom.addAdHocChatRoomParticipant(msnContact.getId(),contact);
  }
 catch (  Exception e) {
    logger.error("Failed to join switchboard.",e);
  }
}
