{
  Object attachment=switchboard.getAttachment();
  try {
    AdHocChatRoomMsnImpl adHocChatRoom=null;
    if (attachment == null)     adHocChatRoom=(AdHocChatRoomMsnImpl)findRoom(switchboard);
    if (attachment != null && userCreatedAdHocChatRoomList.containsKey(attachment))     adHocChatRoom=(AdHocChatRoomMsnImpl)userCreatedAdHocChatRoomList.get(attachment);
    if (adHocChatRoom == null)     return;
    adHocChatRoom.setSwitchboard(null);
    adHocChatRoom.leave();
    fireLocalUserPresenceEvent(adHocChatRoom,LocalUserChatRoomPresenceChangeEvent.LOCAL_USER_DROPPED,"Switchboard closed.");
  }
 catch (  Exception e) {
  }
}
