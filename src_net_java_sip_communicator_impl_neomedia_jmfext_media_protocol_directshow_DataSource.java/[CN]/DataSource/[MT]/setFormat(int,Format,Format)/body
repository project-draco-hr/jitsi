{
  if (newValue instanceof VideoFormat) {
    VideoFormat newVideoFormatValue=(VideoFormat)newValue;
    Dimension newSize=newVideoFormatValue.getSize();
    if ((newSize != null) && (newSize.width < DEFAULT_WIDTH) && (newSize.height < DEFAULT_HEIGHT)) {
      String encoding=newVideoFormatValue.getEncoding();
      Class<?> dataType=newVideoFormatValue.getDataType();
      float frameRate=newVideoFormatValue.getFrameRate();
      newSize=new Dimension(DEFAULT_WIDTH,DEFAULT_HEIGHT);
      newValue=((Format)newVideoFormatValue.clone()).relax().intersects(new VideoFormat(encoding,newSize,Format.NOT_SPECIFIED,dataType,frameRate));
    }
    if (newValue instanceof AVFrameFormat) {
      AVFrameFormat f=(AVFrameFormat)newValue;
      int colorSpace=DSFormat.UNKNOWN;
      int pixFmt=f.getPixFmt();
      if (pixFmt == FFmpeg.PIX_FMT_ARGB) {
        colorSpace=DSFormat.ARGB32;
      }
 else       if (pixFmt == FFmpeg.PIX_FMT_RGB32) {
        colorSpace=DSFormat.RGB32;
      }
 else       if (pixFmt == FFmpeg.PIX_FMT_RGB24) {
        colorSpace=DSFormat.RGB24;
      }
 else {
      }
      DSFormat fmt=new DSFormat(newSize.width,newSize.height,colorSpace);
      device.setFormat(fmt);
    }
    return newValue;
  }
 else {
    return super.setFormat(streamIndex,oldValue,newValue);
  }
}
