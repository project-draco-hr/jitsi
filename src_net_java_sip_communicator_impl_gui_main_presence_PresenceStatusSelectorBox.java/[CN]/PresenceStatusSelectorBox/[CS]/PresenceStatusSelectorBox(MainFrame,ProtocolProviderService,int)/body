{
  this.mainFrame=mainFrame;
  this.protocolProvider=protocolProvider;
  this.accountIndex=accountIndex;
  this.setPreferredSize(new Dimension(28,24));
  this.presence=mainFrame.getProtocolPresenceOpSet(protocolProvider);
  this.statusIterator=this.presence.getSupportedStatusSet();
  String tooltip="<html><b>" + protocolProvider.getAccountID().getUserID() + "</b><br>Connecting</html>";
  this.setToolTipText(tooltip);
  titleLabel=new JLabel(protocolProvider.getAccountID().getUserID());
  titleLabel.setBorder(BorderFactory.createEmptyBorder(0,5,0,0));
  titleLabel.setFont(Constants.FONT.deriveFont(Font.BOLD));
  this.add(titleLabel);
  this.addSeparator();
  while (statusIterator.hasNext()) {
    PresenceStatus status=(PresenceStatus)statusIterator.next();
    int connectivity=status.getStatus();
    if (connectivity < 1) {
      this.offlineStatus=status;
    }
 else     if ((onlineStatus != null && (onlineStatus.getStatus() < connectivity)) || (onlineStatus == null && (connectivity > 50 && connectivity < 80))) {
      this.onlineStatus=status;
    }
    this.addItem(status.getStatusName(),new ImageIcon(ImageLoader.getBytesInImage(status.getStatusIcon())),new ItemActionListener());
  }
  this.addSeparator();
  this.add(new StatusMessageMenu(protocolProvider));
  this.setSelectedStatus(offlineStatus);
}
