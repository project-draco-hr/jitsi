{
  if (e.getSource() instanceof JMenuItem) {
    JMenuItem menuItem=(JMenuItem)e.getSource();
    LoginManager loginManager=mainFrame.getLoginManager();
    Iterator statusSet=presence.getSupportedStatusSet();
    while (statusSet.hasNext()) {
      PresenceStatus status=((PresenceStatus)statusSet.next());
      if (status.getStatusName().equals(menuItem.getText()) && !presence.getPresenceStatus().equals(status)) {
        if (protocolProvider.isRegistered()) {
          if (status.isOnline()) {
            new PublishPresenceStatusThread(status).start();
          }
 else {
            loginManager.setManuallyDisconnected(true);
            loginManager.logoff(protocolProvider);
          }
          setSelectedStatus(status);
        }
 else {
          lastSelectedStatus=status;
          loginManager.login(protocolProvider);
        }
        mainFrame.saveStatusInformation(protocolProvider,status);
        break;
      }
    }
  }
}
