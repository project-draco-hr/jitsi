{
  String processedMessage=this.conversationPanel.processMessage(chatMessage,chatSession.getCurrentChatTransport().getProtocolProvider(),chatSession.getCurrentChatTransport().getName());
  if (chatSession instanceof ConferenceChatSession) {
    if (chatMessage.getMessageType().equals(Chat.INCOMING_MESSAGE)) {
      String keyWord=((ChatRoomWrapper)chatSession.getDescriptor()).getChatRoom().getUserNickname();
      try {
        processedMessage=this.conversationPanel.processChatRoomHighlight(processedMessage,chatMessage.getContentType(),keyWord);
      }
 catch (      Throwable t) {
        logger.error("Error processing highlight",t);
      }
    }
    String meCommandMsg=this.conversationPanel.processMeCommand(chatMessage);
    if (meCommandMsg.length() > 0)     processedMessage=meCommandMsg;
  }
  this.conversationPanel.appendMessageToEnd(processedMessage,chatMessage.getContentType());
}
