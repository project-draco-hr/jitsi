{
  Component component=e.getComponent();
  Container parent=component.getParent();
  if (!(parent instanceof JTabbedPane))   return;
  JTabbedPane tabbedPane=(JTabbedPane)parent;
  if (tabbedPane.getSelectedComponent() != component)   return;
  SwingUtilities.invokeLater(new Runnable(){
    public void run(){
      String chatName=getChatName();
      if (!getChatWindow().getTitle().equals(chatName)) {
        getChatWindow().setTitle(chatName);
        getChatWindow().getMainToolBar().changeHistoryButtonsState(ChatPanel.this);
      }
      ChatPanel.this.requestFocusInWriteArea();
    }
  }
);
}
