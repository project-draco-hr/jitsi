{
  if (context == null) {
    throw new IllegalArgumentException("context cannot be null");
  }
  this.context=context;
  if (irc == null) {
    throw new IllegalArgumentException("irc instance cannot be null");
  }
  this.irc=irc;
  this.connectionListener=connectionListener;
  this.irc.addListener(new ServerListener());
  this.connectionState=connectSynchronized(this.context.provider,params,this.irc);
  this.identity=new IdentityManager(this.irc,this.connectionState);
  this.message=new MessageManager(this,this.irc,this.connectionState,this.context.provider,this.identity);
  this.channel=new ChannelManager(this.irc,this.connectionState,this.context.provider);
  this.presence=new PresenceManager(this.irc,this.connectionState,this.context.provider.getPersistentPresence(),this.context.nickWatchList);
  this.channelLister=new ServerChannelLister(this.irc,this.connectionState);
}
