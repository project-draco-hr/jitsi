{
  try {
    String globalConnectionAddress=null;
    if (globalConnParam != null)     globalConnectionAddress=globalConnParam.getAddress();
    for (    MediaDescription mediaDescription : mediaDescriptions) {
      int port=mediaDescription.getMedia().getMediaPort();
      String type=mediaDescription.getMedia().getMediaType();
      String address;
      if (globalConnectionAddress != null) {
        address=globalConnectionAddress;
      }
 else {
        address=mediaDescription.getConnection().getAddress();
      }
      Connection mediaLevelConnection=mediaDescription.getConnection();
      if (mediaLevelConnection != null) {
        address=mediaLevelConnection.getAddress();
      }
      InetAddress inetAddress=null;
      try {
        inetAddress=NetworkUtils.getInetAddress(address);
      }
 catch (      UnknownHostException exc) {
        throw new MediaException("Failed to resolve address " + address,MediaException.NETWORK_ERROR,exc);
      }
      SessionAddress target=new SessionAddress(inetAddress,port);
      RTPManager rtpManager=type.equals("video") ? getVideoRtpManager() : getAudioRtpManager();
      try {
        if (selectedKeyProviderAlgorithm != null) {
          TransformConnector transConnector=this.transConnectors.get(rtpManager);
          transConnector.removeTargets();
          transConnector.addTarget(target);
        }
 else {
          rtpManager.removeTargets("Session ended.");
          rtpManager.addTarget(target);
        }
        if (logger.isTraceEnabled())         logger.trace("added target " + target + " for type "+ type);
      }
 catch (      Throwable exc) {
        throw new MediaException("Failed to add RTPManager target.",MediaException.INTERNAL_ERROR,exc);
      }
    }
  }
 catch (  SdpParseException exc) {
    throw new ParseException("Failed to parse SDP data. Error on line " + exc.getLineNumber() + " "+ exc.getMessage(),exc.getCharOffset());
  }
}
