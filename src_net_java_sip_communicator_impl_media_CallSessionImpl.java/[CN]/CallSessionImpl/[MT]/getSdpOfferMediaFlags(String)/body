{
  SessionDescription description=null;
  try {
    description=mediaServCallback.getSdpFactory().createSessionDescription(sdpOffer);
  }
 catch (  SdpParseException ex) {
    throw new MediaException("Failed to parse SDP offer.",MediaException.INTERNAL_ERROR,ex);
  }
  Vector<MediaDescription> mediaDescriptions=null;
  try {
    mediaDescriptions=description.getMediaDescriptions(true);
  }
 catch (  SdpException ex) {
    throw new MediaException("Failed to get media descriptions from SDP offer.",MediaException.INTERNAL_ERROR,ex);
  }
  int mediaFlags=0;
  boolean isOfferToHold=true;
  for (Iterator<MediaDescription> mediaDescriptionIter=mediaDescriptions.iterator(); mediaDescriptionIter.hasNext() && isOfferToHold; ) {
    MediaDescription mediaDescription=mediaDescriptionIter.next();
    Collection<Attribute> attributes=mediaDescription.getAttributes(false);
    isOfferToHold=false;
    if (attributes != null) {
      for (Iterator<Attribute> attributeIter=attributes.iterator(); attributeIter.hasNext() && !isOfferToHold; ) {
        try {
          String attribute=attributeIter.next().getName();
          if ("sendonly".equalsIgnoreCase(attribute) || "inactive".equalsIgnoreCase(attribute))           isOfferToHold=true;
        }
 catch (        SdpParseException ex) {
          throw new MediaException("Failed to get SDP media description attribute name",MediaException.INTERNAL_ERROR,ex);
        }
      }
    }
  }
  if (isOfferToHold)   mediaFlags|=ON_HOLD_REMOTELY;
  for (  MediaDescription mediaDescription : mediaDescriptions) {
    String mediaType;
    try {
      mediaType=mediaDescription.getMedia().getMediaType();
    }
 catch (    SdpParseException ex) {
      throw new MediaException("Failed to determine SDP description media type",MediaException.INTERNAL_ERROR,ex);
    }
    int mediaFlag=0;
    if ("audio".equalsIgnoreCase(mediaType))     mediaFlag=RECEIVE_AUDIO;
 else     if ("video".equalsIgnoreCase(mediaType))     mediaFlag=RECEIVE_VIDEO;
    mediaFlags|=mediaFlag;
    Collection<Attribute> attributes=mediaDescription.getAttributes(false);
    if (attributes != null)     for (    Attribute attribute : attributes) {
      try {
        String name=attribute.getName();
        if ("recvonly".equalsIgnoreCase(name) || "inactive".equalsIgnoreCase(name))         mediaFlags&=~mediaFlag;
      }
 catch (      SdpParseException ex) {
        throw new MediaException("Failed to get SDP media description attribute name",MediaException.INTERNAL_ERROR,ex);
      }
    }
  }
  return mediaFlags;
}
