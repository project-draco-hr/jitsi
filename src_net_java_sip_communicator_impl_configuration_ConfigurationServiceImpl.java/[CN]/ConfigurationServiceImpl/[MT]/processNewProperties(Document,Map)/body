{
  Iterator propNames=newProperties.keySet().iterator();
  while (propNames.hasNext()) {
    String key=(String)propNames.next();
    Object value=newProperties.get(key);
    boolean isSystem=value instanceof PropertyReference;
    value=isSystem ? ((PropertyReference)value).getValue() : value;
    processNewProperty(doc,key,value.toString(),isSystem);
  }
}
