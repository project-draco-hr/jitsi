{
  if (!started)   throw new IllegalStateException("Service is stopped or has not been started");
  File config=getConfigurationFile();
  FailSafeTransaction trans=this.faService.createFailSafeTransaction(config);
  try {
    trans.beginTransaction();
    OutputStream stream=new FileOutputStream(config);
    store.storeConfiguration(stream);
    stream.close();
    trans.commit();
  }
 catch (  Exception e) {
    logger.error("can't write data in the configuration file",e);
    trans.rollback();
  }
}
