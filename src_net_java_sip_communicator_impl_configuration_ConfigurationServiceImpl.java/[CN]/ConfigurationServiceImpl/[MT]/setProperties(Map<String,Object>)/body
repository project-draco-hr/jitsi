{
  Map<String,Object> oldValues=new HashMap<String,Object>(properties.size());
  for (  Map.Entry<String,Object> property : properties.entrySet()) {
    String propertyName=property.getKey();
    Object oldValue=getProperty(propertyName);
    oldValues.put(propertyName,oldValue);
    if (changeEventDispatcher.hasVetoableChangeListeners(propertyName))     changeEventDispatcher.fireVetoableChange(propertyName,oldValue,property.getValue());
  }
  for (  Map.Entry<String,Object> property : properties.entrySet())   doSetProperty(property.getKey(),property.getValue(),false);
  try {
    storeConfiguration();
  }
 catch (  IOException ex) {
    logger.error("Failed to store configuration after property changes");
  }
  for (  Map.Entry<String,Object> property : properties.entrySet()) {
    String propertyName=property.getKey();
    if (changeEventDispatcher.hasPropertyChangeListeners(propertyName))     changeEventDispatcher.firePropertyChange(propertyName,oldValues.get(propertyName),property.getValue());
  }
}
