{
  for (  Map.Entry<String,Object> entry : newProperties.entrySet()) {
    String key=entry.getKey();
    Object value=entry.getValue();
    boolean isSystem=value instanceof PropertyReference;
    value=isSystem ? ((PropertyReference)value).getValue() : value;
    processNewProperty(doc,key,value.toString(),isSystem);
  }
}
