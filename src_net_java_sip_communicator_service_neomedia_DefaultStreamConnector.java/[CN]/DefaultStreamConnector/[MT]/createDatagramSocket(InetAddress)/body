{
  ConfigurationService cfg=NeomediaActivator.getConfigurationService();
  int bindRetries=BIND_RETRIES_DEFAULT_VALUE;
  if (cfg != null)   bindRetries=cfg.getInt(BIND_RETRIES_PROPERTY_NAME,bindRetries);
  if (maxPort < 0) {
    maxPort=6000;
    if (cfg != null)     maxPort=cfg.getInt(MAX_PORT_NUMBER_PROPERTY_NAME,maxPort);
  }
  for (int i=0; i < bindRetries; i++) {
    if ((minPort < 0) || (minPort > maxPort)) {
      minPort=5000;
      if (cfg != null) {
        minPort=cfg.getInt(MIN_PORT_NUMBER_PROPERTY_NAME,minPort);
      }
    }
    int port=minPort++;
    try {
      return (bindAddr == null) ? new DatagramSocket(port) : new DatagramSocket(port,bindAddr);
    }
 catch (    SocketException se) {
      logger.warn("Retrying a bind because of a failure to bind to address " + bindAddr + " and port "+ port,se);
    }
  }
  return null;
}
