{
  try {
    chatRoom.join();
    ChatRoomWrapper chatRoomWrapper=chatRoomList.findChatRoomWrapperFromChatRoom(chatRoom);
    if (chatRoomWrapper == null) {
      chatRoomWrapper=new ChatRoomWrapper(chatRoom);
      chatRoomList.addChatRoom(chatRoomWrapper);
    }
    ConfigurationManager.updateChatRoomStatus(chatRoomWrapper.getParentProvider(),chatRoomWrapper.getChatRoomID(),Constants.ONLINE_STATUS);
  }
 catch (  OperationFailedException e) {
    if (e.getErrorCode() == OperationFailedException.AUTHENTICATION_FAILED) {
      ChatRoomAuthenticationWindow authWindow=new ChatRoomAuthenticationWindow(mainFrame,chatRoom);
      authWindow.setVisible(true);
    }
 else     if (e.getErrorCode() == OperationFailedException.REGISTRATION_REQUIRED) {
      new ErrorDialog(mainFrame,Messages.getI18NString("error").getText(),Messages.getI18NString("chatRoomRegistrationRequired",new String[]{chatRoom.getName()}).getText(),e).showDialog();
    }
 else     if (e.getErrorCode() == OperationFailedException.PROVIDER_NOT_REGISTERED) {
      new ErrorDialog(mainFrame,Messages.getI18NString("error").getText(),Messages.getI18NString("chatRoomNotConnected",new String[]{chatRoom.getName()}).getText(),e).showDialog();
    }
 else     if (e.getErrorCode() == OperationFailedException.SUBSCRIPTION_ALREADY_EXISTS) {
      new ErrorDialog(mainFrame,Messages.getI18NString("error").getText(),Messages.getI18NString("chatRoomAlreadyJoined",new String[]{chatRoom.getName()}).getText(),e).showDialog();
    }
 else {
      new ErrorDialog(mainFrame,Messages.getI18NString("error").getText(),Messages.getI18NString("failedToJoinChatRoom",new String[]{chatRoom.getName()}).getText(),e).showDialog();
    }
    logger.error("Failed to join chat room: " + chatRoom.getName(),e);
  }
}
