{
  ChatRoom sourceChatRoom=evt.getChatRoom();
  ChatRoomWrapper chatRoomWrapper=chatRoomList.findChatRoomWrapperFromChatRoom(sourceChatRoom);
  if (evt.getEventType().equals(LocalUserChatRoomPresenceChangeEvent.LOCAL_USER_JOINED)) {
    if (chatRoomWrapper != null) {
      chatRoomList.refresh();
      ConferenceChatPanel chatPanel=(ConferenceChatPanel)chatWindowManager.getMultiChat(chatRoomWrapper);
      if (chatWindowManager.isChatOpenedForChatRoom(chatRoomWrapper)) {
        chatPanel.loadChatRoom(sourceChatRoom);
      }
 else {
        chatWindowManager.openChat(chatPanel,true);
      }
      chatPanel.updateChatRoomStatus(Constants.ONLINE_STATUS);
    }
    if (sourceChatRoom.isSystem()) {
      MultiUserChatServerWrapper serverWrapper=chatRoomList.findServerWrapperFromProvider(sourceChatRoom.getParentProvider());
      serverWrapper.setSystemRoom(sourceChatRoom);
    }
    sourceChatRoom.addMessageListener(this);
  }
 else   if (evt.getEventType().equals(LocalUserChatRoomPresenceChangeEvent.LOCAL_USER_JOIN_FAILED)) {
    new ErrorDialog(mainFrame,Messages.getI18NString("error").getText(),Messages.getI18NString("failedToJoinChatRoom",new String[]{sourceChatRoom.getName()}).getText() + evt.getReason()).showDialog();
  }
 else   if (evt.getEventType().equals(LocalUserChatRoomPresenceChangeEvent.LOCAL_USER_LEFT)) {
    this.closeChatRoom(chatRoomWrapper);
    chatRoomList.refresh();
    sourceChatRoom.removeMessageListener(this);
  }
 else   if (evt.getEventType().equals(LocalUserChatRoomPresenceChangeEvent.LOCAL_USER_KICKED)) {
    this.closeChatRoom(chatRoomWrapper);
    chatRoomList.refresh();
    sourceChatRoom.removeMessageListener(this);
  }
 else   if (evt.getEventType().equals(LocalUserChatRoomPresenceChangeEvent.LOCAL_USER_DROPPED)) {
    this.closeChatRoom(chatRoomWrapper);
    chatRoomList.refresh();
    sourceChatRoom.removeMessageListener(this);
  }
}
