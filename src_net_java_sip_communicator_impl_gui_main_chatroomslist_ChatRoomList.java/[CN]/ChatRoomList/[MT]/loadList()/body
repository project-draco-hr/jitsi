{
  try {
    ServiceReference[] serRefs=GuiActivator.bundleContext.getServiceReferences(ProtocolProviderService.class.getName(),null);
    if (serRefs == null)     return;
    for (int i=0; i < serRefs.length; i++) {
      ServiceReference protocolProviderRef=serRefs[i];
      ProtocolProviderService protocolProvider=(ProtocolProviderService)GuiActivator.bundleContext.getService(protocolProviderRef);
      Object multiUserChatOpSet=protocolProvider.getOperationSet(OperationSetMultiUserChat.class);
      if (multiUserChatOpSet != null) {
        this.addChatProvider(protocolProvider);
      }
    }
  }
 catch (  InvalidSyntaxException e) {
    logger.error("Failed to obtain service references.",e);
  }
}
