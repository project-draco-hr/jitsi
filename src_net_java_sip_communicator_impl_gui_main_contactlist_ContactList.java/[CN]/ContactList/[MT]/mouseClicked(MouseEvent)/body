{
  int selectedIndex=this.getSelectedIndex();
  Object selectedValue=this.getSelectedValue();
  if (selectedIndex < 0)   return;
  ContactListCellRenderer renderer=(ContactListCellRenderer)this.getCellRenderer().getListCellRendererComponent(this,selectedValue,selectedIndex,true,true);
  Point selectedCellPoint=this.indexToLocation(selectedIndex);
  int translatedX=e.getX() - selectedCellPoint.x;
  if (selectedValue instanceof MetaContactGroup) {
    MetaContactGroup group=(MetaContactGroup)selectedValue;
    if ((e.getModifiers() & InputEvent.BUTTON3_MASK) != 0 || (e.isControlDown() && !e.isMetaDown())) {
      groupRightButtonMenu=new GroupRightButtonMenu(mainFrame,group);
      SwingUtilities.convertPointToScreen(selectedCellPoint,this);
      groupRightButtonMenu.setInvoker(this);
      groupRightButtonMenu.setLocation(selectedCellPoint.x,selectedCellPoint.y + renderer.getHeight());
      groupRightButtonMenu.setVisible(true);
    }
 else     if ((e.getModifiers() & InputEvent.BUTTON1_MASK) != 0) {
      if (!disableOpenClose) {
        if (listModel.isGroupClosed(group))         listModel.openGroup(group);
 else         listModel.closeGroup(group);
      }
      fireContactListEvent(group,ContactListEvent.GROUP_CLICKED,e.getClickCount());
      if (!disableOpenClose) {
        Component component=this.getHorizontalComponent(renderer,translatedX);
        if ((component instanceof JPanel) && ("buttonsPanel".equals(component.getName()))) {
          JPanel panel=(JPanel)component;
          int internalX=translatedX - (renderer.getWidth() - panel.getWidth() - 2);
          Component c=getHorizontalComponent(panel,internalX);
          if (c instanceof JLabel) {
            if (listModel.isGroupClosed(group))             listModel.openGroup(group);
 else             listModel.closeGroup(group);
          }
        }
      }
    }
  }
  if (selectedValue instanceof MetaContact) {
    MetaContact contact=(MetaContact)selectedValue;
    Component component=this.getHorizontalComponent(renderer,translatedX);
    if ((e.getModifiers() & InputEvent.BUTTON3_MASK) != 0 || (e.isControlDown() && !e.isMetaDown())) {
      SwingUtilities.convertPointToScreen(selectedCellPoint,this);
      contactRightButtonMenu.setInvoker(this);
      contactRightButtonMenu.setLocation(selectedCellPoint.x,selectedCellPoint.y + renderer.getHeight());
      contactRightButtonMenu.setVisible(true);
    }
 else     if ((e.getModifiers() & InputEvent.BUTTON1_MASK) != 0 && e.getClickCount() > 1) {
      fireContactListEvent(contact,ContactListEvent.CONTACT_CLICKED,e.getClickCount());
    }
  }
}
