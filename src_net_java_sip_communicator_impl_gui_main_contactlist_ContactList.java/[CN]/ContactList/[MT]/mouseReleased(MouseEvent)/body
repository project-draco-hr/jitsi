{
  int selectedIndex=this.locationToIndex(e.getPoint());
  Object dest=listModel.getElementAt(selectedIndex);
  if (draggedElement != null) {
    if (dest instanceof MetaContact) {
      MetaContact contactDest=(MetaContact)dest;
      if (draggedElement.getMetaContact() != contactDest) {
        if (draggedElement.getContact() != null) {
          new MoveContactToMetaContactThread(draggedElement.getContact(),contactDest).start();
        }
 else {
          Iterator i=draggedElement.getMetaContact().getContacts();
          while (i.hasNext()) {
            Contact contact=(Contact)i.next();
            new MoveContactToMetaContactThread(contact,contactDest).start();
          }
        }
      }
    }
 else     if (dest instanceof MetaContactGroup) {
      MetaContactGroup contactDest=(MetaContactGroup)dest;
      if (draggedElement.getContact() != null) {
        if (draggedElement.getMetaContact().getContactCount() > 1) {
          new MoveContactToGroupThread(draggedElement.getContact(),contactDest).start();
        }
 else         if (!contactDest.contains(draggedElement.getMetaContact())) {
          new MoveMetaContactThread(draggedElement.getMetaContact(),contactDest).start();
        }
      }
 else       if (!contactDest.contains(draggedElement.getMetaContact())) {
        try {
          new MoveMetaContactThread(draggedElement.getMetaContact(),contactDest).start();
        }
 catch (        Exception ex) {
          new ErrorDialog(mainFrame,GuiActivator.getResources().getI18NString("service.gui.MOVE_TO_GROUP"),GuiActivator.getResources().getI18NString("service.gui.MOVE_CONTACT_ERROR"),ex).showDialog();
        }
      }
    }
    draggedElement.setVisible(false);
    draggedElement=null;
  }
  setCursor(Cursor.getPredefinedCursor((dest instanceof MetaContactGroup) ? Cursor.HAND_CURSOR : Cursor.DEFAULT_CURSOR));
}
