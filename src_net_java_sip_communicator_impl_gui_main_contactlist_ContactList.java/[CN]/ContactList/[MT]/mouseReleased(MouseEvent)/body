{
  setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));
  int selectedIndex=this.locationToIndex(e.getPoint());
  ContactListModel listModel=(ContactListModel)this.getModel();
  Object dest=listModel.getElementAt(selectedIndex);
  if (draggedElement != null) {
    if (dest instanceof MetaContact) {
      MetaContact contactDest=(MetaContact)dest;
      if (draggedElement.getMetaContact() != contactDest) {
        if (draggedElement.getContact() != null) {
          mainFrame.getContactList().moveContact(draggedElement.getContact(),contactDest);
        }
 else {
          Iterator i=draggedElement.getMetaContact().getContacts();
          while (i.hasNext()) {
            Contact contact=(Contact)i.next();
            mainFrame.getContactList().moveContact(contact,contactDest);
          }
        }
      }
    }
 else     if (dest instanceof MetaContactGroup) {
      MetaContactGroup contactDest=(MetaContactGroup)dest;
      if (draggedElement.getContact() != null) {
        int i=draggedElement.getMetaContact().getContactCount();
        if (i > 1) {
          mainFrame.getContactList().moveContact(draggedElement.getContact(),contactDest);
        }
 else         if (!contactDest.contains(draggedElement.getMetaContact())) {
          mainFrame.getContactList().moveContact(draggedElement.getContact(),contactDest);
        }
      }
 else       if (!contactDest.contains(draggedElement.getMetaContact())) {
        mainFrame.getContactList().moveMetaContact(draggedElement.getMetaContact(),contactDest);
      }
    }
  }
  draggedElement=null;
}
