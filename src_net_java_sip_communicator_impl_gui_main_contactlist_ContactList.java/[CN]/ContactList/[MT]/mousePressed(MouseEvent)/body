{
  this.requestFocus();
  draggedElement=null;
  if ((e.getModifiers() & InputEvent.BUTTON2_MASK) != 0 || (e.getModifiers() & InputEvent.BUTTON3_MASK) != 0 || (e.isControlDown() && !e.isMetaDown())) {
    this.setSelectedIndex(locationToIndex(e.getPoint()));
  }
  int selectedIndex=this.getSelectedIndex();
  Object selectedValue=this.getSelectedValue();
  ContactListCellRenderer renderer=(ContactListCellRenderer)this.getCellRenderer().getListCellRendererComponent(this,selectedValue,selectedIndex,true,true);
  Point selectedCellPoint=this.indexToLocation(selectedIndex);
  int translatedX=e.getX() - selectedCellPoint.x;
  if (selectedValue instanceof MetaContact) {
    MetaContact mContact=(MetaContact)selectedValue;
    Component component=this.getHorizontalComponent(renderer,translatedX);
    if (component instanceof JLabel) {
      draggedElement=new ContactListDraggable(mContact,null,component);
    }
 else     if (component instanceof JPanel) {
      if (component.getName() != null && component.getName().equals("buttonsPanel")) {
        JPanel panel=(JPanel)component;
        int internalX=translatedX - (renderer.getWidth() - panel.getWidth() - 2);
        Component c=getHorizontalComponent(panel,internalX);
        if (c instanceof ContactProtocolButton) {
          draggedElement=new ContactListDraggable(mContact,((ContactProtocolButton)c).getProtocolContact(),component);
        }
      }
    }
    if (draggedElement != null) {
      Component src=draggedElement.getComponent();
      Component c=src;
      Image image;
      if (c instanceof ContactProtocolButton) {
        image=new BufferedImage(((ContactProtocolButton)c).getWidth(),((ContactProtocolButton)c).getHeight(),BufferedImage.TYPE_INT_ARGB);
      }
 else {
        image=new BufferedImage(c.getWidth(),c.getHeight(),BufferedImage.TYPE_INT_ARGB);
      }
      Graphics g=image.getGraphics();
      c.paint(g);
      draggedElement.setImage(image);
      Point p=(Point)e.getPoint().clone();
      SwingUtilities.convertPointToScreen(p,c);
      SwingUtilities.convertPointFromScreen(p,this);
      draggedElement.setLocation(p);
    }
  }
}
