{
synchronized (storedAccountsAreLoaded) {
    if (!storedAccountsAreLoaded[0]) {
      if (uris == null) {
        uris=new LinkedList<String>();
      }
      uris.add(uri);
      return;
    }
  }
  ProtocolProviderService provider;
  try {
    provider=selectHandlingProvider(uri);
  }
 catch (  OperationFailedException exc) {
    if (logger.isTraceEnabled())     logger.trace("User canceled handling of uri " + uri);
    return;
  }
  if (provider == null) {
    showErrorMessage("You need to configure at least one SIP account \n" + "to be able to call " + uri,null);
    return;
  }
  if (uri != null)   uri=uri.replace("sip://","sip:");
  OperationSetBasicTelephony<?> telephonyOpSet=provider.getOperationSet(OperationSetBasicTelephony.class);
  try {
    new ProtocolRegistrationThread(uri,provider).start();
    try {
      Thread.sleep(1000);
    }
 catch (    InterruptedException ex) {
    }
    telephonyOpSet.createCall(uri);
  }
 catch (  OperationFailedException exc) {
    boolean handled=false;
    if (exc.getErrorCode() == OperationFailedException.PROVIDER_NOT_REGISTERED) {
      handled=promptForRegistration(uri,provider);
    }
    if (!handled) {
      showErrorMessage("Failed to create a call to " + uri,exc);
    }
  }
catch (  ParseException exc) {
    showErrorMessage(uri + " does not appear to be a valid SIP address",exc);
  }
}
