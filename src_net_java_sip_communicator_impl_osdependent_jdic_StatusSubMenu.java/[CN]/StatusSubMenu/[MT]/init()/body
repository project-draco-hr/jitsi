{
  OsDependentActivator.bundleContext.addServiceListener(new ProtocolProviderServiceListener());
  ServiceReference[] protocolProviderRefs=null;
  try {
    protocolProviderRefs=OsDependentActivator.bundleContext.getServiceReferences(ProtocolProviderService.class.getName(),null);
  }
 catch (  InvalidSyntaxException ex) {
    logger.error("Error while retrieving service refs",ex);
    return;
  }
  if (protocolProviderRefs != null) {
    for (int i=0; i < protocolProviderRefs.length; i++) {
      ProtocolProviderService provider=(ProtocolProviderService)OsDependentActivator.bundleContext.getService(protocolProviderRefs[i]);
      boolean isHidden=provider.getAccountID().getAccountProperty(ProtocolProviderFactory.IS_PROTOCOL_HIDDEN) != null;
      if (!isHidden)       this.addAccount(provider);
    }
  }
}
