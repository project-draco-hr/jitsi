{
  if (roster.getUnfiledEntryCount() > 0) {
    for (    RosterEntry item : roster.getUnfiledEntries()) {
      ContactJabberImpl contact=findContactById(item.getUser());
      if (item.getType() == RosterPacket.ItemType.none) {
        if (contact != null) {
          ContactGroup parent=contact.getParentContactGroup();
          if (parent instanceof RootContactGroupJabberImpl)           ((RootContactGroupJabberImpl)parent).removeContact(contact);
 else           ((ContactGroupJabberImpl)parent).removeContact(contact);
          fireContactRemoved(parent,contact);
        }
        continue;
      }
      if (contact == null) {
        contact=new ContactJabberImpl(item,this,true,true);
        rootGroup.addContact(contact);
        fireContactAdded(rootGroup,contact);
      }
 else {
        contact.setResolved(item);
        fireContactResolved(rootGroup,contact);
      }
    }
  }
  for (  RosterGroup item : roster.getGroups()) {
    ContactGroupJabberImpl group=findContactGroup(item.getName());
    if (group == null) {
      ContactGroupJabberImpl newGroup=new ContactGroupJabberImpl(item,item.getEntries().iterator(),this,true);
      rootGroup.addSubGroup(newGroup);
      fireGroupEvent(newGroup,ServerStoredGroupEvent.GROUP_CREATED_EVENT);
    }
 else {
      group.setResolved(item);
      fireGroupEvent(group,ServerStoredGroupEvent.GROUP_RESOLVED_EVENT);
    }
  }
}
