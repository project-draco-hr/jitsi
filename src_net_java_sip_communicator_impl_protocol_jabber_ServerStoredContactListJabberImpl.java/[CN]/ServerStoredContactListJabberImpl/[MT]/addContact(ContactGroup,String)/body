{
  if (logger.isTraceEnabled())   logger.trace("Adding contact " + id + " to parent="+ parent);
  String completeID=parseAddressString(id);
  ContactJabberImpl existingContact=findContactById(completeID);
  if (existingContact != null && existingContact.isPersistent()) {
    if (logger.isDebugEnabled())     logger.debug("Contact " + completeID + " already exists in group "+ findContactGroup(existingContact));
    throw new OperationFailedException("Contact " + completeID + " already exists.",OperationFailedException.SUBSCRIPTION_ALREADY_EXISTS);
  }
  try {
    String[] parentNames=null;
    if (parent != null)     parentNames=new String[]{parent.getGroupName()};
    SmackConfiguration.setPacketReplyTimeout(ProtocolProviderServiceJabberImpl.SMACK_PACKET_REPLY_TIMEOUT);
    this.roster.createEntry(completeID,completeID,parentNames);
    SmackConfiguration.setPacketReplyTimeout(5000);
  }
 catch (  XMPPException ex) {
    String errTxt="Error adding new jabber entry";
    logger.error(errTxt,ex);
    int errorCode=OperationFailedException.INTERNAL_ERROR;
    XMPPError err=ex.getXMPPError();
    if (err != null) {
      if (err.getCode() > 400 && err.getCode() < 500)       errorCode=OperationFailedException.FORBIDDEN;
 else       if (err.getCode() > 500)       errorCode=OperationFailedException.INTERNAL_SERVER_ERROR;
      errTxt=err.getCondition();
    }
    throw new OperationFailedException(errTxt,errorCode,ex);
  }
}
