{
  TypingNotificationRecord record=typingNotificationRecord.get(notifiedContact.getAddress());
  if (record == null) {
    record=new TypingNotificationRecord(-1l,-1);
synchronized (typingNotificationRecord) {
      typingNotificationRecord.put(notifiedContact.getAddress(),record);
    }
  }
  if (record.getTime() < System.currentTimeMillis() - 1000) {
    FacebookOutgoingTypingNotification msg=new FacebookOutgoingTypingNotification(session);
    msg.setAddress(notifiedContact.getAddress());
    msg.setTypingState(typingState);
    msg.send();
    record.setTime(System.currentTimeMillis());
    record.setType(typingState);
  }
}
