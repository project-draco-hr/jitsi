{
  ContactMsnImpl contactToAdd=findContactById(c.getEmail().getEmailAddress());
  if (contactToAdd == null) {
    contactToAdd=new ContactMsnImpl(c,ServerStoredContactListMsnImpl.this,true,true);
    ContactGroupMsnImpl group=findContactGroupByMsnId(g.getGroupId());
    if (group == null) {
      logger.error("Group is missing!");
      return;
    }
    group.addContact(contactToAdd);
    fireContactAdded(group,contactToAdd);
  }
 else {
    ContactGroup oldGroup=contactToAdd.getParentContactGroup();
    ContactGroupMsnImpl group=findContactGroupByMsnId(g.getGroupId());
    if (group == null) {
      logger.error("Group is missing!");
      return;
    }
    group.addContact(contactToAdd);
    if (oldGroup instanceof RootContactGroupMsnImpl) {
      ((RootContactGroupMsnImpl)oldGroup).removeContact(contactToAdd);
    }
 else {
      ((ContactGroupMsnImpl)oldGroup).removeContact(contactToAdd);
    }
    fireContactMoved(oldGroup,group,contactToAdd);
  }
}
