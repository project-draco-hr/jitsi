{
  logger.trace("Adding contact " + id + " to parent="+ parent);
  ContactMsnImpl existingContact=findContactById(id);
  if (existingContact != null && existingContact.isPersistent()) {
    logger.debug("Contact " + id + " already exists.");
    throw new OperationFailedException("Contact " + id + " already exists.",OperationFailedException.SUBSCRIPTION_ALREADY_EXISTS);
  }
  if (parent != null) {
    contactListModListenerImpl.waitForAddInGroup(id);
    ModListenerAddContactInGroup modListenerAddContactInGroup=new ModListenerAddContactInGroup(id,parent);
    contactListModManager.addModificationListener(modListenerAddContactInGroup);
    msnProvider.getMessenger().unblockFriend(Email.parseStr(id));
    msnProvider.getMessenger().addFriend(Email.parseStr(id),id);
    modListenerAddContactInGroup.waitForEvent(1500);
    contactListModManager.removeModificationListener(modListenerAddContactInGroup);
  }
 else {
    msnProvider.getMessenger().unblockFriend(Email.parseStr(id));
    msnProvider.getMessenger().addFriend(Email.parseStr(id),id);
  }
}
