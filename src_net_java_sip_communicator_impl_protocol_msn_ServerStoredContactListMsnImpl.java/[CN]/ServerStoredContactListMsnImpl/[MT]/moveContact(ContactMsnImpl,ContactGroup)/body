{
  ContactGroup oldParent=contact.getParentContactGroup();
  if (oldParent instanceof RootContactGroupMsnImpl) {
    if (logger.isTraceEnabled())     logger.trace("Will Move from root " + contact);
    msnProvider.getMessenger().copyFriend(contact.getSourceContact().getEmail(),((ContactGroupMsnImpl)newParent).getSourceGroup().getGroupId());
  }
 else {
    if (newParent instanceof RootContactGroupMsnImpl && !contact.isPersistent()) {
      try {
        addContact(contact.getAddress());
      }
 catch (      OperationFailedException ex) {
        logger.error("Failed to add contact from " + "NotInContactList group to new group: " + newParent,ex);
      }
      return;
    }
    if (!contact.isPersistent() && !contact.getParentContactGroup().isPersistent()) {
      try {
        addContact((ContactGroupMsnImpl)newParent,contact.getAddress());
      }
 catch (      OperationFailedException ex) {
        logger.error("Failed to add contact from " + "NotInContactList group to new group: " + newParent,ex);
      }
    }
 else {
      if (logger.isTraceEnabled())       logger.trace("Will Move from " + contact.getParentContactGroup() + " to : "+ newParent+ " - contact: "+ contact);
      msnProvider.getMessenger().moveFriend(contact.getSourceContact().getEmail(),((ContactGroupMsnImpl)contact.getParentContactGroup()).getSourceGroup().getGroupId(),((ContactGroupMsnImpl)newParent).getSourceGroup().getGroupId());
    }
  }
}
