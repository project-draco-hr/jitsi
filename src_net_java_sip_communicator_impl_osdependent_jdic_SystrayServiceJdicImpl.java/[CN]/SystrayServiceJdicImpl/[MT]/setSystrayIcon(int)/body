{
  if (!checkInitialized())   return;
  boolean isMac=OSUtils.IS_MAC;
  ImageIcon toChangeSystrayIcon=null;
  if (imageType == SystrayService.SC_IMG_TYPE) {
    toChangeSystrayIcon=(isMac && TrayMenuFactory.isVisible(menu)) ? logoIconWhite : logoIcon;
  }
 else   if (imageType == SystrayService.SC_IMG_OFFLINE_TYPE) {
    if (!isMac)     toChangeSystrayIcon=logoIconOffline;
  }
 else   if (imageType == SystrayService.SC_IMG_AWAY_TYPE) {
    if (!isMac)     toChangeSystrayIcon=logoIconAway;
  }
 else   if (imageType == SystrayService.SC_IMG_FFC_TYPE) {
    if (!isMac)     toChangeSystrayIcon=logoIconFFC;
  }
 else   if (imageType == SystrayService.ENVELOPE_IMG_TYPE) {
    toChangeSystrayIcon=(isMac && TrayMenuFactory.isVisible(menu)) ? envelopeIconWhite : envelopeIcon;
  }
  if (toChangeSystrayIcon != null) {
    this.trayIcon.setIcon(toChangeSystrayIcon);
    this.currentIcon=toChangeSystrayIcon;
  }
  if (isMac) {
    URL toChangeDockIcon=null;
switch (imageType) {
case SystrayService.SC_IMG_TYPE:
      break;
case SystrayService.SC_IMG_OFFLINE_TYPE:
    toChangeDockIcon=dockIconOffline;
  break;
case SystrayService.SC_IMG_AWAY_TYPE:
toChangeDockIcon=dockIconAway;
break;
case SystrayService.SC_IMG_FFC_TYPE:
toChangeDockIcon=dockIconFFC;
break;
}
try {
if (OSUtils.IS_MAC32) {
if (toChangeDockIcon != null) Dock.setDockTileImage(toChangeDockIcon);
 else Dock.restoreDockTileImage();
}
}
 catch (Exception e) {
logger.error("failed to change dock icon",e);
}
}
}
