{
  addComponentListener(new ComponentAdapter(){
    public void componentResized(    ComponentEvent evt){
      Window parentWindow;
      Component parent=getParent();
      if (parent instanceof JPopupMenu)       parentWindow=SwingUtilities.getWindowAncestor(((JPopupMenu)parent).getInvoker());
 else       parentWindow=SwingUtilities.getWindowAncestor(getInvoker());
      if (!parentWindow.isActive()) {
        setVisible(false);
      }
      parentWindow.addWindowFocusListener(new WindowFocusListener(){
        public void windowLostFocus(        WindowEvent e){
          if (SIPCommPopupMenu.this != null && SIPCommPopupMenu.this.isVisible())           SIPCommPopupMenu.this.setVisible(false);
        }
        public void windowGainedFocus(        WindowEvent e){
        }
      }
);
    }
  }
);
}
