{
  try {
    while (!checkFirstPacket())     ;
    failedKeepalivePackets=0;
  }
 catch (  NoSuchElementException ex) {
    logger.error("Did not receive last keep alive packet for account " + jabberProvider.getAccountID().getAccountUniqueID());
    failedKeepalivePackets++;
    if (failedKeepalivePackets == 3) {
      logger.error("unregistering.");
      jabberProvider.unregister(false);
      jabberProvider.fireRegistrationStateChanged(jabberProvider.getRegistrationState(),RegistrationState.CONNECTION_FAILED,RegistrationStateChangeEvent.REASON_SERVER_NOT_FOUND,null);
      failedKeepalivePackets=0;
    }
  }
}
