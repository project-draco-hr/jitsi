{
  if (!(to instanceof ContactJabberImpl))   throw new IllegalArgumentException("The specified contact is not a Jabber contact." + to);
  try {
    assertConnected();
    Chat chat=jabberProvider.getConnection().createChat(to.getAddress());
    org.jivesoftware.smack.packet.Message msg=chat.createMessage();
    msg.setBody(message.getContent());
    msg.addExtension(new Version());
    MessageEventManager.addNotificationsRequests(msg,true,false,false,true);
    chat.sendMessage(msg);
    MessageDeliveredEvent msgDeliveredEvt=new MessageDeliveredEvent(message,to,new Date());
    fireMessageEvent(msgDeliveredEvt);
  }
 catch (  XMPPException ex) {
    logger.error("message not send",ex);
  }
}
