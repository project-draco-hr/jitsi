{
  try {
    CallPeer sourcePeer=evt.getSourceCallPeer();
    CallPeerState newState=(CallPeerState)evt.getNewValue();
    CallPeerState oldState=(CallPeerState)evt.getOldValue();
    if (newState == CallPeerState.INITIATING_CALL || newState == CallPeerState.CONNECTING) {
      NotificationManager.fireNotification(NotificationManager.DIALING);
    }
 else {
      NotificationManager.stopSound(NotificationManager.DIALING);
    }
    if (newState == CallPeerState.ALERTING_REMOTE_SIDE && oldState != CallPeerState.CONNECTING_WITH_EARLY_MEDIA) {
      NotificationManager.fireNotification(NotificationManager.OUTGOING_CALL);
    }
 else     if (newState == CallPeerState.BUSY) {
      NotificationManager.stopSound(NotificationManager.OUTGOING_CALL);
      if (!isConference(sourcePeer.getCall())) {
        NotificationManager.fireNotification(NotificationManager.BUSY_CALL);
      }
    }
 else     if (newState == CallPeerState.CONNECTING_INCOMING_CALL || newState == CallPeerState.CONNECTING_INCOMING_CALL_WITH_MEDIA) {
      if (!CallPeerState.isOnHold(oldState)) {
        NotificationManager.stopSound(NotificationManager.OUTGOING_CALL);
        NotificationManager.stopSound(NotificationManager.INCOMING_CALL);
      }
    }
 else     if (newState == CallPeerState.CONNECTING_WITH_EARLY_MEDIA) {
      NotificationManager.stopSound(NotificationManager.OUTGOING_CALL);
    }
 else     if (newState == CallPeerState.CONNECTED) {
      if (!CallPeerState.isOnHold(oldState)) {
        NotificationManager.stopSound(NotificationManager.OUTGOING_CALL);
        NotificationManager.stopSound(NotificationManager.INCOMING_CALL);
      }
    }
 else     if (newState == CallPeerState.DISCONNECTED || newState == CallPeerState.FAILED) {
      stopAllTelephonySounds();
      NotificationManager.fireNotification(NotificationManager.HANG_UP);
    }
  }
 catch (  Throwable t) {
    logger.error("Error notifying after peer state changed",t);
  }
}
