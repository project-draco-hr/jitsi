{
  byte[] contactImage=null;
  if (!(sourceContact instanceof Contact))   return null;
  Contact contact=(Contact)sourceContact;
  MetaContact metaContact=GuiActivator.getMetaContactListService().findMetaContactByContact(contact);
  if (metaContact != null) {
    Iterator i=metaContact.getContacts();
    while (i.hasNext()) {
      Contact protoContact=(Contact)i.next();
      try {
        contactImage=protoContact.getImage();
      }
 catch (      Exception ex) {
        logger.error("Failed to load contact photo.",ex);
      }
      if (contactImage != null && contactImage.length > 0)       break;
    }
  }
 else   if (contact != null) {
    try {
      contactImage=contact.getImage();
    }
 catch (    Exception ex) {
      logger.error("Failed to load contact photo.",ex);
    }
  }
  if (contactImage != null) {
    Image image=ImageLoader.getBytesInImage(contactImage);
    return new ImageIcon(image.getScaledInstance(40,45,Image.SCALE_SMOOTH));
  }
 else   return null;
}
