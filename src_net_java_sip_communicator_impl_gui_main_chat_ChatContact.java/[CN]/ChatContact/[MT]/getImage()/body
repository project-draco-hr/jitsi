{
  byte[] contactImage=null;
  if (!(sourceContact instanceof Contact))   return null;
  Contact contact=(Contact)sourceContact;
  MetaContact metaContact=GuiActivator.getMetaContactListService().findMetaContactByContact(contact);
  if (metaContact != null) {
    Iterator i=metaContact.getContacts();
    while (i.hasNext()) {
      Contact protoContact=(Contact)i.next();
      try {
        contactImage=protoContact.getImage();
      }
 catch (      Exception ex) {
        logger.error("Failed to load contact photo.",ex);
      }
      if (contactImage != null && contactImage.length > 0)       break;
    }
  }
 else   if (contact != null) {
    try {
      contactImage=contact.getImage();
    }
 catch (    Exception ex) {
      logger.error("Failed to load contact photo.",ex);
    }
  }
  if (contactImage != null) {
    Image image=ImageLoader.getBytesInImage(contactImage);
    if (image.getHeight(null) > AVATAR_ICON_HEIGHT || image.getWidth(null) > AVATAR_ICON_WIDTH)     return new ImageIcon(image.getScaledInstance(AVATAR_ICON_WIDTH,AVATAR_ICON_HEIGHT,Image.SCALE_SMOOTH));
 else     return new ImageIcon(image);
  }
 else   return null;
}
