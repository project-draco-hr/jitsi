{
  ConfigurationService configService=GuiActivator.getConfigurationService();
  int accountIndex=-1;
  Iterator pproviders=protocolProviders.keySet().iterator();
  ProtocolProviderService pps;
  while (pproviders.hasNext()) {
    pps=(ProtocolProviderService)pproviders.next();
    if (pps.getProtocolDisplayName().equals(protocolProvider.getProtocolDisplayName()) && !pps.equals(protocolProvider)) {
      int index=((Integer)protocolProviders.get(pps)).intValue();
      if (accountIndex < index) {
        accountIndex=index;
      }
    }
  }
  accountIndex++;
  configService.setProperty(accountRootPropName + ".accountIndex",new Integer(accountIndex));
  return accountIndex;
}
