{
  ConfigurationService configService=GuiActivator.getConfigurationService();
  int accountIndex=-1;
  Enumeration pproviders=protocolProviders.keys();
  ProtocolProviderService pps;
  while (pproviders.hasMoreElements()) {
    pps=(ProtocolProviderService)pproviders.nextElement();
    if (pps.getProtocolName().equals(protocolProvider.getProtocolName()) && !pps.equals(protocolProvider)) {
      int index=((Integer)protocolProviders.get(pps)).intValue();
      if (accountIndex < index) {
        accountIndex=index;
      }
    }
  }
  accountIndex++;
  configService.setProperty(accountRootPropName + ".accountIndex",new Integer(accountIndex));
  return accountIndex;
}
