{
  Object sService=ResourceManagementActivator.bundleContext.getService(event.getServiceReference());
  if (!(sService instanceof ResourcePack)) {
    return;
  }
  ResourcePack resource=(ResourcePack)sService;
  if (event.getType() == ServiceEvent.REGISTERED) {
    logger.info("Resource registered " + resource);
    String resourceBaseName=resource.getResourcePackBaseName();
    ResourceBundle resourceBundle=ResourceBundle.getBundle(resourceBaseName,Locale.getDefault(),resource.getClass().getClassLoader());
    if (resource instanceof ColorPack && colorPack == null) {
      colorPack=resource;
      colorResourceBundle=resourceBundle;
    }
 else     if (resource instanceof ImagePack && imagePack == null) {
      imagePack=resource;
      imageResourceBundle=resourceBundle;
    }
 else     if (resource instanceof LanguagePack && languagePack == null) {
      languagePack=(LanguagePack)resource;
    }
 else     if (resource instanceof SettingsPack && settingsPack == null) {
      settingsPack=resource;
      settingsResourceBundle=resourceBundle;
    }
 else     if (resource instanceof SoundPack && soundPack == null) {
      soundPack=resource;
      soundResourceBundle=resourceBundle;
    }
  }
 else   if (event.getType() == ServiceEvent.UNREGISTERING) {
    if (resource instanceof ColorPack && colorPack.equals(resource)) {
      colorPack=registerDefaultPack(ColorPack.class.getName(),ColorPack.RESOURCE_NAME_DEFAULT_VALUE);
      if (colorPack != null)       colorResourceBundle=getResourceBundle(colorPack);
    }
 else     if (resource instanceof ImagePack && imagePack.equals(resource)) {
      imagePack=registerDefaultPack(ImagePack.class.getName(),ImagePack.RESOURCE_NAME_DEFAULT_VALUE);
      if (imagePack != null)       imageResourceBundle=getResourceBundle(imagePack);
    }
 else     if (resource instanceof LanguagePack && languagePack.equals(resource)) {
      languagePack=(LanguagePack)registerDefaultPack(LanguagePack.class.getName(),LanguagePack.RESOURCE_NAME_DEFAULT_VALUE);
    }
 else     if (resource instanceof SettingsPack && settingsPack.equals(resource)) {
      settingsPack=registerDefaultPack(SettingsPack.class.getName(),SettingsPack.RESOURCE_NAME_DEFAULT_VALUE);
      if (settingsPack != null)       settingsResourceBundle=getResourceBundle(settingsPack);
    }
 else     if (resource instanceof SoundPack && soundPack.equals(resource)) {
      soundPack=registerDefaultPack(SoundPack.class.getName(),SoundPack.RESOURCE_NAME_DEFAULT_VALUE);
      if (soundPack != null)       soundResourceBundle=getResourceBundle(soundPack);
    }
  }
}
