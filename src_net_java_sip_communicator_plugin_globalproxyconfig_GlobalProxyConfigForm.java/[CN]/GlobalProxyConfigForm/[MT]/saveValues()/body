{
  ConfigurationService configService=GlobalProxyPluginActivator.getConfigurationService();
  if (typeCombo.getSelectedItem().equals(ProxyInfo.ProxyType.NONE)) {
    configService.setProperty(ProxyInfo.CONNECTION_PROXY_TYPE_PROPERTY_NAME,ProxyInfo.ProxyType.NONE.name());
    configService.removeProperty(ProxyInfo.CONNECTION_PROXY_ADDRESS_PROPERTY_NAME);
    configService.removeProperty(ProxyInfo.CONNECTION_PROXY_PORT_PROPERTY_NAME);
    configService.removeProperty(ProxyInfo.CONNECTION_PROXY_USERNAME_PROPERTY_NAME);
    configService.removeProperty(ProxyInfo.CONNECTION_PROXY_PASSWORD_PROPERTY_NAME);
    return;
  }
  configService.setProperty(ProxyInfo.CONNECTION_PROXY_TYPE_PROPERTY_NAME,((ProxyInfo.ProxyType)typeCombo.getSelectedItem()).name());
  String serverAddress=serverAddressField.getText();
  if (serverAddress != null && serverAddress.length() > 0)   configService.setProperty(ProxyInfo.CONNECTION_PROXY_ADDRESS_PROPERTY_NAME,serverAddress);
  String port=portField.getText();
  if (port != null && port.length() > 0)   configService.setProperty(ProxyInfo.CONNECTION_PROXY_PORT_PROPERTY_NAME,port);
  String username=usernameField.getText();
  if (username != null && username.length() > 0) {
    configService.setProperty(ProxyInfo.CONNECTION_PROXY_USERNAME_PROPERTY_NAME,username);
  }
 else {
    configService.removeProperty(ProxyInfo.CONNECTION_PROXY_USERNAME_PROPERTY_NAME);
  }
  char[] password=passwordField.getPassword();
  if (password.length > 0) {
    configService.setProperty(ProxyInfo.CONNECTION_PROXY_PASSWORD_PROPERTY_NAME,new String(password));
  }
 else {
    configService.removeProperty(ProxyInfo.CONNECTION_PROXY_PASSWORD_PROPERTY_NAME);
  }
  GlobalProxyPluginActivator.initProperties();
}
