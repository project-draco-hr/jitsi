{
  deviceConfiguration.initialize();
  deviceConfiguration.addPropertyChangeListener(deviceConfigurationPropertyChangeListener);
  encodingConfiguration.initializeFormatPreferences();
  encodingConfiguration.registerCustomPackages();
  encodingConfiguration.registerCustomCodecs();
  if (!OSUtils.IS_ANDROID && !GraphicsEnvironment.isHeadless()) {
    try {
      final Component panel=MediaConfiguration.createBasicControls(DeviceConfigurationComboBoxModel.AUDIO,false);
      audioConfigDialog=new SIPCommDialog(){
        /** 
 * Serial version UID. 
 */
        private static final long serialVersionUID=0L;
        /** 
 * {@inheritDoc} 
 */
        @Override protected void close(        boolean escaped){
          setVisible(false);
        }
      }
;
      TransparentPanel mainPanel=new TransparentPanel(new BorderLayout(20,5));
      TransparentPanel fieldsPanel=new TransparentPanel(new BorderLayout(10,5));
      mainPanel.setBorder(BorderFactory.createEmptyBorder(20,20,20,20));
      TransparentPanel btnPanel=new TransparentPanel(new FlowLayout(FlowLayout.RIGHT));
      ResourceManagementService resources=NeomediaActivator.getResources();
      JButton btn=new JButton(resources.getI18NString("service.gui.CLOSE"));
      btn.addActionListener(new ActionListener(){
        public void actionPerformed(        ActionEvent evt){
          audioConfigDialog.setVisible(false);
        }
      }
);
      btnPanel.add(btn);
      JTextArea infoTextArea=new JTextArea();
      infoTextArea.setOpaque(false);
      infoTextArea.setEditable(false);
      infoTextArea.setWrapStyleWord(true);
      infoTextArea.setLineWrap(true);
      infoTextArea.setText(resources.getI18NString("impl.media.configform" + ".AUDIO_DEVICE_CONNECTED_REMOVED"));
      fieldsPanel.add(infoTextArea,BorderLayout.NORTH);
      fieldsPanel.add(panel,BorderLayout.CENTER);
      fieldsPanel.add(btnPanel,BorderLayout.SOUTH);
      TransparentPanel iconPanel=new TransparentPanel(new BorderLayout());
      iconPanel.add(new JLabel(resources.getImage("plugin.mediaconfig.AUDIO_ICON_64x64")),BorderLayout.NORTH);
      mainPanel.add(iconPanel,BorderLayout.WEST);
      mainPanel.add(fieldsPanel,BorderLayout.CENTER);
      audioConfigDialog.setTitle(resources.getI18NString("impl.media.configform.AUDIO_DEVICE_CONFIG"));
      audioConfigDialog.add(mainPanel);
      audioConfigDialog.validate();
      audioConfigDialog.pack();
      PortAudioDeviceChangedCallbacks.addDeviceChangedCallback(this);
    }
 catch (    Throwable t) {
      logger.info("Failed to create audio configuration panel",t);
      if (t instanceof ThreadDeath)       throw (ThreadDeath)t;
    }
  }
}
