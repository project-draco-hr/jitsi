{
  final JComboBox groupCombo=new JComboBox();
  groupCombo.setRenderer(new GroupComboRenderer());
  groupCombo.addItem(GuiActivator.getContactListService().getRoot());
  Iterator<MetaContactGroup> groupList=GuiActivator.getContactListService().getRoot().getSubgroups();
  while (groupList.hasNext()) {
    MetaContactGroup group=groupList.next();
    if (!group.isPersistent())     continue;
    groupCombo.addItem(group);
  }
  final String newGroupString=GuiActivator.getResources().getI18NString("service.gui.CREATE_GROUP");
  if (!ConfigurationUtils.isCreateGroupDisabled()) {
    groupCombo.addItem(newGroupString);
  }
  groupCombo.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      if (groupCombo.getSelectedItem().equals(newGroupString)) {
        CreateGroupDialog dialog=new CreateGroupDialog(parentDialog,false);
        dialog.setModal(true);
        dialog.setVisible(true);
        MetaContactGroup newGroup=dialog.getNewMetaGroup();
        if (newGroup != null) {
          groupCombo.insertItemAt(newGroup,groupCombo.getItemCount() - 2);
          groupCombo.setSelectedItem(newGroup);
        }
 else         groupCombo.setSelectedIndex(0);
      }
    }
  }
);
  return groupCombo;
}
