{
  if (AbstractIcbm.getIcbmChannel(packet) == CHANNEL_AUTH) {
    AuthOldMsgCmd messageCommand=new AuthOldMsgCmd(packet);
    int messageType=messageCommand.getMessageType();
    if (messageType == AuthOldMsgCmd.MTYPE_AUTHREQ) {
      AuthorizationRequest authRequest=new AuthorizationRequest();
      authRequest.setReason(messageCommand.getReason());
      AuthorizationResponse authResponse=authorizationHandler.processAuthorisationRequest(authRequest,operationSetPresence.findContactByID(String.valueOf(messageCommand.getSender())));
      if (authResponse.getResponseCode() == AuthorizationResponse.ACCEPT) {
        aimConnection.getInfoService().sendSnac(new AuthReplyCmd(String.valueOf(icqProvider.getAccountID().getAccountUserID()),authResponse.getReason(),true));
      }
 else       if (authResponse.getResponseCode() == AuthorizationResponse.REJECT) {
        aimConnection.getInfoService().sendSnac(new AuthReplyCmd(String.valueOf(icqProvider.getAccountID().getAccountUserID()),authResponse.getReason(),false));
      }
    }
 else     if (messageType == AuthOldMsgCmd.MTYPE_AUTHDENY) {
      AuthorizationResponse authResponse=new AuthorizationResponse(AuthorizationResponse.REJECT,messageCommand.getReason());
      authorizationHandler.processAuthorizationResponse(authResponse,operationSetPresence.findContactByID(String.valueOf(messageCommand.getSender())));
    }
 else     if (messageType == AuthOldMsgCmd.MTYPE_AUTHOK) {
      AuthorizationResponse authResponse=new AuthorizationResponse(AuthorizationResponse.ACCEPT,messageCommand.getReason());
      authorizationHandler.processAuthorizationResponse(authResponse,operationSetPresence.findContactByID(String.valueOf(messageCommand.getSender())));
    }
 else     if (messageType == AuthOldMsgCmd.MTYPE_ADDED) {
      logger.trace("User (" + messageCommand.getSender() + ") has added us to his contact list!");
    }
    return messageCommand;
  }
  return super.genSnacCommand(packet);
}
