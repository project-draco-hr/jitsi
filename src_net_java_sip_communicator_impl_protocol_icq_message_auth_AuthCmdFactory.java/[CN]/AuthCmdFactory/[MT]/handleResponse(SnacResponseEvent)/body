{
  if (snacResponseEvent.getSnacCommand() instanceof SsiDataModResponse) {
    SsiDataModResponse dataModResponse=(SsiDataModResponse)snacResponseEvent.getSnacCommand();
    int[] results=dataModResponse.getResults();
    List items=((ItemsCmd)snacResponseEvent.getRequest().getCommand()).getItems();
    items=new LinkedList(items);
    for (int i=0; i < results.length; i++) {
      int result=results[i];
      if (result == SsiDataModResponse.RESULT_ICQ_AUTH_REQUIRED) {
        SsiItem buddyItem=(SsiItem)items.get(i);
        String uinToAskForAuth=buddyItem.getName();
        logger.trace("finding buddy : " + uinToAskForAuth);
        Contact srcContact=operationSetPresence.findContactByID(uinToAskForAuth);
        if (srcContact == null)         srcContact=operationSetPresence.createVolatileContact(uinToAskForAuth);
        AuthorizationRequest authRequest=authorizationHandler.createAuthorizationRequest(srcContact);
        if (authRequest != null) {
          aimConnection.getIcbmService().sendSnac(new AuthFutureCmd(uinToAskForAuth,authRequest.getReason()));
          aimConnection.getIcbmService().sendSnac(new RequestAuthCmd(uinToAskForAuth,authRequest.getReason()));
          Vector buddiesToBeAdded=new Vector();
          BuddyAwaitingAuth newBuddy=new BuddyAwaitingAuth(buddyItem);
          items.add(newBuddy);
          CreateItemsCmd addCMD=new CreateItemsCmd(buddiesToBeAdded);
          logger.trace("Adding buddy as awaiting authorization");
          aimConnection.getIcbmService().sendSnac(addCMD);
          return;
        }
 else {
          logger.trace("AuthorizationRequest is NULL after calling " + "-> createAuthorizationRequest");
        }
      }
    }
  }
}
