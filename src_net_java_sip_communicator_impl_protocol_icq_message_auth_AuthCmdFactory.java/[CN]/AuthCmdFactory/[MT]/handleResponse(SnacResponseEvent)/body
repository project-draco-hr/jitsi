{
  if (snacResponseEvent.getSnacCommand() instanceof SsiDataModResponse) {
    SsiDataModResponse dataModResponse=(SsiDataModResponse)snacResponseEvent.getSnacCommand();
    int[] results=dataModResponse.getResults();
    List items=((ItemsCmd)snacResponseEvent.getRequest().getCommand()).getItems();
    items=new LinkedList(items);
    for (int i=0; i < results.length; i++) {
      int result=results[i];
      if (result == SsiDataModResponse.RESULT_ICQ_AUTH_REQUIRED) {
        SsiItem buddyItem=(SsiItem)items.get(i);
        String uinToAskForAuth=buddyItem.getName();
        logger.trace("finding buddy : " + uinToAskForAuth);
        Contact srcContact=operationSetPresence.findContactByID(uinToAskForAuth);
        if (srcContact == null)         srcContact=operationSetPresence.createUnresolvedContact(uinToAskForAuth,null,getGroupByID(buddyItem.getParentId()));
        AuthorizationRequest authRequest=authorizationHandler.createAuthorizationRequest(srcContact);
        if (authRequest != null) {
          Vector buddiesToBeAdded=new Vector();
          BuddyAwaitingAuth newBuddy=new BuddyAwaitingAuth(buddyItem);
          buddiesToBeAdded.add(newBuddy);
          CreateItemsCmd addCMD=new CreateItemsCmd(buddiesToBeAdded);
          logger.trace("Adding buddy as awaiting authorization");
          aimConnection.getSsiService().sendSnac(addCMD);
          aimConnection.getSsiService().sendSnac(new RequestAuthCmd(uinToAskForAuth,authRequest.getReason()));
          return;
        }
 else {
          logger.trace("AuthorizationRequest is NULL after calling " + "-> createAuthorizationRequest");
        }
      }
    }
  }
}
