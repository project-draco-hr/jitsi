{
  this.tree=tree;
  this.row=row;
  this.isSelected=selected;
  this.treeNode=(TreeNode)value;
  this.rightLabel.setIcon(null);
  DefaultTreeContactList contactList=(DefaultTreeContactList)tree;
  if (value instanceof ContactNode) {
    MetaContact metaContact=((ContactNode)value).getMetaContact();
    String displayName=metaContact.getDisplayName();
    if (displayName == null || displayName.length() < 1) {
      displayName=GuiActivator.getResources().getI18NString("service.gui.UNKNOWN");
    }
    this.nameLabel.setText(displayName);
    if (contactList.isMetaContactActive(metaContact)) {
      statusIcon.setImage(msgReceivedImage);
    }
 else {
      statusIcon.setImage(Constants.getStatusIcon(contactList.getMetaContactStatus(metaContact)));
    }
    this.statusLabel.setIcon(statusIcon);
    this.nameLabel.setFont(this.getFont().deriveFont(Font.PLAIN));
    if (contactForegroundColor != null)     this.nameLabel.setForeground(contactForegroundColor);
    this.initStatusMessage(metaContact);
    this.initButtonsPanel(metaContact);
    ImageIcon avatar=getAvatar(metaContact);
    if (avatar != null)     this.rightLabel.setIcon(avatar);
    this.rightLabel.setText("");
    this.setToolTipText(metaContact.getMetaUID());
  }
 else   if (value instanceof GroupNode) {
    MetaContactGroup groupItem=((GroupNode)value).getMetaContactGroup();
    this.nameLabel.setText(groupItem.getGroupName());
    this.nameLabel.setFont(this.getFont().deriveFont(Font.BOLD));
    if (groupForegroundColor != null)     this.nameLabel.setForeground(groupForegroundColor);
    this.remove(statusMessageLabel);
    this.remove(callButton);
    this.remove(chatButton);
    this.statusLabel.setIcon(expanded ? openedGroupIcon : closedGroupIcon);
    this.rightLabel.setIcon(null);
    this.rightLabel.setText(groupItem.countOnlineChildContacts() + "/" + groupItem.countChildContacts());
    this.setToolTipText(groupItem.getMetaUID());
  }
  return this;
}
