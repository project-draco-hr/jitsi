{
  this.tree=tree;
  this.row=row;
  this.isSelected=selected;
  this.treeNode=(TreeNode)value;
  this.rightLabel.setIcon(null);
  DefaultTreeContactList contactList=(DefaultTreeContactList)tree;
  if (value instanceof ContactNode) {
    UIContact contact=((ContactNode)value).getContactDescriptor();
    String displayName=contact.getDisplayName();
    if (displayName == null || displayName.trim().length() < 1) {
      displayName=GuiActivator.getResources().getI18NString("service.gui.UNKNOWN");
    }
    this.nameLabel.setText(displayName);
    if (contactList.isContactActive(contact)) {
      statusIcon.setImage(msgReceivedImage);
    }
 else {
      statusIcon=contact.getStatusIcon();
    }
    this.statusLabel.setIcon(statusIcon);
    this.nameLabel.setFont(this.getFont().deriveFont(Font.PLAIN));
    if (contactForegroundColor != null)     this.nameLabel.setForeground(contactForegroundColor);
    this.initDisplayDetails(contact);
    this.initButtonsPanel(contact);
    ImageIcon avatar=isSelected ? contact.getAvatar(isSelected,EXTENDED_AVATAR_WIDTH,EXTENDED_AVATAR_HEIGHT) : contact.getAvatar(isSelected,AVATAR_WIDTH,AVATAR_HEIGHT);
    if (avatar != null)     this.rightLabel.setIcon(avatar);
    this.rightLabel.setText("");
    this.setToolTipText(contact.getDescriptor().toString());
  }
 else   if (value instanceof GroupNode) {
    UIGroup groupItem=((GroupNode)value).getGroupDescriptor();
    this.nameLabel.setText(groupItem.getDisplayName());
    this.nameLabel.setFont(this.getFont().deriveFont(Font.BOLD));
    if (groupForegroundColor != null)     this.nameLabel.setForeground(groupForegroundColor);
    this.remove(displayDetailsLabel);
    this.remove(callButton);
    this.remove(chatButton);
    this.statusLabel.setIcon(expanded ? openedGroupIcon : closedGroupIcon);
    this.rightLabel.setIcon(null);
    if (groupItem.countChildContacts() >= 0)     this.rightLabel.setText(groupItem.countOnlineChildContacts() + "/" + groupItem.countChildContacts());
    this.setToolTipText(groupItem.getDescriptor().toString());
  }
  return this;
}
