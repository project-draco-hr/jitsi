{
  if (chatPanel == null) {
    setChatSession(null);
  }
 else {
    MetaContact contact=GuiActivator.getUIService().getChatContact(chatPanel);
    for (    PluginComponent c : pluginContainer.getPluginComponents())     c.setCurrentContact(contact);
    setChatSession(chatPanel.chatSession);
    leaveChatRoomButton.setEnabled(chatPanel.chatSession instanceof ConferenceChatSession);
    inviteButton.setEnabled(chatPanel.findInviteChatTransport() != null);
    sendFileButton.setEnabled(chatPanel.findFileTransferChatTransport() != null);
    new UpdateCallButtonWorker(chatSession,contact).start();
    new UpdateDesktopSharingButtonWorker(chatPanel.chatSession.getTransportsForOperationSet(OperationSetDesktopSharingServer.class)).start();
    changeHistoryButtonsState(chatPanel);
  }
}
