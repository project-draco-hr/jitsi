{
  this.messageWindow=messageWindow;
  this.setOpaque(false);
  this.setLayout(new FlowLayout(FlowLayout.LEFT,3,0));
  this.add(inviteButton);
  this.add(historyButton);
  this.add(optionsButton);
  this.add(sendFileButton);
  this.add(previousButton);
  this.add(nextButton);
  this.inviteButton.setName("invite");
  this.inviteButton.setToolTipText(GuiActivator.getResources().getI18NString("service.gui.INVITE"));
  this.historyButton.setName("history");
  this.historyButton.setToolTipText(GuiActivator.getResources().getI18NString("service.gui.HISTORY") + " Ctrl-H");
  this.optionsButton.setName("options");
  this.optionsButton.setToolTipText(GuiActivator.getResources().getI18NString("service.gui.OPTIONS"));
  this.sendFileButton.setName("sendFile");
  this.sendFileButton.setToolTipText(GuiActivator.getResources().getI18NString("service.gui.SEND_FILE"));
  this.previousButton.setName("previous");
  this.previousButton.setToolTipText(GuiActivator.getResources().getI18NString("service.gui.PREVIOUS"));
  this.nextButton.setName("next");
  this.nextButton.setToolTipText(GuiActivator.getResources().getI18NString("service.gui.NEXT"));
  this.inviteButton.addActionListener(this);
  this.historyButton.addActionListener(this);
  this.optionsButton.addActionListener(this);
  this.sendFileButton.addActionListener(this);
  this.previousButton.addActionListener(this);
  this.nextButton.addActionListener(this);
  this.initPluginComponents();
  this.messageWindow.addChatChangeListener(new ChatChangeListener(){
    public void chatChanged(    ChatPanel panel){
      if (panel == null)       return;
      MetaContact contact=GuiActivator.getUIService().getChatContact(panel);
      for (      Component c : getComponents()) {
        if (!(c instanceof PluginComponent))         continue;
        ((PluginComponent)c).setCurrentContact(contact);
      }
      if (panel.chatSession != null) {
        panel.chatSession.addChatTransportChangeListener(new ChatSessionChangeListener(){
          public void currentChatTransportChanged(          ChatSession chatSession){
            if (chatSession == null)             return;
            ChatTransport currentTransport=chatSession.getCurrentChatTransport();
            if (currentTransport.getDescriptor() instanceof Contact) {
              Contact contact=(Contact)currentTransport.getDescriptor();
              for (              Component c : getComponents()) {
                if (!(c instanceof PluginComponent))                 continue;
                ((PluginComponent)c).setCurrentContact(contact);
              }
            }
          }
        }
);
      }
    }
  }
);
}
