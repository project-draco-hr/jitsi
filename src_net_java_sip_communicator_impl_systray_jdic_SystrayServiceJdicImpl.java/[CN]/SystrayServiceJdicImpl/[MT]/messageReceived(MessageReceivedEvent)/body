{
  Chat chat=uiService.getChat(evt.getSourceContact());
  if (!chat.isChatFocused()) {
    String title=Resources.getString("messageReceived") + " " + evt.getSourceContact().getDisplayName();
    String message=evt.getSourceMessage().getContent();
    if (message.length() > 100)     message=message.substring(0,100).concat("...");
    GraphicsEnvironment ge=GraphicsEnvironment.getLocalGraphicsEnvironment();
    GraphicsDevice gs=ge.getDefaultScreenDevice();
    GraphicsConfiguration gc=gs.getDefaultConfiguration();
    BufferedImage img=gc.createCompatibleImage(logoIcon.getIconWidth(),logoIcon.getIconHeight(),Transparency.TRANSLUCENT);
    Image msgImg=new ImageIcon(Resources.getImage("messageIcon")).getImage();
    Graphics2D g=(Graphics2D)img.getGraphics();
    g.setRenderingHint(RenderingHints.KEY_ANTIALIASING,RenderingHints.VALUE_ANTIALIAS_ON);
    g.drawImage(logoIcon.getImage(),0,0,null);
    g.drawImage(msgImg,logoIcon.getIconWidth() / 2 - msgImg.getWidth(null) / 2,logoIcon.getIconHeight() / 2 - msgImg.getHeight(null) / 2,null);
    this.trayIcon.setIcon(new ImageIcon(img));
    this.trayIcon.displayMessage(title,message,TrayIcon.NONE_MESSAGE_TYPE);
    chat.addChatFocusListener(this);
  }
}
