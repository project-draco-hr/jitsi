{
  try {
    while (true) {
      AudioInputStream audioStream=AudioSystem.getAudioInputStream(url);
      AudioFormat audioStreamFormat=audioStream.getFormat();
      if (portAudioStream == 0) {
        int deviceIndex=PortAudioUtils.getDeviceIndexFromLocator(audioNotifier.getDeviceConfiguration().getAudioNotifyDevice().getLocator());
        long devInfo=PortAudio.Pa_GetDeviceInfo(deviceIndex);
        int maxOutChannels=PortAudio.PaDeviceInfo_getMaxOutputChannels(devInfo);
        int outChannels=audioStreamFormat.getChannels();
        if (outChannels > maxOutChannels)         outChannels=maxOutChannels;
        double sampleRate=audioStreamFormat.getSampleRate();
        long streamParameters=PortAudio.PaStreamParameters_new(deviceIndex,outChannels,PortAudioUtils.getPortAudioSampleFormat(audioStreamFormat.getSampleSizeInBits()));
        portAudioStream=PortAudio.Pa_OpenStream(0,streamParameters,sampleRate,PortAudio.FRAMES_PER_BUFFER_UNSPECIFIED,PortAudio.STREAM_FLAGS_NO_FLAG,null);
        PortAudio.Pa_StartStream(portAudioStream);
      }
      if (!started) {
        PortAudio.Pa_CloseStream(portAudioStream);
        return;
      }
      while (audioStream.read(buffer) != -1) {
        PortAudio.Pa_WriteStream(portAudioStream,buffer,buffer.length / audioStreamFormat.getFrameSize());
      }
      if (!isLooping()) {
        PortAudio.Pa_CloseStream(portAudioStream);
        break;
      }
 else {
        Thread.sleep(getLoopInterval());
      }
    }
  }
 catch (  PortAudioException e) {
    logger.error("Cannot open portaudio device for notifications",e);
  }
catch (  IOException e) {
    logger.error("Error reading from audio resource",e);
  }
catch (  InterruptedException e) {
    logger.error("Cannot wait the interval between plays",e);
  }
catch (  UnsupportedAudioFileException e) {
    logger.error("Unknown file format",e);
  }
}
