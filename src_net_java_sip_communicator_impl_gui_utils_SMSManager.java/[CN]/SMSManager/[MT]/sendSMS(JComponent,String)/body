{
  List<ProtocolProviderService> providers=AccountUtils.getRegisteredProviders(OperationSetSmsMessaging.class);
  if (providers.size() == 1) {
    sendSms(providers.get(0),to);
  }
 else   if (providers.size() > 1) {
    ChooseCallAccountPopupMenu chooseAccountDialog=new ChooseCallAccountPopupMenu(invoker,to,providers){
      @Override protected void itemSelected(      Class<? extends OperationSet> opSetClass,      ProtocolProviderService protocolProviderService,      String contact,      UIContactImpl uiContact){
        sendSms(protocolProviderService,to);
      }
      @Override protected void itemSelected(      Class<? extends OperationSet> opSetClass,      ProtocolProviderService protocolProviderService,      String contact){
        sendSms(protocolProviderService,to);
      }
    }
;
    chooseAccountDialog.setLocation(invoker.getLocation());
    chooseAccountDialog.showPopupMenu();
  }
}
