{
  System.arraycopy(iv,0,cipherInBlock,0,14);
  int ctr;
  for (ctr=0; ctr < length / BLKLEN; ctr++) {
    cipherInBlock[14]=(byte)((ctr & 0xFF00) >> 8);
    cipherInBlock[15]=(byte)((ctr & 0x00FF));
    aesCipher.processBlock(cipherInBlock,0,out,ctr * BLKLEN);
  }
  cipherInBlock[14]=(byte)((ctr & 0xFF00) >> 8);
  cipherInBlock[15]=(byte)((ctr & 0x00FF));
  aesCipher.processBlock(cipherInBlock,0,tmpCipherBlock,0);
  System.arraycopy(tmpCipherBlock,0,out,ctr * BLKLEN,length % BLKLEN);
}
