{
  IceMediaStream stream=null;
  MediaStreamTarget streamTarget=null;
  String mediaName=null;
  if (mediaType == MediaType.AUDIO) {
    mediaName="rtp";
  }
 else   if (mediaType == MediaType.VIDEO) {
    mediaName="video_rtp";
  }
 else {
    logger.error("Not an audio/rtp mediatype");
    return null;
  }
  stream=iceAgent.getStream(mediaName);
  if (stream != null) {
    InetSocketAddress[] streamTargetAddresses=new InetSocketAddress[COMPONENT_IDS.length];
    int streamTargetAddressCount=0;
    for (int i=0; i < COMPONENT_IDS.length; i++) {
      Component component=stream.getComponent(COMPONENT_IDS[i]);
      if (component != null) {
        CandidatePair selectedPair=component.getSelectedPair();
        if (selectedPair != null) {
          InetSocketAddress streamTargetAddress=selectedPair.getRemoteCandidate().getTransportAddress();
          if (streamTargetAddress != null) {
            streamTargetAddresses[i]=streamTargetAddress;
            streamTargetAddressCount++;
          }
        }
      }
    }
    if (streamTargetAddressCount > 0) {
      int rtcpIndex=1;
      if (mediaName.equals("rtp") && streamTargetAddressCount == 1) {
        rtcpIndex=0;
      }
      streamTarget=new MediaStreamTarget(streamTargetAddresses[0],streamTargetAddresses[rtcpIndex]);
    }
  }
  return streamTarget;
}
