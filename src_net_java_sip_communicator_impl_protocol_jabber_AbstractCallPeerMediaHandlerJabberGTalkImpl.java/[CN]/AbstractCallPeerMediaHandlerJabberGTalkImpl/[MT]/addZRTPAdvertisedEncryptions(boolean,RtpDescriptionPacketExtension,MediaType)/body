{
  EncryptionPacketExtension encryptionPacketExtension=description.getFirstChildOfType(EncryptionPacketExtension.class);
  if (encryptionPacketExtension != null) {
    AccountID accountID=getPeer().getProtocolProvider().getAccountID();
    if (accountID.getAccountPropertyBoolean(ProtocolProviderFactory.DEFAULT_ENCRYPTION,true) && accountID.isEncryptionProtocolEnabled(ZrtpControl.PROTO_NAME) && getPeer().getCall().isSipZrtpAttribute()) {
      ZrtpHashPacketExtension zrtpHashPacketExtension=encryptionPacketExtension.getFirstChildOfType(ZrtpHashPacketExtension.class);
      if ((zrtpHashPacketExtension != null) && (zrtpHashPacketExtension.getValue() != null)) {
        addAdvertisedEncryptionMethod(SrtpControlType.ZRTP);
      }
    }
  }
}
