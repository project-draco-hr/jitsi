{
  EncryptionPacketExtension encryptionPacketExtension=description.getFirstChildOfType(EncryptionPacketExtension.class);
  if (encryptionPacketExtension != null) {
    AccountID accountID=getPeer().getProtocolProvider().getAccountID();
    ZrtpHashPacketExtension zrtpHashPacketExtension=encryptionPacketExtension.getFirstChildOfType(ZrtpHashPacketExtension.class);
    if (zrtpHashPacketExtension != null && zrtpHashPacketExtension.getValue() != null && accountID.getAccountPropertyBoolean(ProtocolProviderFactory.DEFAULT_ENCRYPTION,true) && accountID.isEncryptionProtocolEnabled("ZRTP") && getPeer().getCall().isSipZrtpAttribute()) {
      addAdvertisedEncryptionMethod(SrtpControlType.ZRTP);
    }
  }
}
