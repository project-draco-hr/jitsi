{
  EncryptionPacketExtension encryptionPacketExtension=description.getFirstChildOfType(EncryptionPacketExtension.class);
  if (encryptionPacketExtension != null) {
    AccountID accountID=getPeer().getProtocolProvider().getAccountID();
    if (accountID.getAccountPropertyBoolean(ProtocolProviderFactory.DEFAULT_ENCRYPTION,true) && accountID.isEncryptionProtocolEnabled(SDesControl.PROTO_NAME)) {
      SrtpControls srtpControls=getSrtpControls();
      SDesControl sdesControl=(SDesControl)srtpControls.getOrCreate(mediaType,SrtpControlType.SDES);
      SrtpCryptoAttribute selectedSdes=selectSdesCryptoSuite(isInitiator,sdesControl,encryptionPacketExtension);
      if (selectedSdes != null) {
        removeAndCleanupOtherSrtpControls(mediaType,SrtpControlType.SDES);
        addAdvertisedEncryptionMethod(SrtpControlType.SDES);
      }
 else {
        sdesControl.cleanup();
        srtpControls.remove(mediaType,SrtpControlType.SDES);
      }
    }
  }
 else   if (isInitiator) {
    SrtpControl scontrol=getSrtpControls().remove(mediaType,SrtpControlType.SDES);
    if (scontrol != null)     scontrol.cleanup();
  }
}
