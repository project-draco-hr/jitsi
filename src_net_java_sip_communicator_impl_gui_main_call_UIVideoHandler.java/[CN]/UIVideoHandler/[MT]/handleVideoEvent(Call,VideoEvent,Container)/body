{
  if (videoEvent != null) {
    if ((videoEvent.getOrigin() == VideoEvent.REMOTE) && (videoEvent instanceof SizeChangeVideoEvent)) {
      SizeChangeVideoEvent sizeChangeVideoEvent=(SizeChangeVideoEvent)videoEvent;
      Component visualComponent=sizeChangeVideoEvent.getVisualComponent();
      int width=sizeChangeVideoEvent.getWidth();
      int height=sizeChangeVideoEvent.getHeight();
      if (visualComponent.getParent() == null) {
        visualComponent.setPreferredSize(new Dimension(width,height + 30));
      }
 else       if (isAncestor(videoContainer,visualComponent)) {
        if (!callRenderer.getCallContainer().getCallWindow().equals(GuiActivator.getUIService().getSingleWindowContainer())) {
          callRenderer.ensureSize(visualComponent,width,height);
        }
        videoContainer.doLayout();
      }
      return;
    }
switch (videoEvent.getType()) {
case VideoEvent.VIDEO_ADDED:
case VideoEvent.VIDEO_REMOVED:
      break;
default :
    return;
}
}
videoContainer.removeAll();
memberVisualComponents.clear();
Iterator<? extends CallPeer> callPeerIter=call.getCallPeers();
List<Component> remoteVideos=new LinkedList<Component>();
while (callPeerIter.hasNext()) {
CallPeer peer=callPeerIter.next();
List<Component> visualComponents=videoTelephony.getVisualComponents(peer);
boolean peerVisualComponentAdded=false;
if (visualComponents != null && visualComponents.size() > 0) {
  callRenderer.getCallContainer().addRemoteVideoSpecificComponents(peer);
  for (int i=0; i < visualComponents.size(); i++) {
    Component visualComponent=visualComponents.get(i);
    Container remoteVideoParent=visualComponent.getParent();
    if (remoteVideoParent != null)     remoteVideoParent.remove(visualComponent);
    ConferenceMember conferenceMember=videoTelephony.getConferenceMember(peer,visualComponent);
    Component peerToolbar=null;
    if (callRenderer instanceof VideoConferenceCallPanel) {
      if (call.isConferenceFocus() || (conferenceMember == null && peer.isConferenceFocus()) || (conferenceMember != null && CallManager.addressesAreEqual(conferenceMember.getAddress(),peer.getAddress()))) {
        peerToolbar=peerToolbars.get(peer);
        peerVisualComponentAdded=true;
      }
 else       if (conferenceMember != null) {
        peerToolbar=memberToolbars.get(conferenceMember);
        memberVisualComponents.put(conferenceMember,visualComponent);
      }
 else {
        peerToolbar=createDefaultVideoToolbar(peer);
      }
    }
    if (peerToolbar != null) {
      Container toolbarParent=peerToolbar.getParent();
      if (toolbarParent != null)       toolbarParent.remove(peerToolbar);
      JPanel remoteVideoPanel=new TransparentPanel(new BorderLayout());
      remoteVideoPanel.add(visualComponent);
      remoteVideoPanel.add(peerToolbar,BorderLayout.SOUTH);
      remoteVideos.add(remoteVideoPanel);
    }
 else     remoteVideos.add(visualComponent);
  }
  if (callRenderer instanceof VideoConferenceCallPanel) {
    if (!peerVisualComponentAdded) {
      remoteVideos.add(createDefaultPhotoPanel(peer,peerToolbars.get(peer)));
    }
    for (    ConferenceMember member : peer.getConferenceMembers()) {
      if (memberVisualComponents.get(member) == null) {
        Component defaultPhotoPanel=null;
        if (!CallManager.isLocalUser(member) && !CallManager.addressesAreEqual(member.getAddress(),peer.getAddress()) && memberToolbars.get(member) != null) {
          defaultPhotoPanel=createDefaultPhotoPanel(member,memberToolbars.get(member));
        }
        if (defaultPhotoPanel != null)         remoteVideos.add(defaultPhotoPanel);
      }
    }
  }
}
 else if (callRenderer instanceof VideoConferenceCallPanel) {
  remoteVideos.add(createDefaultPhotoPanel(peer,peerToolbars.get(peer)));
  for (  ConferenceMember member : peer.getConferenceMembers()) {
    if (!CallManager.isLocalUser(member) && !CallManager.addressesAreEqual(member.getAddress(),peer.getAddress())) {
      remoteVideos.add(createDefaultPhotoPanel(member,memberToolbars.get(member)));
    }
  }
}
}
if (remoteVideos.isEmpty()) {
callRenderer.getCallContainer().removeRemoteVideoSpecificComponents();
}
 else {
for (Component remoteVideo : remoteVideos) {
  videoContainer.add(remoteVideo,VideoLayout.CENTER_REMOTE,0);
}
}
if (localVideo != null) {
Container localVideoParent=localVideo.getParent();
if (localVideoParent != null) localVideoParent.remove(localVideo);
Container closeButtonParent=closeButton.getParent();
if (closeButtonParent != null) closeButtonParent.remove(closeButton);
if (localVideoToolbar != null) {
  Container toolbarParent=localVideoToolbar.getParent();
  if (toolbarParent != null)   toolbarParent.remove(localVideoToolbar);
}
if (localVideoVisible) {
  if (localVideoToolbar != null && (callRenderer instanceof VideoConferenceCallPanel)) {
    JPanel localVideoPanel=new TransparentPanel(new BorderLayout());
    localVideoPanel.add(localVideo,BorderLayout.CENTER);
    localVideoPanel.add(localVideoToolbar,BorderLayout.SOUTH);
    videoContainer.add(localVideoPanel,VideoLayout.LOCAL,0);
  }
 else   videoContainer.add(localVideo,VideoLayout.LOCAL,0);
  if (!CallManager.isDesktopSharingEnabled(call)) {
    videoContainer.add(closeButton,VideoLayout.CLOSE_LOCAL_BUTTON,0);
  }
}
}
 else if ((callRenderer instanceof VideoConferenceCallPanel) && localVideoToolbar != null) {
videoContainer.add(createDefaultPhotoPanel(call.getProtocolProvider(),localVideoToolbar),VideoLayout.LOCAL,0);
}
videoContainer.validate();
videoContainer.repaint();
}
