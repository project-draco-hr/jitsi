{
  RegistrationState currRegState=getRegistrationState();
  if (fireEvent)   fireRegistrationStateChanged(currRegState,RegistrationState.UNREGISTERING,RegistrationStateChangeEvent.REASON_USER_REQUEST,null);
synchronized (initializationLock) {
    if ((messenger != null) && !logoutReceived)     messenger.logout();
    persistentPresence.setMessenger(null);
    typingNotifications.setMessenger(null);
  }
  if (fireEvent && messenger != null)   fireRegistrationStateChanged(currRegState,RegistrationState.UNREGISTERED,RegistrationStateChangeEvent.REASON_USER_REQUEST,null);
}
