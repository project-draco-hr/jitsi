{
  if (evt.getSource() instanceof ProtocolProviderService) {
    if (evt.getNewState().equals(RegistrationState.UNREGISTERED) || evt.getNewState().equals(RegistrationState.CONNECTION_FAILED)) {
      removeProviderFromLastStates(evt.getProvider());
    }
 else     if (evt.getNewState().equals(RegistrationState.REGISTERED)) {
      if (lastStates.size() == 0) {
        start();
      }
    }
  }
}
