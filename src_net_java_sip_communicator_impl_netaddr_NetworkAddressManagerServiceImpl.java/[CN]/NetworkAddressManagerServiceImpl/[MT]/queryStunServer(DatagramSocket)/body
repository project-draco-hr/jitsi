{
  StunAddress mappedAddress=null;
  if (detector != null && useStun) {
    mappedAddress=detector.getMappingFor(sock);
    if (logger.isTraceEnabled()) {
      logger.trace("For socket with address " + sock.getLocalAddress().getHostAddress() + " and port "+ sock.getLocalPort()+ " the stun server returned the "+ "following mapping ["+ mappedAddress+ "]");
    }
  }
  return mappedAddress;
}
