{
  Format inputFormat=super.setInputFormat(format);
  if (inputFormat != null) {
    double outputSampleRate;
    int outputChannels;
    if (outputFormat == null) {
      outputSampleRate=Format.NOT_SPECIFIED;
      outputChannels=Format.NOT_SPECIFIED;
    }
 else {
      AudioFormat outputAudioFormat=(AudioFormat)outputFormat;
      outputSampleRate=outputAudioFormat.getSampleRate();
      outputChannels=outputAudioFormat.getChannels();
    }
    AudioFormat inputAudioFormat=(AudioFormat)inputFormat;
    double inputSampleRate=inputAudioFormat.getSampleRate();
    int inputChannels=inputAudioFormat.getChannels();
    if ((outputSampleRate != inputSampleRate) || (outputChannels != inputChannels)) {
      setOutputFormat(new AudioFormat(AudioFormat.LINEAR,inputSampleRate,16,inputChannels,AudioFormat.LITTLE_ENDIAN,AudioFormat.SIGNED,Format.NOT_SPECIFIED,Format.NOT_SPECIFIED,Format.byteArray));
    }
  }
  return inputFormat;
}
