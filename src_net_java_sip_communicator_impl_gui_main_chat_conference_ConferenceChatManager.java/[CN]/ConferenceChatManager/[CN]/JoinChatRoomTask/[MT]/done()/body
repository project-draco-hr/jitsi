{
  String returnCode=null;
  try {
    returnCode=get();
  }
 catch (  InterruptedException ignore) {
  }
catch (  ExecutionException ignore) {
  }
  ConfigurationUtils.updateChatRoomStatus(chatRoomWrapper.getParentProvider().getProtocolProvider(),chatRoomWrapper.getChatRoomID(),GlobalStatusEnum.ONLINE_STATUS);
  String errorMessage=null;
  if (AUTHENTICATION_FAILED.equals(returnCode)) {
    chatRoomWrapper.removePassword();
    AuthenticationWindowService authWindowsService=ServiceUtils.getService(GuiActivator.bundleContext,AuthenticationWindowService.class);
    AuthenticationWindowService.AuthenticationWindow authWindow=authWindowsService.create(null,null,null,false,chatRoomWrapper.isPersistent(),ImageLoader.getAuthenticationWindowIcon(chatRoomWrapper.getParentProvider().getProtocolProvider()),GuiActivator.getResources().getI18NString("service.gui.AUTHENTICATION_WINDOW_TITLE",new String[]{chatRoomWrapper.getParentProvider().getName()}),GuiActivator.getResources().getI18NString("service.gui.CHAT_ROOM_REQUIRES_PASSWORD",new String[]{chatRoomWrapper.getChatRoomName()}),"",null,isFirstAttempt ? null : GuiActivator.getResources().getI18NString("service.gui.AUTHENTICATION_FAILED",new String[]{chatRoomWrapper.getChatRoomName()}),null);
    authWindow.setVisible(true);
    if (!authWindow.isCanceled()) {
      GuiActivator.getUIService().getConferenceChatManager().joinChatRoom(chatRoomWrapper,nickName,new String(authWindow.getPassword()).getBytes(),authWindow.isRememberPassword(),false);
    }
  }
 else   if (REGISTRATION_REQUIRED.equals(returnCode)) {
    errorMessage=GuiActivator.getResources().getI18NString("service.gui.CHAT_ROOM_REGISTRATION_REQUIRED",new String[]{chatRoomWrapper.getChatRoomName()});
  }
 else   if (PROVIDER_NOT_REGISTERED.equals(returnCode)) {
    errorMessage=GuiActivator.getResources().getI18NString("service.gui.CHAT_ROOM_NOT_CONNECTED",new String[]{chatRoomWrapper.getChatRoomName()});
  }
 else   if (SUBSCRIPTION_ALREADY_EXISTS.equals(returnCode)) {
    errorMessage=GuiActivator.getResources().getI18NString("service.gui.CHAT_ROOM_ALREADY_JOINED",new String[]{chatRoomWrapper.getChatRoomName()});
  }
 else {
    errorMessage=GuiActivator.getResources().getI18NString("service.gui.FAILED_TO_JOIN_CHAT_ROOM",new String[]{chatRoomWrapper.getChatRoomName()});
  }
  if (!SUCCESS.equals(returnCode) && !AUTHENTICATION_FAILED.equals(returnCode)) {
    new ErrorDialog(GuiActivator.getUIService().getMainFrame(),GuiActivator.getResources().getI18NString("service.gui.ERROR"),errorMessage).showDialog();
  }
  if (SUCCESS.equals(returnCode) && rememberPassword) {
    chatRoomWrapper.savePassword(new String(password));
  }
}
