{
  List<Contact> contacts=new LinkedList<Contact>();
  BundleContext bc=FacebookActivator.getBundleContext();
  String osgiQuery="(" + ProtocolProviderFactory.PROTOCOL + "=Facebook)";
  ServiceReference[] refs=null;
  try {
    refs=bc.getServiceReferences(ProtocolProviderService.class.getName(),osgiQuery);
  }
 catch (  InvalidSyntaxException ex) {
    logger.error("Failed to execute the following osgi query: " + osgiQuery,ex);
  }
  if (refs != null)   for (  ServiceReference ref : refs) {
    ProtocolProviderServiceFacebookImpl gibProvider=(ProtocolProviderServiceFacebookImpl)bc.getService(ref);
    OperationSetPersistentPresenceFacebookImpl opSetPersPresence=(OperationSetPersistentPresenceFacebookImpl)gibProvider.getOperationSet(OperationSetPersistentPresence.class);
    Contact contact=opSetPersPresence.findContactByID(parentProvider.getAccountID().getUserID());
    if (contact != null)     contacts.add(contact);
  }
  return contacts;
}
