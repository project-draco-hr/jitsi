{
  ChatWindow chatWindow=getChatWindow();
  ChatPanel chatPanel=new ChatPanel(chatWindow);
  AdHocConferenceChatSession chatSession=new AdHocConferenceChatSession(chatPanel,chatRoomWrapper);
  chatPanel.setChatSession(chatSession);
synchronized (chatPanels) {
    this.chatPanels.add(chatPanel);
  }
  if (ConfigurationManager.isHistoryShown())   chatPanel.loadHistory(escapedMessageID);
synchronized (newChatListeners) {
    for (    ChatListener listener : newChatListeners) {
      listener.chatCreated(chatPanel);
    }
  }
  return chatPanel;
}
