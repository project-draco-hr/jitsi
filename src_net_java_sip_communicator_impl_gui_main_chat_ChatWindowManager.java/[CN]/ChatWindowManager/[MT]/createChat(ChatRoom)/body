{
  ChatWindow chatWindow;
  if (Constants.TABBED_CHAT_WINDOW)   chatWindow=this.chatWindow;
 else {
    chatWindow=new ChatWindow(mainFrame);
    GuiActivator.getUIService().registerExportedWindow(chatWindow);
    this.chatWindow=chatWindow;
  }
  ChatPanel chatPanel=new ConferenceChatPanel(chatWindow,chatRoom);
synchronized (chats) {
    this.chats.put(chatRoom,chatPanel);
  }
  return chatPanel;
}
