{
  ChatPanel selectedChat=null;
  Iterator chatPanelsIter=chatPanels.iterator();
synchronized (syncChat) {
    if (ConfigurationManager.isMultiChatWindowEnabled()) {
      if (chatPanelsIter.hasNext()) {
        ChatPanel firstChatPanel=(ChatPanel)chatPanelsIter.next();
        selectedChat=firstChatPanel.getChatWindow().getCurrentChatPanel();
      }
    }
 else {
      while (chatPanelsIter.hasNext()) {
        ChatPanel chatPanel=(ChatPanel)chatPanelsIter.next();
        if (chatPanel.getChatWindow().isFocusOwner())         selectedChat=chatPanel;
      }
    }
    return selectedChat;
  }
}
