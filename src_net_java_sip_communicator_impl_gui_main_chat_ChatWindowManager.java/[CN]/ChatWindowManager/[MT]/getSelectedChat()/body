{
  ChatPanel selectedChat=null;
  Enumeration chatPanels=chats.keys();
synchronized (syncChat) {
    if (ConfigurationManager.isMultiChatWindowEnabled()) {
      if (chatPanels.hasMoreElements()) {
        ChatPanel firstChatPanel=(ChatPanel)chatPanels.nextElement();
        selectedChat=firstChatPanel.getChatWindow().getCurrentChatPanel();
      }
    }
 else {
      while (chatPanels.hasMoreElements()) {
        ChatPanel chatPanel=(ChatPanel)chatPanels.nextElement();
        if (chatPanel.getChatWindow().isFocusOwner())         selectedChat=chatPanel;
      }
    }
    return selectedChat;
  }
}
