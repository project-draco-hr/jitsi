{
  Properties fileProps=new Properties();
  InputStream in=null;
  try {
    in=new BufferedInputStream(new FileInputStream(file));
    fileProps.load(in);
    Iterator<Map.Entry<Object,Object>> it=fileProps.entrySet().iterator();
    while (it.hasNext()) {
      Map.Entry<Object,Object> entry=it.next();
      String key=(String)entry.getKey();
      Object value=entry.getValue();
      if (value instanceof String) {
        if (((String)value).equals("${null}")) {
          getConfigurationService().removeProperty(key);
          continue;
        }
      }
      if (key.endsWith(".PASSWORD")) {
        getCredentialsStorageService().storePassword(key.substring(0,key.lastIndexOf(".")),(String)value);
      }
 else {
        getConfigurationService().setProperty(key,value);
      }
    }
    getConfigurationService().storeConfiguration();
    try {
      getConfigurationService().reloadConfiguration();
    }
 catch (    Exception e) {
      logger.error("Cannot reload configuration");
    }
  }
 catch (  IOException e) {
    logger.warn("Error during load of provisioning file");
  }
 finally {
    try {
      in.close();
      file.delete();
    }
 catch (    IOException e) {
    }
  }
}
