{
  int M=Ld8k.M;
  int j;
  float tmp;
  float tdist=0.0f;
  for (j=0; j < M; j++) {
    tmp=(buf[j] - rbuf[j]) * fg_sum[j];
    tdist+=wegt[j] * tmp * tmp;
  }
  return tdist;
}
