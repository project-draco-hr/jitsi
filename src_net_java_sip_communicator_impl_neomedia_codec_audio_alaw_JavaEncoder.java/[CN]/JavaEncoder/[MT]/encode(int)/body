{
  int sign=(pcm & 0x8000) >> 8;
  if (sign != 0)   pcm=-pcm;
  if (pcm > MAX)   pcm=MAX;
  int exponent=7;
  for (int expMask=0x4000; (pcm & expMask) == 0 && exponent > 0; exponent--, expMask>>=1) {
  }
  int mantissa=(pcm >> ((exponent == 0) ? 4 : (exponent + 3))) & 0x0f;
  byte alaw=(byte)(sign | exponent << 4 | mantissa);
  return (byte)(alaw ^ 0xD5);
}
