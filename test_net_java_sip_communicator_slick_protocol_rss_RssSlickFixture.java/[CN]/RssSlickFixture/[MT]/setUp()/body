{
  ServiceReference[] serRefs=null;
  String osgiFilter="(" + ProtocolProviderFactory.PROTOCOL + "="+ ProtocolNames.RSS+ ")";
  try {
    serRefs=bc.getServiceReferences(ProtocolProviderFactory.class.getName(),osgiFilter);
  }
 catch (  InvalidSyntaxException ise) {
    fail(osgiFilter + "is not a valid OSGi filter");
  }
  assertTrue("Failed to find a provider factory service for protocol RSS",serRefs != null && serRefs.length > 0);
  providerFactory=(ProtocolProviderFactory)bc.getService(serRefs[0]);
  ServiceReference[] rssProviderRefs=bc.getServiceReferences(ProtocolProviderService.class.getName(),"(&(" + ProtocolProviderFactory.PROTOCOL + "="+ ProtocolNames.RSS+ "))");
  assertNotNull("No protocol provider was found for RSS account ",rssProviderRefs);
  assertTrue("No protocol provider was found for RSS account",rssProviderRefs.length > 0);
  providerServiceReference=rssProviderRefs[0];
  provider=(ProtocolProviderService)bc.getService(providerServiceReference);
}
