{
  MediaFormat mediaFormat=createMediaFormat(encoding,clockRate,channels,formatParams);
  if (mediaFormat == null)   return null;
  Map<String,String> formatParameters=null;
  Map<String,String> advancedParameters=null;
  if ((formatParams != null) && !formatParams.isEmpty())   formatParameters=formatParams;
  if ((advancedParams != null) && !advancedParams.isEmpty())   advancedParameters=advancedParams;
  if ((formatParameters != null) || (advancedParameters != null)) {
switch (mediaFormat.getMediaType()) {
case AUDIO:
      mediaFormat=new AudioMediaFormatImpl(((AudioMediaFormatImpl)mediaFormat).getFormat(),formatParameters,advancedParameters);
    break;
case VIDEO:
  VideoMediaFormatImpl videoMediaFormatImpl=(VideoMediaFormatImpl)mediaFormat;
mediaFormat=new VideoMediaFormatImpl(videoMediaFormatImpl.getFormat(),videoMediaFormatImpl.getClockRate(),formatParameters,advancedParameters);
break;
default :
mediaFormat=null;
}
}
return mediaFormat;
}
