{
  MediaFormat mediaFormat=createMediaFormat(encoding,clockRate,channels);
  if ((mediaFormat != null) && (formatParams != null) && !formatParams.isEmpty()) {
    Map<String,String> formatParameters=new HashMap<String,String>();
    formatParameters.putAll(mediaFormat.getFormatParameters());
    formatParameters.putAll(formatParams);
switch (mediaFormat.getMediaType()) {
case AUDIO:
      mediaFormat=new AudioMediaFormatImpl(((AudioMediaFormatImpl)mediaFormat).getFormat(),formatParameters);
    break;
case VIDEO:
  VideoMediaFormatImpl videoMediaFormatImpl=(VideoMediaFormatImpl)mediaFormat;
mediaFormat=new VideoMediaFormatImpl(videoMediaFormatImpl.getFormat(),videoMediaFormatImpl.getClockRate(),formatParameters);
break;
default :
mediaFormat=null;
}
}
return mediaFormat;
}
