{
  if (devices != null)   return devices;
  CaptureDeviceInfo[] infos;
switch (type) {
case AUDIO_CAPTURE:
    infos=deviceConfiguration.getAvailableAudioCaptureDevices(DeviceConfiguration.AUDIO_SYSTEM_PORTAUDIO);
  break;
case AUDIO_NOTIFY:
case AUDIO_PLAYBACK:
infos=deviceConfiguration.getAvailableAudioPlaybackDevices();
break;
case VIDEO:
infos=deviceConfiguration.getAvailableVideoCaptureDevices(MediaUseCase.CALL);
break;
default :
throw new IllegalStateException("type");
}
final int deviceCount=infos.length;
devices=new CaptureDevice[deviceCount + 1];
for (int i=0; i < deviceCount; i++) {
devices[i]=new CaptureDevice(infos[i]);
}
devices[deviceCount]=new CaptureDevice(null);
return devices;
}
