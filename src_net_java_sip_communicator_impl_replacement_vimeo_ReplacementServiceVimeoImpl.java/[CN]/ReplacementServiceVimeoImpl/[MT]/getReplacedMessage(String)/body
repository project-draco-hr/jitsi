{
  final Pattern p=Pattern.compile(VIMEO_PATTERN,Pattern.CASE_INSENSITIVE | Pattern.DOTALL);
  Matcher m=p.matcher(chatString);
  int count=0, startPos=0;
  StringBuffer msgBuff=new StringBuffer();
  while (m.find()) {
    count++;
    msgBuff.append(chatString.substring(startPos,m.start()));
    startPos=m.end();
    if (count % 2 == 0) {
      try {
        String url="http://vimeo.com/api/v2/video/" + m.group(3) + ".json";
        URL vimeoURL=new URL(url);
        URLConnection conn=vimeoURL.openConnection();
        BufferedReader in=new BufferedReader(new InputStreamReader(conn.getInputStream()));
        String inputLine, holder="";
        while ((inputLine=in.readLine()) != null)         holder=inputLine;
        in.close();
        JSONArray result=new JSONArray(holder);
        if (!(result.length() == 0)) {
          msgBuff.append("<IMG HEIGHT=\"150\" WIDTH=\"200\" SRC=\"");
          msgBuff.append(result.getJSONObject(0).getString("thumbnail_medium"));
          msgBuff.append("\"></IMG>");
        }
 else {
          startPos=0;
          msgBuff=new StringBuffer();
        }
      }
 catch (      Exception e) {
        startPos=0;
        msgBuff=new StringBuffer();
        e.printStackTrace();
      }
    }
 else {
      msgBuff.append(chatString.substring(m.start(),m.end()));
    }
  }
  msgBuff.append(chatString.substring(startPos));
  if (!msgBuff.toString().equals(chatString))   return msgBuff.toString();
  return chatString;
}
