{
  String lastStatus=getLastStatusString(protocolProvider);
  OperationSetPresence presence=mainFrame.getProtocolPresenceOpSet(protocolProvider);
  if (presence == null)   return null;
  Iterator i=presence.getSupportedStatusSet();
  if (lastStatus != null) {
    PresenceStatus status;
    while (i.hasNext()) {
      status=(PresenceStatus)i.next();
      if (status.getStatusName().equals(lastStatus)) {
        return status;
      }
    }
  }
  return null;
}
