{
  StatusSelectorBox protocolStatusCombo;
  int providerIndex=this.mainFrame.getProviderIndex(protocolProvider);
  if (mainFrame.getProtocolPresenceOpSet(protocolProvider) != null) {
    protocolStatusCombo=new PresenceStatusSelectorBox(this.mainFrame,protocolProvider,providerIndex);
  }
 else {
    protocolStatusCombo=new SimpleStatusSelectorBox(this.mainFrame,protocolProvider,providerIndex);
  }
  protocolStatusCombo.addComponentListener(this);
  boolean isHidden=protocolProvider.getAccountID().getAccountProperties().get("HIDDEN_PROTOCOL") != null;
  if (isHidden)   hiddenProviders++;
  if (protocolStatusCombos.size() - hiddenProviders == 1 && !isHidden) {
    this.globalStatusBox=new GlobalStatusSelectorBox(mainFrame);
    Icon statusSeparatorIcon=new ImageIcon(ImageLoader.getImage(ImageLoader.STATUS_SEPARATOR_ICON));
    this.add(new JLabel(statusSeparatorIcon),FlowLayout.LEFT);
    this.add(globalStatusBox,FlowLayout.LEFT);
  }
  this.protocolStatusCombos.put(protocolProvider,protocolStatusCombo);
  if (!isHidden) {
    this.add(protocolStatusCombo);
    this.getParent().validate();
  }
}
