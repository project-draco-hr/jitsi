{
  Transaction transaction;
  if (transactionTerminatedEvent.isServerTransaction())   transaction=transactionTerminatedEvent.getServerTransaction();
 else   transaction=transactionTerminatedEvent.getClientTransaction();
  if (transaction == null) {
    logger.debug("ignoring a transactionless transaction terminated event");
    return;
  }
  Request request=transaction.getRequest();
  logger.debug("Transaction terminated for req=" + request);
  String method=request.getMethod();
  List<MethodProcessor> processors=methodProcessors.get(method);
  if (processors != null) {
    logger.debug("Found " + processors.size() + " processor(s) for method "+ method);
    for (Iterator<MethodProcessor> processorIter=processors.iterator(); processorIter.hasNext(); ) {
      if (processorIter.next().processTransactionTerminated(transactionTerminatedEvent)) {
        break;
      }
    }
  }
}
