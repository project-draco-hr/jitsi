{
  ContactHeader registrationContactHeader=null;
  ListeningPoint srcListeningPoint=getListeningPoint(intendedDestination);
  InetAddress targetAddress=getIntendedDestination(intendedDestination);
  try {
    InetAddress localAddress=SipActivator.getNetworkAddressManagerService().getLocalHost(targetAddress);
    SipURI contactURI=addressFactory.createSipURI(getAccountID().getUserID(),localAddress.getHostAddress());
    contactURI.setTransportParam(srcListeningPoint.getTransport());
    contactURI.setPort(srcListeningPoint.getPort());
    if (getContactAddressCustomParamValue() != null) {
      contactURI.setParameter(SipStackSharing.CONTACT_ADDRESS_CUSTOM_PARAM_NAME,getContactAddressCustomParamValue());
    }
    Address contactAddress=addressFactory.createAddress(contactURI);
    if (ourDisplayName != null) {
      contactAddress.setDisplayName(ourDisplayName);
    }
    registrationContactHeader=headerFactory.createContactHeader(contactAddress);
    logger.debug("generated contactHeader:" + registrationContactHeader);
  }
 catch (  ParseException ex) {
    logger.error("A ParseException occurred while creating From Header!",ex);
    throw new IllegalArgumentException("A ParseException occurred while creating From Header!",ex);
  }
  return registrationContactHeader;
}
