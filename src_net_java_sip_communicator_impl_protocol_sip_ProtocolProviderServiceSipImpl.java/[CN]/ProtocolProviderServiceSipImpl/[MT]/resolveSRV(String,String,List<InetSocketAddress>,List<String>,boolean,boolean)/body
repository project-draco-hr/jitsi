{
  InetSocketAddress[] socketAddresses=null;
  SRVRecord srvRecords[]=null;
  if (srvQueryString) {
    srvRecords=NetworkUtils.getSRVRecords(address);
  }
 else {
    srvRecords=NetworkUtils.getSRVRecords(transport.equalsIgnoreCase(ListeningPoint.TLS) ? "sips" : "sip",transport.equalsIgnoreCase(ListeningPoint.UDP) ? ListeningPoint.UDP : ListeningPoint.TCP,address);
  }
  if (srvRecords != null) {
    socketAddresses=new InetSocketAddress[srvRecords.length];
    for (int i=0; i < srvRecords.length; i++) {
      socketAddresses[i]=srvRecords[i].getInetSocketAddress();
    }
  }
  if (socketAddresses != null) {
    ArrayList<InetSocketAddress> tempResultAddresses=new ArrayList<InetSocketAddress>();
    for (    InetSocketAddress s : socketAddresses) {
      try {
        resolveAddresses(s.getAddress().getHostName(),tempResultAddresses,preferIPv6Addresses,s.getPort());
      }
 catch (      UnknownHostException e) {
        logger.warn("Address unknown:" + s.getHostName(),e);
      }
      if (!tempResultAddresses.contains(s))       tempResultAddresses.add(s);
      if (logger.isTraceEnabled())       logger.trace("Returned SRV " + s);
    }
    for (    InetSocketAddress a : tempResultAddresses) {
      if (!resultAddresses.contains(a)) {
        resultAddresses.add(a);
        resultTransports.add(transport);
      }
    }
  }
}
