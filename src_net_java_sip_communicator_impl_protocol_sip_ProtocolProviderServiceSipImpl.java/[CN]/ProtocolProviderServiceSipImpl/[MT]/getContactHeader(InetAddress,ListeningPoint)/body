{
  ContactHeader registrationContactHeader=null;
  try {
    InetSocketAddress localAddress=SipActivator.getNetworkAddressManagerService().getPublicAddressFor(targetAddress,srcListeningPoint.getPort());
    SipURI contactURI=addressFactory.createSipURI(((SipURI)ourSipAddress.getURI()).getUser(),localAddress.getAddress().getHostAddress());
    contactURI.setTransportParam(srcListeningPoint.getTransport());
    contactURI.setPort(localAddress.getPort());
    Address contactAddress=addressFactory.createAddress(contactURI);
    if (ourDisplayName != null) {
      contactAddress.setDisplayName(ourDisplayName);
    }
    registrationContactHeader=headerFactory.createContactHeader(contactAddress);
    logger.debug("generated contactHeader:" + registrationContactHeader);
  }
 catch (  ParseException ex) {
    logger.error("A ParseException occurred while creating From Header!",ex);
    throw new OperationFailedException("A ParseException occurred while creating From Header!",OperationFailedException.INTERNAL_ERROR,ex);
  }
  return registrationContactHeader;
}
