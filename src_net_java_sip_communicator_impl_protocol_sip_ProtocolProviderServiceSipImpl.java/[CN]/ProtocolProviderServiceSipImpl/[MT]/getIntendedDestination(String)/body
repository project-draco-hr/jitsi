{
  InetSocketAddress destinationInetAddress=null;
  InetSocketAddress outboundProxy=connection.getAddress();
  if (outboundProxy != null) {
    if (logger.isTraceEnabled())     logger.trace("Will use proxy address");
    destinationInetAddress=outboundProxy;
  }
 else {
    ProxyConnection tempConn=new AutoProxyConnection((SipAccountID)getAccountID(),host,getDefaultTransport());
    try {
      if (tempConn.getNextAddress())       destinationInetAddress=tempConn.getAddress();
 else       throw new IllegalArgumentException(host + " could not be resolved to an internet address.");
    }
 catch (    DnssecException e) {
      logger.error("unable to obtain next hop address",e);
    }
  }
  if (logger.isDebugEnabled())   logger.debug("Returning address " + destinationInetAddress + " for destination "+ host);
  return destinationInetAddress;
}
