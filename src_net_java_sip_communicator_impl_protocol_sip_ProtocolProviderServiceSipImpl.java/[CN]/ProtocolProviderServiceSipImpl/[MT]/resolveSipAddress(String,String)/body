{
  ArrayList<InetSocketAddress> resultAddresses=new ArrayList<InetSocketAddress>();
  if (NetworkUtils.isValidIPAddress(address)) {
    InetAddress addressObj=NetworkUtils.getInetAddress(address);
    int port=ListeningPoint.PORT_5060;
    if (transport.equalsIgnoreCase(ListeningPoint.TLS))     port=ListeningPoint.PORT_5061;
    resultAddresses.add(new InetSocketAddress(addressObj,port));
    return resultAddresses.toArray(new InetSocketAddress[]{});
  }
  boolean preferIPv6Addresses=Boolean.getBoolean("java.net.preferIPv6Addresses");
  try {
    InetSocketAddress[] sockAddrs=NetworkUtils.getSRVRecords(transport.equalsIgnoreCase(ListeningPoint.TLS) ? "sips" : "sip",ListeningPoint.TCP,address);
    if (sockAddrs != null) {
      for (      InetSocketAddress s : sockAddrs) {
        resolveAddresses(s.getHostName(),resultAddresses,preferIPv6Addresses,s.getPort());
        resultAddresses.add(s);
        if (logger.isTraceEnabled())         logger.trace("Returned SRV " + s);
      }
    }
  }
 catch (  ParseException e) {
    logger.error("Error parsing dns record.",e);
  }
  int defaultPort=ListeningPoint.PORT_5060;
  if (transport.equalsIgnoreCase(ListeningPoint.TLS))   defaultPort=ListeningPoint.PORT_5061;
  resolveAddresses(address,resultAddresses,preferIPv6Addresses,defaultPort);
  if (resultAddresses.size() == 0) {
    resultAddresses.add(new InetSocketAddress(address,defaultPort));
    InetAddress addressObj=InetAddress.getByName(address);
  }
  return resultAddresses.toArray(new InetSocketAddress[]{});
}
