{
  if (logger.isDebugEnabled())   logger.debug("Update checker [STARTED]");
  UpdateActivator.bundleContext=bundleContext;
  if (OSUtils.IS_WINDOWS) {
    updateService=new Update();
    bundleContext.registerService(UpdateService.class.getName(),updateService,null);
    ConfigurationService cfg=getConfiguration();
    if (!cfg.getBoolean(CHECK_FOR_UPDATES_MENU_DISABLED_PROP,false)) {
      CheckForUpdatesMenuItemComponent checkForUpdatesMenuItemComponent=new CheckForUpdatesMenuItemComponent(Container.CONTAINER_HELP_MENU);
      Hashtable<String,String> toolsMenuFilter=new Hashtable<String,String>();
      toolsMenuFilter.put(Container.CONTAINER_ID,Container.CONTAINER_HELP_MENU.getID());
      bundleContext.registerService(PluginComponent.class.getName(),checkForUpdatesMenuItemComponent,toolsMenuFilter);
    }
    if (cfg.getBoolean(UPDATE_ENABLED,true))     updateService.checkForUpdates(false);
  }
  if (logger.isDebugEnabled())   logger.debug("Update checker [REGISTERED]");
  if (configuration.getBoolean(CHECK_FOR_UPDATES_DAILY_ENABLED_PROP,false)) {
    logger.info("Scheduled update checking enabled");
    int hoursToWait=calcHoursToWait();
    Runnable updateRunnable=new Runnable(){
      public void run(){
        logger.debug("Performing scheduled update check");
        getUpdateService().checkForUpdates(false);
      }
    }
;
    mUpdateExecutor=Executors.newSingleThreadScheduledExecutor();
    mUpdateExecutor.scheduleAtFixedRate(updateRunnable,hoursToWait,24,TimeUnit.HOURS);
  }
}
