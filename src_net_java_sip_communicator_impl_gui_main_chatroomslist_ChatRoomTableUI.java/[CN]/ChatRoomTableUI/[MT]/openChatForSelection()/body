{
  Object selectedValue=this.chatRoomsTableModel.getValueAt(this.chatRoomList.getSelectedRow());
  ChatRoomWrapper chatRoomWrapper;
  if (selectedValue instanceof ChatRoomWrapper)   chatRoomWrapper=(ChatRoomWrapper)selectedValue;
 else   return;
  if (chatRoomWrapper.getChatRoom() == null) {
    chatRoomWrapper=GuiActivator.getUIService().getConferenceChatManager().createChatRoom(chatRoomWrapper.getChatRoomName(),chatRoomWrapper.getParentProvider().getProtocolProvider(),new ArrayList<String>(),"",false,true);
    if (chatRoomWrapper.getChatRoom().isJoined())     chatRoomWrapper.getChatRoom().leave();
    this.chatRoomsTableModel.setValueAt(chatRoomWrapper,this.chatRoomList.getSelectedRow(),this.chatRoomList.getSelectedColumn());
  }
  String savedNick=ConfigurationUtils.getChatRoomProperty(chatRoomWrapper.getParentProvider().getProtocolProvider(),chatRoomWrapper.getChatRoomID(),"userNickName");
  if (savedNick == null) {
    String nickName=null;
    ChatOperationReasonDialog reasonDialog=new ChatOperationReasonDialog(GuiActivator.getResources().getI18NString("service.gui.CHANGE_NICKNAME"),GuiActivator.getResources().getI18NString("service.gui.CHANGE_NICKNAME_LABEL"));
    reasonDialog.setReasonFieldText(chatRoomWrapper.getChatRoom().getUserNickname());
    int result=reasonDialog.showDialog();
    if (result == MessageDialog.OK_RETURN_CODE) {
      nickName=reasonDialog.getReason().trim();
      ConfigurationUtils.updateChatRoomProperty(chatRoomWrapper.getParentProvider().getProtocolProvider(),chatRoomWrapper.getChatRoomID(),"userNickName",nickName);
    }
    if (!chatRoomWrapper.getChatRoom().isJoined()) {
      GuiActivator.getUIService().getConferenceChatManager().joinChatRoom(chatRoomWrapper,nickName,null);
    }
  }
 else {
    if (!chatRoomWrapper.getChatRoom().isJoined())     GuiActivator.getUIService().getConferenceChatManager().joinChatRoom(chatRoomWrapper,savedNick,null);
  }
  ChatWindowManager chatWindowManager=GuiActivator.getUIService().getChatWindowManager();
  ChatPanel chatPanel=chatWindowManager.getMultiChat(chatRoomWrapper,true);
  chatWindowManager.openChat(chatPanel,true);
}
