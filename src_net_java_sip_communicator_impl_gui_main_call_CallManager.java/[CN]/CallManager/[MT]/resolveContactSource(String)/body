{
  String displayName=null;
  if (!StringUtils.isNullOrEmpty(peerAddress)) {
    Vector<ResolveAddressToDisplayNameContactQueryListener> resolvers=new Vector<ResolveAddressToDisplayNameContactQueryListener>(1,1);
    for (    ContactSourceService contactSourceService : GuiActivator.getContactSources()) {
      ContactQuery query=contactSourceService.queryContactSource(peerAddress,1);
      resolvers.add(new ResolveAddressToDisplayNameContactQueryListener(query));
    }
    long startTime=System.currentTimeMillis();
    long currentTime=startTime;
    long timeout=500;
    while (displayName == null && currentTime - startTime < timeout) {
      for (int i=0; i < resolvers.size() && displayName == null; ++i) {
        ResolveAddressToDisplayNameContactQueryListener resolver=resolvers.get(i);
        if (!resolver.isRunning()) {
          if (resolver.isFound()) {
            displayName=resolver.getResolvedName();
            if (displayName.equals(peerAddress)) {
              displayName=null;
            }
          }
        }
      }
      Thread.yield();
      currentTime=System.currentTimeMillis();
    }
    for (int i=0; i < resolvers.size(); ++i) {
      ResolveAddressToDisplayNameContactQueryListener resolver=resolvers.get(i);
      if (resolver.isRunning()) {
        resolver.stop();
      }
    }
  }
  return displayName;
}
