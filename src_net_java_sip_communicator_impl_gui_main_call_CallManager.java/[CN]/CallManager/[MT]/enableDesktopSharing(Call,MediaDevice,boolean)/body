{
  OperationSetDesktopSharingServer desktopOpSet=call.getProtocolProvider().getOperationSet(OperationSetDesktopSharingServer.class);
  boolean enableSucceeded=false;
  if (desktopOpSet != null) {
    if (enable && isLocalVideoEnabled(call))     enableLocalVideo(call,false);
    if (!enable || showDesktopSharingWarning()) {
      try {
        if (mediaDevice != null)         desktopOpSet.setLocalVideoAllowed(call,mediaDevice,enable);
 else         desktopOpSet.setLocalVideoAllowed(call,enable);
        enableSucceeded=true;
      }
 catch (      OperationFailedException ex) {
        logger.error("Failed to toggle the streaming of local video.",ex);
      }
    }
  }
  if (enable && !enableSucceeded)   getActiveCallContainer(call).setDesktopSharingButtonSelected(false);
}
