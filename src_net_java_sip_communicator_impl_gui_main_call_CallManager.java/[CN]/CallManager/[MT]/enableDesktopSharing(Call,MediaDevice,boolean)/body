{
  OperationSetDesktopSharingServer desktopOpSet=call.getProtocolProvider().getOperationSet(OperationSetDesktopSharingServer.class);
  if (desktopOpSet == null)   return;
  if (!isEnable || showDesktopSharingWarning()) {
    try {
      boolean isDesktopSharing=desktopOpSet.isLocalVideoAllowed(call);
      CallDialog callDialog=activeCalls.get(call);
      callDialog.setDesktopSharing(!isDesktopSharing);
      if (mediaDevice != null)       desktopOpSet.setLocalVideoAllowed(call,mediaDevice,!isDesktopSharing);
 else       desktopOpSet.setLocalVideoAllowed(call,!isDesktopSharing);
    }
 catch (    OperationFailedException ex) {
      logger.error("Failed to toggle the streaming of local video.",ex);
    }
  }
}
