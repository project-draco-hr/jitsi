{
  try {
    DocumentBuilderFactory factory=DocumentBuilderFactory.newInstance();
    DocumentBuilder builder=factory.newDocumentBuilder();
    Map<String,Object> props=new Hashtable<String,Object>();
    if (file.length() < "<sip-communicator>".length() * 2)     propertiesDocument=createPropertiesDocument();
 else     propertiesDocument=builder.parse(file);
    Node root=propertiesDocument.getFirstChild();
    Node currentNode=null;
    NodeList children=root.getChildNodes();
    for (int i=0; i < children.getLength(); i++) {
      currentNode=children.item(i);
      if (currentNode.getNodeType() == Node.ELEMENT_NODE) {
        String propertyName=DOMElementWriter.decodeName(currentNode.getNodeName());
        loadNode(currentNode,propertyName,props);
      }
    }
    return props;
  }
 catch (  SAXException ex) {
    logger.error("Error parsing configuration file",ex);
    throw new XMLException(ex.getMessage(),ex);
  }
catch (  ParserConfigurationException ex) {
    logger.error("Error finding configuration for default parsers",ex);
    return new Hashtable<String,Object>();
  }
}
