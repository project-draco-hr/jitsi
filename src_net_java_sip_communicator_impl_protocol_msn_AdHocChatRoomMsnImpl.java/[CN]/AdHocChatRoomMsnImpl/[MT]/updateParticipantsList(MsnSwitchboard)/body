{
  MsnContact[] contacts=switchboard.getAllContacts();
  for (  MsnContact msnContact : contacts) {
    if (!this.participants.containsKey(msnContact.getId())) {
      ContactMsnImpl contact=presenceOpSet.getServerStoredContactList().findContactById(msnContact.getEmail().getEmailAddress());
      if (contact == null)       contact=new ContactMsnImpl(msnContact,presenceOpSet.getServerStoredContactList(),false,false);
      this.participants.put(msnContact.getId(),contact);
      fireParticipantPresenceEvent((Contact)contact,AdHocChatRoomParticipantPresenceChangeEvent.CONTACT_JOINED,null);
    }
  }
  for (  String contactAddress : this.pendingInvitations) {
    this.invite(contactAddress,"");
  }
  pendingInvitations.clear();
}
