{
synchronized (streamReadThreadSyncRoot) {
    started=true;
    if (streamReadThread == null) {
      streamReadThread=new Thread(){
        @Override public void run(){
          try {
            while (true) {
synchronized (streamReadThreadSyncRoot) {
                if (!started)                 break;
                if (streamReadThread != Thread.currentThread())                 break;
              }
              runInStreamReadThread();
            }
          }
  finally {
synchronized (streamReadThreadSyncRoot) {
              if (streamReadThread == Thread.currentThread()) {
                streamReadThread=null;
                streamReadThreadSyncRoot.notifyAll();
              }
            }
          }
        }
      }
;
      streamReadThread.start();
    }
  }
}
