{
  if (devices != null)   return devices;
  DeviceConfiguration deviceConfiguration=getDeviceConfiguration();
  CaptureDeviceInfo[] infos;
switch (type) {
case AUDIO:
    infos=deviceConfiguration.getAvailableAudioCaptureDevices();
  break;
case VIDEO:
infos=deviceConfiguration.getAvailableVideoCaptureDevices();
break;
default :
throw new IllegalStateException("type");
}
final int deviceCount=infos.length;
devices=new CaptureDevice[deviceCount + 1];
for (int i=0; i < deviceCount; i++) {
devices[i]=new CaptureDevice(infos[i]);
}
devices[deviceCount]=new CaptureDevice(null);
return devices;
}
