{
  super(IcbmCommand.CMD_ICBM,packet);
  DefensiveTools.checkNull(packet,"packet");
  ByteBlock snacData=getChannelData();
  userInfo=FullUserInfo.readUserInfo(snacData);
  ByteBlock tlvBlock=snacData.subBlock(userInfo.getTotalSize());
  TlvChain chain=TlvTools.readChain(tlvBlock);
  Tlv messageDataTlv=chain.getLastTlv(TYPE_MESSAGE_DATA);
  ByteBlock messageData=messageDataTlv.getData();
  sender=LEBinaryTools.getUInt(messageData,0);
  messageType=LEBinaryTools.getUByte(messageData,4);
  short msgFlags=LEBinaryTools.getUByte(messageData,5);
  int textlen=LEBinaryTools.getUShort(messageData,6) - 1;
  ByteBlock field=messageData.subBlock(8,textlen);
  reason=OscarTools.getString(field,"US-ASCII");
  if (messageType == MTYPE_AUTHREQ) {
    System.out.println("user " + sender + " asks you for authorisation");
  }
 else   if (messageType == MTYPE_AUTHDENY) {
    System.out.println("user " + sender + " has denied your authorization request\n"+ "with reason : "+ reason);
  }
 else   if (messageType == MTYPE_AUTHOK) {
    System.out.println("user " + sender + " has denied your authorization request");
  }
 else   if (messageType == MTYPE_ADDED) {
    System.out.println("user " + sender + " has added you to contact list!");
  }
 else {
    System.out.println("unknown message for channel 4 of type 0x" + Integer.toHexString(messageType));
  }
}
