{
  super();
  this.chatPanel=panel;
  this.rightButtonMenu=new WritePanelRightButtonMenu(chatPanel.getChatWindow());
  this.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);
  this.editorPane.setFont(Constants.FONT);
  this.editorPane.setEditorKit(styledEditor);
  this.editorPane.getDocument().addUndoableEditListener(this);
  this.editorPane.addKeyListener(this);
  this.editorPane.addMouseListener(this);
  this.editorPane.getActionMap().put("send",new SendMessageAction());
  this.editorPane.getActionMap().put("newLine",new NewLineAction());
  InputMap im=this.editorPane.getInputMap();
  im.put(KeyStroke.getKeyStroke(KeyEvent.VK_ENTER,0),"send");
  im.put(KeyStroke.getKeyStroke(KeyEvent.VK_ENTER,KeyEvent.CTRL_DOWN_MASK),"newLine");
  this.getViewport().add(editorPane,BorderLayout.CENTER);
  this.setBorder(BorderFactory.createCompoundBorder(BorderFactory.createEmptyBorder(3,3,3,3),SIPCommBorders.getBoldRoundBorder()));
  this.getVerticalScrollBar().setUnitIncrement(30);
  this.typingTimer.setRepeats(true);
}
