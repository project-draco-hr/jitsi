{
  this.ssrc=ssrc;
  this.mki=null;
  this.roc=roc;
  this.guessedROC=0;
  this.seqNum=0;
  this.keyDerivationRate=keyDerivationRate;
  this.seqNumSet=false;
  this.policy=policy;
  this.masterKey=new byte[masterKey.length];
  System.arraycopy(masterKey,0,this.masterKey,0,this.masterKey.length);
  this.masterSalt=new byte[masterSalt.length];
  System.arraycopy(masterSalt,0,this.masterSalt,0,this.masterSalt.length);
switch (policy.getEncType()) {
case SRTPPolicy.NULL_ENCRYPTION:
    this.encKey=null;
  this.saltKey=null;
break;
case SRTPPolicy.AESCM_ENCRYPTION:
case SRTPPolicy.AESF8_ENCRYPTION:
this.encKey=new byte[this.policy.getEncKeyLength()];
this.saltKey=new byte[this.policy.getSaltKeyLength()];
break;
}
switch (policy.getAuthType()) {
case SRTPPolicy.NULL_AUTHENTICATION:
this.authKey=null;
break;
case SRTPPolicy.HMACSHA1_AUTHENTICATION:
this.authKey=new byte[policy.getAuthKeyLength()];
break;
}
}
