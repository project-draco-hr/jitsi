{
  long key_id;
  if (kdv == 0) {
    key_id=label << 48;
  }
 else {
    key_id=((label << 48) | (index / kdv));
  }
  for (int i=0; i < 7; i++) {
    iv[i]=masterSalt[i];
  }
  for (int i=7; i < 14; i++) {
    iv[i]=(byte)((byte)(0xFF & (key_id >> (8 * (13 - i)))) ^ masterSalt[i]);
  }
  iv[14]=iv[15]=0;
}
