{
  long label=0;
  computeIv(label,index);
  KeyParameter encryptionKey=new KeyParameter(masterKey);
  AEScipher.init(true,encryptionKey);
  cipherCtr.getCipherStream(AEScipher,encKey,policy.getEncKeyLength(),ivStore);
  if (authKey != null) {
    label=0x01;
    computeIv(label,index);
    cipherCtr.getCipherStream(AEScipher,authKey,policy.getAuthKeyLength(),ivStore);
    KeyParameter key=new KeyParameter(authKey);
    hmacSha1.init(key);
  }
  label=0x02;
  computeIv(label,index);
  cipherCtr.getCipherStream(AEScipher,saltKey,policy.getSaltKeyLength(),ivStore);
  encryptionKey=new KeyParameter(encKey);
  AEScipher.init(true,encryptionKey);
}
