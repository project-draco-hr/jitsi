{
  int seqNum=PacketManipulator.GetRTPSequenceNumber(pkt);
  if (!checkReplay(seqNum)) {
    return false;
  }
  if (this.policy.getAuthType() == SRTPPolicy.HMACSHA1_AUTHENTICATION) {
    int tagLength=this.policy.getAuthTagLength();
    byte[] originalTag=pkt.readRegion(pkt.getLength() - tagLength,tagLength);
    pkt.shrink(tagLength);
    long guessedIndex=guessIndex(seqNum);
    int guessedRoc=(int)(guessedIndex >> 16);
    byte[] calculatedTag=authenticatePacketHMCSHA1(pkt,guessedRoc);
    for (int i=0; i < tagLength; i++) {
      if ((originalTag[i] & 0xff) == (calculatedTag[i] & 0xff))       continue;
 else       return false;
    }
  }
  if (this.policy.getEncType() == SRTPPolicy.AESCM_ENCRYPTION) {
    processPacketAESCM(pkt);
  }
 else   if (this.policy.getEncType() == SRTPPolicy.AESF8_ENCRYPTION) {
    processPacketAESF8(pkt);
  }
  update(seqNum);
  return true;
}
