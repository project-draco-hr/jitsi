{
  if (this.policy.getEncType() == SRTPPolicy.AESCM_ENCRYPTION) {
    processPacketAESCM(pkt);
  }
 else   if (this.policy.getEncType() == SRTPPolicy.AESF8_ENCRYPTION) {
    processPacketAESF8(pkt);
  }
  if (this.policy.getAuthType() == SRTPPolicy.HMACSHA1_AUTHENTICATION) {
    byte[] tag=authenticatePacketHMCSHA1(pkt,this.roc);
    pkt.append(tag,policy.getAuthTagLength());
  }
  int seqNum=PacketManipulator.GetRTPSequenceNumber(pkt);
  if (seqNum == 0xFFFF) {
    this.roc++;
  }
}
