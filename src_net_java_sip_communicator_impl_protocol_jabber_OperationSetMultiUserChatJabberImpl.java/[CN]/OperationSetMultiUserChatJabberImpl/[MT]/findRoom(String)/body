{
  assertSupportedAndConnected();
  ChatRoom room=(ChatRoom)chatRoomCache.get(roomName);
  if (room != null) {
    return room;
  }
 else {
    MultiUserChat muc=new MultiUserChat(getXmppConnection(),roomName);
    try {
      muc.create(getXmppConnection().getUser());
    }
 catch (    XMPPException ex) {
      logger.error("Failed to create chat room.",ex);
      throw new OperationFailedException("Failed to create chat room",ex.getXMPPError().getCode(),ex.getCause());
    }
    return createLocalChatRoomInstance(muc);
  }
}
