{
  boolean selected=false;
  if (chatEditorPane.getSelectedText() == null) {
    int index=chatEditorPane.getCaretPosition();
    selected=((HTMLDocument)chatEditorPane.getDocument()).getCharacterElement(index - 1).getAttributes().containsAttribute(styleConstant,true);
  }
 else {
    for (int index=chatEditorPane.getSelectionStart(); index < chatEditorPane.getSelectionEnd(); index++) {
      AttributeSet attributes=((HTMLDocument)chatEditorPane.getDocument()).getCharacterElement(index).getAttributes();
      selected=selected || attributes.containsAttribute(styleConstant,true);
    }
  }
  if (chatEditorPane.getText().length() > 0)   button.setSelected(selected);
}
