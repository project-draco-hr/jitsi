{
  Object selectedAttribute=null;
  if (chatEditorPane.getSelectedText() == null) {
    int index=chatEditorPane.getCaretPosition();
    selectedAttribute=((HTMLDocument)chatEditorPane.getDocument()).getCharacterElement(index - 1).getAttributes().getAttribute(styleConstant);
  }
 else {
    for (int index=chatEditorPane.getSelectionStart(); index < chatEditorPane.getSelectionEnd(); index++) {
      AttributeSet attributes=((HTMLDocument)chatEditorPane.getDocument()).getCharacterElement(index).getAttributes();
      if (attributes.getAttribute(styleConstant) != null)       selectedAttribute=attributes.getAttribute(styleConstant);
    }
  }
  if (selectedAttribute != null)   colorLabel.setBackground((Color)selectedAttribute);
 else   colorLabel.setBackground(Color.BLACK);
}
