{
  float FLT_MAX_G729=Ld8k.FLT_MAX_G729;
  int M=Ld8k.M;
  int NC=Ld8k.NC;
  int NC1=Ld8k.NC1;
  int j, k1;
  float[] buf=new float[M];
  float dist, dmin, tmp;
  for (j=0; j < NC; j++)   buf[j]=rbuf[j] - lspcb1[j];
  int index=0;
  dmin=FLT_MAX_G729;
  for (k1=0; k1 < NC1; k1++) {
    dist=0.f;
    for (j=0; j < NC; j++) {
      tmp=buf[j] - lspcb2[k1][j];
      dist+=wegt[j] * tmp * tmp;
    }
    if (dist < dmin) {
      dmin=dist;
      index=k1;
    }
  }
  return index;
}
