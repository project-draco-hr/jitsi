{
  NotificationService notificationService=GuiActivator.getNotificationService();
  if (notificationService == null)   return;
  NotificationActionHandler popupActionHandler=null;
  Chat chatPanel=null;
  byte[] contactIcon=null;
  if (chatContact instanceof Contact) {
    Contact contact=(Contact)chatContact;
    chatPanel=GuiActivator.getUIService().getChat(contact);
    contactIcon=contact.getImage();
    if (contactIcon == null) {
      contactIcon=ImageUtils.toByteArray(ImageLoader.getImage(ImageLoader.DEFAULT_USER_PHOTO));
    }
  }
 else   if (chatContact instanceof ChatRoom) {
    ChatRoom chatRoom=(ChatRoom)chatContact;
    if (chatRoom.isSystem())     return;
    chatPanel=GuiActivator.getUIService().getChat(chatRoom);
  }
  if (chatPanel != null) {
    if (eventType.equals(INCOMING_MESSAGE) && chatPanel.isChatFocused()) {
      popupActionHandler=notificationService.getEventNotificationActionHandler(eventType,NotificationService.ACTION_POPUP_MESSAGE);
      popupActionHandler.setEnabled(false);
    }
  }
  notificationService.fireNotification(eventType,messageTitle,message,contactIcon,chatContact);
  if (popupActionHandler != null)   popupActionHandler.setEnabled(true);
}
