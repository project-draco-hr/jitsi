{
  if (callPeer.getDialog().isServer()) {
    logger.error("Cannot cancel a server transaction");
    throw new OperationFailedException("Cannot cancel a server transaction",OperationFailedException.INTERNAL_ERROR);
  }
  ClientTransaction clientTransaction=(ClientTransaction)callPeer.getFirstTransaction();
  try {
    Request cancel=clientTransaction.createCancel();
    ClientTransaction cancelTransaction=callPeer.getJainSipProvider().getNewClientTransaction(cancel);
    cancelTransaction.sendRequest();
    logger.debug("sent request:\n" + cancel);
  }
 catch (  SipException ex) {
    ProtocolProviderServiceSipImpl.throwOperationFailedException("Failed to send the CANCEL request",OperationFailedException.NETWORK_FAILURE,ex,logger);
  }
}
