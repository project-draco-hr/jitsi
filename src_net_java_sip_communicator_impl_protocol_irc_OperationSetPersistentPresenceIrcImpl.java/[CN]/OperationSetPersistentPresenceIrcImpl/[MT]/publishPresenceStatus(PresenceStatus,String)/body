{
  final IrcConnection connection=this.parentProvider.getIrcStack().getConnection();
  if (connection == null) {
    throw new IllegalStateException("Connection is not available.");
  }
  if (statusMessage != null && statusMessage.isEmpty()) {
    statusMessage=null;
  }
  if (status.getStatus() >= IrcStatusEnum.AVAILABLE_THRESHOLD) {
    connection.getPresenceManager().away(false,statusMessage);
  }
 else   if (status.getStatus() >= IrcStatusEnum.AWAY_THRESHOLD) {
    connection.getPresenceManager().away(true,statusMessage);
  }
}
