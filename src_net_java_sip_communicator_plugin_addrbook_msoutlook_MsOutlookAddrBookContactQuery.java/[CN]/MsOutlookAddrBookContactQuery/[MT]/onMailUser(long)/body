{
  Object[] props=IMAPIProp_GetProps(iUnknown,MAPI_MAILUSER_PROP_IDS,MAPI_UNICODE);
  boolean matches=false;
  for (  Object prop : props) {
    if ((prop instanceof String) && ((String)prop).toLowerCase().contains(query)) {
      matches=true;
      break;
    }
  }
  if (matches) {
    List<ContactDetail> contactDetails=new LinkedList<ContactDetail>();
    for (int i=0; i < CONTACT_DETAIL_PROP_INDEXES.length; i++) {
      Object prop=props[CONTACT_DETAIL_PROP_INDEXES[i]];
      if (prop instanceof String) {
        String stringProp=(String)prop;
        if (stringProp.length() != 0)         contactDetails.add(new ContactDetail(stringProp));
      }
    }
    SourceContact sourceContact=new AddrBookSourceContact(getContactSource(),(String)props[PR_DISPLAY_NAME_INDEX],contactDetails);
    addQueryResult(sourceContact);
  }
  return (getStatus() == QUERY_IN_PROGRESS);
}
