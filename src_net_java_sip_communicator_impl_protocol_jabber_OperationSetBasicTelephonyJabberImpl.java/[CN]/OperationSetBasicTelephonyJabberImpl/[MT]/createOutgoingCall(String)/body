{
  OutgoingJingleSession outJS;
  if (logger.isInfoEnabled())   logger.info("creating outgoing call...");
  if (protocolProvider.getConnection() == null) {
    throw new OperationFailedException("Failed to create OutgoingJingleSession.\n" + "we don't have a valid XMPPConnection.",OperationFailedException.INTERNAL_ERROR);
  }
  String fullCalleeURI=null;
  if (calleeAddress.indexOf('/') > 0) {
    fullCalleeURI=calleeAddress;
  }
 else {
    fullCalleeURI=protocolProvider.getConnection().getRoster().getPresence(calleeAddress).getFrom();
  }
  if (fullCalleeURI.indexOf('/') < 0) {
    throw new OperationFailedException("Failed to create OutgoingJingleSession.\n" + "User " + calleeAddress + " is unknown to us.",OperationFailedException.INTERNAL_ERROR);
  }
  try {
    DiscoverInfo di=ServiceDiscoveryManager.getInstanceFor(protocolProvider.getConnection()).discoverInfo(fullCalleeURI);
    if (di.containsFeature(ProtocolProviderServiceJabberImpl.URN_XMPP_JINGLE)) {
      if (logger.isInfoEnabled())       logger.info(fullCalleeURI + ": jingle supported ");
    }
 else {
      logger.info(calleeAddress + ": jingle not supported ??? ");
    }
  }
 catch (  XMPPException ex) {
    logger.warn("could not retrieve info for " + fullCalleeURI,ex);
  }
  try {
    outJS=jingleManager.createOutgoingJingleSession(fullCalleeURI);
  }
 catch (  XMPPException ex) {
    throw new OperationFailedException("Failed to create OutgoingJingleSession.\n" + "This is most probably a network connection error.",OperationFailedException.INTERNAL_ERROR,ex);
  }
  CallJabberImpl call=new CallJabberImpl(protocolProvider);
  CallPeerJabberImpl callPeer=new CallPeerJabberImpl(calleeAddress,call);
  callPeer.setJingleSession(outJS);
  callPeer.setState(CallPeerState.INITIATING_CALL);
  fireCallEvent(CallEvent.CALL_INITIATED,call);
  activeCallsRepository.addCall(call);
  outJS.start();
  return (CallJabberImpl)callPeer.getCall();
}
