{
  Point currentMouseLocation=MouseInfo.getPointerInfo().getLocation();
  SwingUtilities.convertPointFromScreen(currentMouseLocation,this);
  TreePath path=this.getClosestPathForLocation(currentMouseLocation.x,currentMouseLocation.y);
  Object element=path.getLastPathComponent();
  ExtendedTooltip tip=null;
  if (element instanceof ContactNode) {
    UIContact contact=((ContactNode)element).getContactDescriptor();
    tip=contact.getToolTip();
    if (tip == null) {
      tip=new ExtendedTooltip(true);
      tip.setTitle(contact.getDisplayName());
    }
  }
 else   if (element instanceof GroupNode) {
    UIGroup group=((GroupNode)element).getGroupDescriptor();
    tip=new ExtendedTooltip(true);
    tip.setTitle(group.getDisplayName());
  }
 else   if (element instanceof ChatContact<?>) {
    ChatContact<?> chatContact=(ChatContact<?>)element;
    ImageIcon avatarImage=chatContact.getAvatar();
    tip=new ExtendedTooltip(true);
    if (avatarImage != null)     tip.setImage(avatarImage);
    tip.setTitle(chatContact.getName());
  }
  tip.setComponent(this);
  return tip;
}
