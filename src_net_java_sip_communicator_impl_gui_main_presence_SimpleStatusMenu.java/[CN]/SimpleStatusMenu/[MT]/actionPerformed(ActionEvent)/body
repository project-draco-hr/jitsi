{
  JMenuItem menuItem=(JMenuItem)e.getSource();
  String itemName=menuItem.getName();
  if (itemName.equals(Constants.ONLINE_STATUS)) {
    if (!protocolProvider.isRegistered()) {
      GuiActivator.getUIService().getLoginManager().login(protocolProvider);
    }
  }
 else {
    RegistrationState registrationState=protocolProvider.getRegistrationState();
    if (!registrationState.equals(RegistrationState.UNREGISTERED) && !registrationState.equals(RegistrationState.UNREGISTERING)) {
      try {
        GuiActivator.getUIService().getLoginManager().setManuallyDisconnected(true);
        protocolProvider.unregister();
      }
 catch (      OperationFailedException e1) {
        logger.error("Unable to unregister the protocol provider: " + protocolProvider + " due to the following exception: "+ e1);
      }
    }
  }
  saveStatusInformation(protocolProvider,itemName);
}
